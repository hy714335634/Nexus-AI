<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus-AI Platform - Agent管理</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* 左侧导航栏 */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e0e0e0;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            color: #667eea;
            text-align: center;
        }
        
        .nav-modules {
            flex: 1;
            padding: 1rem 0;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #999;
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            position: relative;
        }
        
        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-left-color: #667eea;
        }
        
        .nav-item.active {
            background: rgba(102, 126, 234, 0.15);
            border-left-color: #667eea;
            color: #667eea;
        }
        
        .nav-item.active::before {
            content: '';
            position: absolute;
            right: 1rem;
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
        }
        
        .nav-icon {
            margin-right: 0.8rem;
            font-size: 1.2rem;
            width: 20px;
            text-align: center;
        }
        
        .nav-text {
            font-weight: 500;
            flex: 1;
        }
        
        .nav-badge {
            background: #ff4444;
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .nav-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 0.5rem;
        }
        
        .status-online { background: #4caf50; }
        .status-building { background: #ff9800; }
        .status-offline { background: #e0e0e0; }
        
        /* 主内容区域 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        
        .page-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        
        /* Agent管理样式 */
        .management-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .header-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
            border: 1px solid #ddd;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .search-filter-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .search-bar {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.3s;
        }
        
        .search-bar:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .filter-tab {
            padding: 0.6rem 1.2rem;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .filter-tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .agent-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            border-left: 4px solid #667eea;
        }
        
        .agent-card:hover {
            transform: translateY(-5px);
        }
        
        .agent-card.selected {
            border-left-color: #4caf50;
            background: rgba(76, 1175, 80, 0.6);
        }
        
        .agent-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .agent-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
            cursor: pointer;
        }
        
        .agent-info {
            flex: 1;
        }
        
        .agent-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .agent-category {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 0.5rem;
        }
        
        .agent-description {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 1rem;
        }
        
        .agent-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .meta-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
        }
        
        .meta-label {
            color: #999;
        }
        
        .meta-value {
            color: #333;
            font-weight: 600;
        }
        
        .agent-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .status-running { background: #4caf50; }
        .status-building { background: #ff9800; }
        .status-offline { background: #e0e0e0; }
        
        .agent-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .btn-small:hover {
            transform: translateY(-1px);
        }
        
        .magician-section {
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            color: white;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
        }
        
        .magician-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .magician-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .magician-description {
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }
        
        .magician-input {
            width: 100%;
            min-height: 80px;
            padding: 1rem;
            border: none;
            border-radius: 15px;
            font-size: 1rem;
            resize: vertical;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        
        .magician-input:focus {
            outline: none;
            background: white;
        }
        
        .magician-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .btn-white {
            background: white;
            color: #4caf50;
            font-weight: 600;
        }
        
        .btn-white:hover {
            background: rgba(255, 255, 255, 0.9);
        }
        
        .selection-summary {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .selection-summary.show {
            display: block;
        }
        
        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .summary-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #667eea;
        }
        
        .selected-agents {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .selected-agent-tag {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .remove-agent {
            cursor: pointer;
            font-weight: bold;
        }
        
        .summary-actions {
            display: flex;
            gap: 1rem;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            
            .nav-text, .nav-badge {
                display: none;
            }
            
            .nav-icon {
                margin-right: 0;
            }
            
            .sidebar-header {
                padding: 1rem;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .agents-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 左侧导航栏 -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">🤖 Nexus-AI</div>
            </div>
            
            <div class="nav-modules">
                <!-- 核心模块 -->
                <div class="nav-section">
                    <div class="nav-section-title">核心模块</div>
                    
                    <div class="nav-item" onclick="navigateTo('homepage')">
                        <span class="nav-icon">🏠</span>
                        <span class="nav-text">首页概览</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('build')">
                        <span class="nav-icon">🔨</span>
                        <span class="nav-text">构建模块</span>
                        <span class="nav-badge">3</span>
                        <span class="nav-status status-building"></span>
                    </div>
                    
                    <div class="nav-item active" onclick="navigateTo('management')">
                        <span class="nav-icon">⚙️</span>
                        <span class="nav-text">管理模块</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('iteration')">
                        <span class="nav-icon">🔄</span>
                        <span class="nav-text">迭代模块</span>
                        <span class="nav-badge">1</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('troubleshoot')">
                        <span class="nav-icon">🐛</span>
                        <span class="nav-text">问题排查</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('operations')">
                        <span class="nav-icon">🔧</span>
                        <span class="nav-text">运维管理</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('monitoring')">
                        <span class="nav-icon">📊</span>
                        <span class="nav-text">监控中心</span>
                        <span class="nav-badge">2</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('tools')">
                        <span class="nav-icon">🛠️</span>
                        <span class="nav-text">工具&MCP</span>
                        <span class="nav-status status-online"></span>
                    </div>
                </div>
                
                <!-- 系统功能 -->
                <div class="nav-section">
                    <div class="nav-section-title">系统功能</div>
                    
                    <div class="nav-item" onclick="navigateTo('agent-library')">
                        <span class="nav-icon">🤖</span>
                        <span class="nav-text">Agent库</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('multi-agent')">
                        <span class="nav-icon">🔗</span>
                        <span class="nav-text">多Agent编排</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('evolution')">
                        <span class="nav-icon">🔄</span>
                        <span class="nav-text">自举式进化</span>
                        <span class="nav-badge">Beta</span>
                        <span class="nav-status status-building"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('analytics')">
                        <span class="nav-icon">📈</span>
                        <span class="nav-text">系统分析</span>
                        <span class="nav-status status-online"></span>
                    </div>
                </div>
                
                <!-- 用户管理 -->
                <div class="nav-section">
                    <div class="nav-section-title">用户管理</div>
                    
                    <div class="nav-item" onclick="navigateTo('profile')">
                        <span class="nav-icon">👤</span>
                        <span class="nav-text">个人中心</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('team')">
                        <span class="nav-icon">👥</span>
                        <span class="nav-text">团队管理</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('help')">
                        <span class="nav-icon">📚</span>
                        <span class="nav-text">帮助文档</span>
                        <span class="nav-status status-online"></span>
                    </div>
                    
                    <div class="nav-item" onclick="navigateTo('settings')">
                        <span class="nav-icon">⚙️</span>
                        <span class="nav-text">系统设置</span>
                        <span class="nav-status status-online"></span>
                    </div>
                </div>
            </div>
        </nav>
        
        <!-- 主内容区域 -->
        <main class="main-content">
            <div class="header">
                <div class="page-title">Agent管理中心</div>
                <div class="user-info">
                    <span>张强[企业业务部门]</span>
                    <img src="https://via.placeholder.com/40" alt="用户头像" style="border-radius: 50%; width: 40px; height: 40px;">
                </div>
            </div>
            
            <div class="content-area">
                <!-- 管理概览 -->
                <div class="management-header">
                    <div class="header-content">
                        <div class="header-title">🤖 Agent管理中心</div>
                        <div class="header-actions">
                            <button class="btn btn-secondary" onclick="openAgentDetail()">📋 查看详情</button>
                            <button class="btn btn-secondary" onclick="openGraphView()">📊 关系图谱</button>
                            <button class="btn btn-primary" onclick="createNewAgent()">➕ 新建Agent</button>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">127</div>
                            <div class="stat-label">总Agent数量</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">89</div>
                            <div class="stat-label">运行中</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">23</div>
                            <div class="stat-label">构建中</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">15</div>
                            <div class="stat-label">离线</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">2,847</div>
                            <div class="stat-label">今日调用次数</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">96.8%</div>
                            <div class="stat-label">平均成功率</div>
                        </div>
                    </div>
                </div>

                <!-- Magician Agent 对话区域 -->
                <div class="magician-section">
                    <div class="magician-header">
                        <span style="font-size: 2rem;">🧙‍♂️</span>
                        <div>
                            <div class="magician-title">Magician Agent</div>
                            <div class="magician-description">智能Agent编排助手 - 根据您的需求自动选择和协调相关Agent</div>
                        </div>
                    </div>
                    
                    <textarea class="magician-input" placeholder="💭 描述您需要解决的问题...

例如：我需要分析客户投诉数据，生成月度报告，并自动发送给相关部门负责人"></textarea>
                    
                    <div class="magician-actions">
                        <button class="btn btn-white" onclick="startMagicianDialog()">🚀 开始智能编排</button>
                        <button class="btn btn-white" onclick="viewMagicianHistory()">📚 查看历史对话</button>
                    </div>
                </div>

                <!-- 搜索和过滤 -->
                <div class="search-filter-section">
                    <input type="text" class="search-bar" placeholder="🔍 搜索Agent名称、描述、作者或标签..." id="searchInput">
                    
                    <div class="filter-tabs">
                        <div class="filter-tab active" data-filter="all">全部Agent</div>
                        <div class="filter-tab" data-filter="running">运行中</div>
                        <div class="filter-tab" data-filter="building">构建中</div>
                        <div class="filter-tab" data-filter="offline">离线</div>
                        <div class="filter-tab" data-filter="analysis">数据分析</div>
                        <div class="filter-tab" data-filter="customer">客户服务</div>
                        <div class="filter-tab" data-filter="automation">自动化</div>
                        <div class="filter-tab" data-filter="integration">集成工具</div>
                    </div>
                </div>

                <!-- 选择摘要 -->
                <div class="selection-summary" id="selectionSummary">
                    <div class="summary-header">
                        <div class="summary-title">已选择 <span id="selectedCount">0</span> 个Agent</div>
                        <button class="btn btn-primary" onclick="startSelectedDialog()">🚀 开始对话</button>
                    </div>
                    <div class="selected-agents" id="selectedAgents"></div>
                    <div class="summary-actions">
                        <button class="btn btn-secondary" onclick="clearSelection()">清空选择</button>
                        <button class="btn btn-secondary" onclick="openGraphView()">查看关系图</button>
                    </div>
                </div>

                <!-- Agent列表 -->
                <div class="agents-grid" id="agentsGrid">
                    <!-- Agent卡片将通过JavaScript动态生成 -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // Agent数据
        const agentsData = [
            {
                id: 'customer_complaint_agent',
                name: '客户投诉处理Agent',
                category: '客户服务',
                version: 'v2.1.0',
                author: '张强',
                description: '智能处理客户投诉，自动分类和路由，生成处理报告',
                status: 'running',
                calls: 1247,
                successRate: 96.8,
                lastUpdate: '2025-07-27',
                tags: ['客户服务', '自动化', '报告生成']
            },
            {
                id: 'data_analysis_agent',
                name: '数据分析Agent',
                category: '数据分析',
                version: 'v1.8.3',
                author: '李工程师',
                description: '支持多种数据格式分析，自动生成可视化图表和洞察报告',
                status: 'running',
                calls: 892,
                successRate: 98.2,
                lastUpdate: '2025-07-26',
                tags: ['数据分析', '可视化', '报告生成']
            },
            {
                id: 'sales_lead_agent',
                name: '销售线索分析Agent',
                category: '销售管理',
                version: 'v1.5.2',
                author: '王分析师',
                description: '分析销售线索质量，预测转化概率，优化销售策略',
                status: 'building',
                calls: 0,
                successRate: 0,
                lastUpdate: '2025-07-27',
                tags: ['销售管理', '预测分析', '优化']
            },
            {
                id: 'report_generator_agent',
                name: '报表生成Agent',
                category: '自动化',
                version: 'v3.0.1',
                author: '陈开发',
                description: '自动生成各类业务报表，支持定时任务和邮件发送',
                status: 'running',
                calls: 2156,
                successRate: 99.1,
                lastUpdate: '2025-07-25',
                tags: ['自动化', '报表生成', '定时任务']
            },
            {
                id: 'email_notification_agent',
                name: '邮件通知Agent',
                category: '集成工具',
                version: 'v2.3.0',
                author: '刘运维',
                description: '智能邮件发送，支持模板和批量处理，集成反垃圾邮件',
                status: 'running',
                calls: 3421,
                successRate: 97.5,
                lastUpdate: '2025-07-24',
                tags: ['集成工具', '邮件服务', '通知']
            },
            {
                id: 'document_processor_agent',
                name: '文档处理Agent',
                category: '自动化',
                version: 'v1.9.4',
                author: '赵助理',
                description: '处理PDF、Word、Excel等文档，提取关键信息并结构化存储',
                status: 'offline',
                calls: 0,
                successRate: 0,
                lastUpdate: '2025-07-20',
                tags: ['自动化', '文档处理', '信息提取']
            },
            {
                id: 'inventory_manager_agent',
                name: '库存管理Agent',
                category: '供应链',
                version: 'v2.0.0',
                author: '孙经理',
                description: '智能库存监控，预测缺货风险，自动补货建议',
                status: 'running',
                calls: 567,
                successRate: 94.3,
                lastUpdate: '2025-07-26',
                tags: ['供应链', '库存管理', '预测分析']
            },
            {
                id: 'quality_control_agent',
                name: '质量控制Agent',
                category: '质量管理',
                version: 'v1.7.2',
                author: '周质检',
                description: '产品质量检测，异常识别，质量报告生成',
                status: 'running',
                calls: 789,
                successRate: 95.7,
                lastUpdate: '2025-07-25',
                tags: ['质量管理', '异常检测', '质量控制']
            }
        ];

        let selectedAgents = new Set();
        let currentFilter = 'all';
        let currentSearch = '';

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            renderAgents();
            setupEventListeners();
        });

        // 设置事件监听器
        function setupEventListeners() {
            // 搜索功能
            document.getElementById('searchInput').addEventListener('input', function(e) {
                currentSearch = e.target.value.toLowerCase();
                renderAgents();
            });

            // 过滤标签
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderAgents();
                });
            });
        }

        // 渲染Agent列表
        function renderAgents() {
            const grid = document.getElementById('agentsGrid');
            const filteredAgents = agentsData.filter(agent => {
                const matchesSearch = !currentSearch || 
                    agent.name.toLowerCase().includes(currentSearch) ||
                    agent.description.toLowerCase().includes(currentSearch) ||
                    agent.author.toLowerCase().includes(currentSearch) ||
                    agent.tags.some(tag => tag.toLowerCase().includes(currentSearch));
                
                const matchesFilter = currentFilter === 'all' || 
                    agent.status === currentFilter ||
                    agent.category.toLowerCase().includes(currentFilter);
                
                return matchesSearch && matchesFilter;
            });

            grid.innerHTML = filteredAgents.map(agent => `
                <div class="agent-card ${selectedAgents.has(agent.id) ? 'selected' : ''}" data-agent-id="${agent.id}">
                    <div class="agent-header">
                        <input type="checkbox" class="agent-checkbox" ${selectedAgents.has(agent.id) ? 'checked' : ''} 
                               onchange="toggleAgentSelection('${agent.id}')">
                        <div class="agent-info">
                            <div class="agent-name">${agent.name}</div>
                            <div class="agent-category">${agent.category}</div>
                        </div>
                    </div>
                    
                    <div class="agent-description">${agent.description}</div>
                    
                    <div class="agent-meta">
                        <div class="meta-item">
                            <span class="meta-label">版本:</span>
                            <span class="meta-value">${agent.version}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">作者:</span>
                            <span class="meta-value">${agent.author}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">调用次数:</span>
                            <span class="meta-value">${agent.calls.toLocaleString()}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">成功率:</span>
                            <span class="meta-value">${agent.successRate}%</span>
                        </div>
                    </div>
                    
                    <div class="agent-status">
                        <div class="status-dot status-${agent.status}"></div>
                        <span>${getStatusText(agent.status)}</span>
                        <span style="margin-left: auto; font-size: 0.8rem; color: #999;">${agent.lastUpdate}</span>
                    </div>
                    
                    <div class="agent-actions">
                        <button class="btn-small btn-primary" onclick="viewAgentDetail('${agent.id}')">查看详情</button>
                        <button class="btn-small btn-secondary" onclick="testAgent('${agent.id}')">测试</button>
                        <button class="btn-small btn-secondary" onclick="viewAgentLogs('${agent.id}')">日志</button>
                    </div>
                </div>
            `).join('');
        }

        // 获取状态文本
        function getStatusText(status) {
            const statusMap = {
                'running': '运行中',
                'building': '构建中',
                'offline': '离线'
            };
            return statusMap[status] || status;
        }

        // 切换Agent选择
        function toggleAgentSelection(agentId) {
            if (selectedAgents.has(agentId)) {
                selectedAgents.delete(agentId);
            } else {
                selectedAgents.add(agentId);
            }
            
            updateSelectionSummary();
            renderAgents();
        }

        // 更新选择摘要
        function updateSelectionSummary() {
            const summary = document.getElementById('selectionSummary');
            const count = document.getElementById('selectedCount');
            const agents = document.getElementById('selectedAgents');
            
            count.textContent = selectedAgents.size;
            
            if (selectedAgents.size > 0) {
                summary.classList.add('show');
                agents.innerHTML = Array.from(selectedAgents).map(agentId => {
                    const agent = agentsData.find(a => a.id === agentId);
                    return `
                        <div class="selected-agent-tag">
                            ${agent.name}
                            <span class="remove-agent" onclick="toggleAgentSelection('${agentId}')">×</span>
                        </div>
                    `;
                }).join('');
            } else {
                summary.classList.remove('show');
            }
        }

        // 清空选择
        function clearSelection() {
            selectedAgents.clear();
            updateSelectionSummary();
            renderAgents();
        }

        // 开始Magician对话
        function startMagicianDialog() {
            const input = document.querySelector('.magician-input');
            const question = input.value.trim();
            
            if (!question) {
                alert('请输入您的问题');
                return;
            }
            
            // 这里可以打开新的对话窗口
            window.open(`agent-dialog.html?question=${encodeURIComponent(question)}`, '_blank', 'width=800,height=600');
        }

        // 开始选中Agent的对话
        function startSelectedDialog() {
            if (selectedAgents.size === 0) {
                alert('请先选择要对话的Agent');
                return;
            }
            
            const agentIds = Array.from(selectedAgents);
            window.open(`agent-graph-dialog.html?agents=${agentIds.join(',')}`, '_blank', 'width=1000,height=700');
        }

        // 打开关系图视图
        function openGraphView() {
            if (selectedAgents.size === 0) {
                alert('请先选择要查看的Agent');
                return;
            }
            
            const agentIds = Array.from(selectedAgents);
            window.open(`agent-graph-view.html?agents=${agentIds.join(',')}`, '_blank', 'width=1200,height=800');
        }

        // 其他功能函数
        function viewAgentDetail(agentId) {
            // 保存当前Agent信息到localStorage
            const agentInfo = {
                id: agentId,
                name: `Agent-${agentId}`,
                type: '智能助手',
                version: '1.0.0',
                status: '运行中',
                lastActive: new Date().toISOString()
            };
            localStorage.setItem('currentAgent', JSON.stringify(agentInfo));
            
            window.open(`agent-detail.html?id=${agentId}`, '_blank', 'width=800,height=600');
        }

        function testAgent(agentId) {
            alert(`测试Agent: ${agentId}`);
        }

        function viewAgentLogs(agentId) {
            alert(`查看Agent日志: ${agentId}`);
        }

        function createNewAgent() {
            alert('创建新Agent功能');
        }

        function openAgentDetail() {
            alert('查看Agent详情功能');
        }

        function viewMagicianHistory() {
            alert('查看Magician历史对话');
        }

        // 统一导航功能
        function navigateTo(page) {
            const pageMap = {
                'homepage': '00.homepage_overview.html',
                'build': '01.AgentBuildModule.html',
                'management': '02.AgentManagement.html',
                'iteration': '04.PFR.html',
                'troubleshoot': 'troubleshoot.html',
                'operations': '06.AgentOps.html',
                'monitoring': '06.AgentOps.html',
                'tools': '03.Tools&MCP.html',
                'agent-library': 'agent-library.html',
                'multi-agent': 'agent-graph-view.html',
                'evolution': 'evolution.html',
                'analytics': 'analytics.html',
                'profile': 'profile.html',
                'team': 'team.html',
                'help': 'help.html',
                'settings': 'settings.html'
            };
            
            if (pageMap[page]) {
                // 保存当前页面状态
                savePageState();
                window.location.href = pageMap[page];
            } else {
                showNotification('页面开发中，敬请期待！', 'info');
            }
        }

        // 保存页面状态
        function savePageState() {
            const state = {
                selectedAgents: Array.from(selectedAgents),
                currentFilter: currentFilter,
                currentSearch: currentSearch,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('agentManagementState', JSON.stringify(state));
        }

        // 加载页面状态
        function loadPageState() {
            const savedState = localStorage.getItem('agentManagementState');
            if (savedState) {
                const state = JSON.parse(savedState);
                selectedAgents = new Set(state.selectedAgents || []);
                currentFilter = state.currentFilter || 'all';
                currentSearch = state.currentSearch || '';
                
                // 恢复搜索框
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.value = currentSearch;
                }
                
                // 恢复过滤器
                const filterTabs = document.querySelectorAll('.filter-tab');
                filterTabs.forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.filter === currentFilter) {
                        tab.classList.add('active');
                    }
                });
                
                updateSelectionSummary();
            }
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}</span>
                    <span>${message}</span>
                </div>
            `;
            
            // 添加通知样式
            if (!document.querySelector('.notification')) {
                const style = document.createElement('style');
                style.textContent = `
                    .notification {
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: white;
                        border-radius: 10px;
                        padding: 1rem 1.5rem;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 3000;
                        animation: slideIn 0.3s ease-out;
                        max-width: 300px;
                    }
                    .notification.success { border-left: 4px solid #4caf50; }
                    .notification.error { border-left: 4px solid #f44336; }
                    .notification.info { border-left: 4px solid #2196f3; }
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // 页面加载时恢复状态
        document.addEventListener('DOMContentLoaded', function() {
            loadPageState();
            renderAgents();
            setupEventListeners();
        });

        // 页面卸载时保存状态
        window.addEventListener('beforeunload', savePageState);
    </script>
</body>
</html>