<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus-AI Platform - ç›‘æ§æ¨¡å—</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* å·¦ä¾§å¯¼èˆªæ  */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e0e0e0;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            color: #667eea;
            text-align: center;
        }
        
        .nav-modules {
            flex: 1;
            padding: 1rem 0;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #999;
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            position: relative;
        }
        
        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-left-color: #667eea;
        }
        
        .nav-item.active {
            background: rgba(102, 126, 234, 0.15);
            border-left-color: #667eea;
            color: #667eea;
        }
        
        .nav-item.active::before {
            content: '';
            position: absolute;
            right: 1rem;
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
        }
        
        .nav-icon {
            margin-right: 0.8rem;
            font-size: 1.2rem;
            width: 20px;
            text-align: center;
        }
        
        .nav-text {
            font-weight: 500;
            flex: 1;
        }
        
        .nav-badge {
            background: #ff4444;
            color: white;
            border-radius: 10px;
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .nav-badge.success {
            background: #4caf50;
        }
        
        .nav-badge.warning {
            background: #ff9800;
        }
        
        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 2rem;
        }
        
        .content-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .content-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .content-subtitle {
            color: #666;
            font-size: 1rem;
        }
        
        /* ç½‘ç»œå¯è§†åŒ–å®¹å™¨ */
        .network-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .network-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .control-group {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .control-button {
            padding: 0.5rem 1rem;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .control-button:hover {
            background: #667eea;
            color: white;
        }
        
        .control-button.active {
            background: #667eea;
            color: white;
        }
        
        .filter-select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
        }
        
        /* ç½‘ç»œå›¾SVGå®¹å™¨ */
        .network-svg {
            width: 100%;
            height: 500px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #fafafa;
        }
        
        /* ç½‘ç»œå›¾èŠ‚ç‚¹æ ·å¼ */
        .node {
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .node:hover {
            stroke-width: 3px;
        }
        
        .node.agent {
            fill: #667eea;
            stroke: #4a56d8;
        }
        
        .node.tool {
            fill: #4caf50;
            stroke: #2e7d32;
        }
        
        .node.mcp {
            fill: #ff9800;
            stroke: #e65100;
        }
        
        .node.supervisor {
            fill: #e91e63;
            stroke: #ad1457;
        }
        
        /* ç½‘ç»œå›¾è¿æ¥çº¿æ ·å¼ */
        .link {
            stroke: #999;
            stroke-width: 2px;
            fill: none;
            opacity: 0.6;
            transition: all 0.3s;
        }
        
        .link:hover {
            stroke-width: 3px;
            opacity: 1;
        }
        
        .link.active {
            stroke: #667eea;
            stroke-width: 3px;
            opacity: 1;
        }
        
        /* èŠ‚ç‚¹æ ‡ç­¾æ ·å¼ */
        .node-label {
            font-size: 12px;
            fill: #333;
            text-anchor: middle;
            pointer-events: none;
        }
        
        /* å›¾ä¾‹æ ·å¼ */
        .legend {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .legend-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #667eea;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0.3rem 0;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
        
        .legend-text {
            font-size: 0.9rem;
            color: #333;
        }
        
        /* ç»Ÿè®¡ä¿¡æ¯é¢æ¿ */
        .stats-panel {
            position: absolute;
            bottom: 2rem;
            left: 2rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            min-width: 200px;
        }
        
        .stats-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #667eea;
        }
        
        .stats-item {
            display: flex;
            justify-content: space-between;
            margin: 0.3rem 0;
        }
        
        .stats-label {
            font-size: 0.9rem;
            color: #333;
        }
        
        .stats-value {
            font-weight: 600;
            color: #667eea;
        }
        
        /* å·¥å…·æç¤ºæ ·å¼ */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem;
            border-radius: 5px;
            font-size: 0.8rem;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å·¦ä¾§å¯¼èˆªæ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">ğŸ¤– Nexus-AI Platform</div>
            </div>
            <div class="nav-modules">
                <div class="nav-section">
                    <div class="nav-section-title">æ ¸å¿ƒæ¨¡å—</div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ—ï¸</span>
                        <span class="nav-text">æ„å»ºæ¨¡å—</span>
                        <span class="nav-badge success">5</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">âš™ï¸</span>
                        <span class="nav-text">ç®¡ç†æ¨¡å—</span>
                        <span class="nav-badge">127</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ”„</span>
                        <span class="nav-text">è¿­ä»£æ¨¡å—</span>
                        <span class="nav-badge warning">2</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ›</span>
                        <span class="nav-text">é—®é¢˜æ’æŸ¥æ¨¡å—</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸš€</span>
                        <span class="nav-text">è¿ç»´ç®¡ç†æ¨¡å—</span>
                        <span class="nav-badge success">æ­£å¸¸</span>
                    </div>
                    <div class="nav-item active">
                        <span class="nav-icon">ğŸ“Š</span>
                        <span class="nav-text">å¯è§‚æµ‹æ€§æ¨¡å—</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ› ï¸</span>
                        <span class="nav-text">å·¥å…·åŠMCPç®¡ç†</span>
                        <span class="nav-badge">45</span>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">ç³»ç»ŸåŠŸèƒ½</div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ¯</span>
                        <span class="nav-text">è‡ªä¸¾å¼è¿›åŒ–</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ“ˆ</span>
                        <span class="nav-text">æ€§èƒ½åˆ†æ</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">ğŸ”’</span>
                        <span class="nav-text">å®‰å…¨å®¡è®¡</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="content-header">
                <div class="content-title">ğŸ“Š å¯è§‚æµ‹æ€§æ¨¡å— - ç½‘ç»œå…³ç³»ç›‘æ§</div>
                <div class="content-subtitle">å®æ—¶ç›‘æ§Agentã€Toolså’ŒMCPä¹‹é—´çš„è°ƒç”¨å…³ç³»ç½‘ç»œ</div>
            </div>
            
            <div class="network-container">
                <div class="network-controls">
                    <div class="control-group">
                        <button class="control-button active" id="showAll">æ˜¾ç¤ºå…¨éƒ¨</button>
                        <button class="control-button" id="showAgents">ä»…æ˜¾ç¤ºAgent</button>
                        <button class="control-button" id="showTools">ä»…æ˜¾ç¤ºå·¥å…·</button>
                        <button class="control-button" id="showMCP">ä»…æ˜¾ç¤ºMCP</button>
                    </div>
                    <div class="control-group">
                        <label>è¿‡æ»¤å™¨ï¼š</label>
                        <select class="filter-select" id="filterSelect">
                            <option value="all">å…¨éƒ¨è¿æ¥</option>
                            <option value="active">æ´»è·ƒè¿æ¥</option>
                            <option value="recent">æœ€è¿‘è°ƒç”¨</option>
                            <option value="error">é”™è¯¯è¿æ¥</option>
                        </select>
                        <button class="control-button" id="refreshBtn">ğŸ”„ åˆ·æ–°</button>
                    </div>
                </div>
                
                <div style="position: relative; flex: 1;">
                    <svg class="network-svg" id="networkSvg"></svg>
                    
                    <!-- å›¾ä¾‹ -->
                    <div class="legend">
                        <div class="legend-title">èŠ‚ç‚¹ç±»å‹</div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #667eea;"></div>
                            <div class="legend-text">Agent</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #4caf50;"></div>
                            <div class="legend-text">Tool</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #ff9800;"></div>
                            <div class="legend-text">MCP</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #e91e63;"></div>
                            <div class="legend-text">Supervisor</div>
                        </div>
                    </div>
                    
                    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                    <div class="stats-panel">
                        <div class="stats-title">ç½‘ç»œç»Ÿè®¡</div>
                        <div class="stats-item">
                            <div class="stats-label">Agentæ•°é‡:</div>
                            <div class="stats-value">127</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-label">Toolæ•°é‡:</div>
                            <div class="stats-value">45</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-label">MCPæ•°é‡:</div>
                            <div class="stats-value">23</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-label">æ´»è·ƒè¿æ¥:</div>
                            <div class="stats-value">89</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-label">ä»Šæ—¥è°ƒç”¨:</div>
                            <div class="stats-value">2,847</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å·¥å…·æç¤º -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // ç½‘ç»œå›¾æ•°æ®
        const networkData = {
            nodes: [
                // Supervisor Agents
                { id: 'build_supervisor', name: 'æ„å»ºSupervisor', type: 'supervisor', x: 400, y: 100 },
                { id: 'manage_supervisor', name: 'ç®¡ç†Supervisor', type: 'supervisor', x: 600, y: 100 },
                { id: 'iterate_supervisor', name: 'è¿­ä»£Supervisor', type: 'supervisor', x: 800, y: 100 },
                
                // Agents
                { id: 'req_analysis', name: 'éœ€æ±‚åˆ†æAgent', type: 'agent', x: 200, y: 200 },
                { id: 'req_organize', name: 'éœ€æ±‚æ•´ç†Agent', type: 'agent', x: 350, y: 200 },
                { id: 'func_design', name: 'åŠŸèƒ½è®¾è®¡Agent', type: 'agent', x: 500, y: 200 },
                { id: 'agent_def', name: 'Agentå®šä¹‰Agent', type: 'agent', x: 650, y: 200 },
                { id: 'prompt_eng', name: 'æç¤ºè¯å·¥ç¨‹Agent', type: 'agent', x: 800, y: 200 },
                { id: 'agent_dev', name: 'Agentå¼€å‘Agent', type: 'agent', x: 950, y: 200 },
                
                // Tools
                { id: 'text_classifier', name: 'æ–‡æœ¬åˆ†ç±»å™¨', type: 'tool', x: 300, y: 350 },
                { id: 'report_generator', name: 'æŠ¥å‘Šç”Ÿæˆå™¨', type: 'tool', x: 500, y: 350 },
                { id: 'code_sandbox', name: 'ä»£ç æ²™ç›’', type: 'tool', x: 700, y: 350 },
                { id: 'browser_agent', name: 'æµè§ˆå™¨ä»£ç†', type: 'tool', x: 900, y: 350 },
                
                // MCP
                { id: 'git_mcp', name: 'Git MCP', type: 'mcp', x: 250, y: 450 },
                { id: 'db_mcp', name: 'Database MCP', type: 'mcp', x: 450, y: 450 },
                { id: 'slack_mcp', name: 'Slack MCP', type: 'mcp', x: 650, y: 450 },
                { id: 'email_mcp', name: 'Email MCP', type: 'mcp', x: 850, y: 450 }
            ],
            links: [
                // Supervisor to Agent connections
                { source: 'build_supervisor', target: 'req_analysis', type: 'control' },
                { source: 'build_supervisor', target: 'req_organize', type: 'control' },
                { source: 'build_supervisor', target: 'func_design', type: 'control' },
                { source: 'manage_supervisor', target: 'agent_def', type: 'control' },
                { source: 'iterate_supervisor', target: 'prompt_eng', type: 'control' },
                { source: 'iterate_supervisor', target: 'agent_dev', type: 'control' },
                
                // Agent to Agent connections
                { source: 'req_analysis', target: 'req_organize', type: 'data' },
                { source: 'req_organize', target: 'func_design', type: 'data' },
                { source: 'func_design', target: 'agent_def', type: 'data' },
                { source: 'agent_def', target: 'prompt_eng', type: 'data' },
                { source: 'prompt_eng', target: 'agent_dev', type: 'data' },
                
                // Agent to Tool connections
                { source: 'req_analysis', target: 'text_classifier', type: 'call' },
                { source: 'func_design', target: 'report_generator', type: 'call' },
                { source: 'agent_dev', target: 'code_sandbox', type: 'call' },
                { source: 'agent_dev', target: 'browser_agent', type: 'call' },
                
                // Tool to MCP connections
                { source: 'code_sandbox', target: 'git_mcp', type: 'integration' },
                { source: 'report_generator', target: 'db_mcp', type: 'integration' },
                { source: 'text_classifier', target: 'slack_mcp', type: 'integration' },
                { source: 'browser_agent', target: 'email_mcp', type: 'integration' }
            ]
        };

        // åˆå§‹åŒ–ç½‘ç»œå›¾
        function initNetworkGraph() {
            const svg = d3.select('#networkSvg');
            const width = svg.node().getBoundingClientRect().width;
            const height = svg.node().getBoundingClientRect().height;
            
            svg.selectAll('*').remove();
            
            // åˆ›å»ºåŠ›å¯¼å‘å›¾
            const simulation = d3.forceSimulation(networkData.nodes)
                .force('link', d3.forceLink(networkData.links).id(d => d.id).distance(100))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(width / 2, height / 2))
                .force('collision', d3.forceCollide().radius(30));
            
            // ç»˜åˆ¶è¿æ¥çº¿
            const link = svg.append('g')
                .selectAll('line')
                .data(networkData.links)
                .enter().append('line')
                .attr('class', 'link')
                .style('stroke-width', 2);
            
            // ç»˜åˆ¶èŠ‚ç‚¹
            const node = svg.append('g')
                .selectAll('circle')
                .data(networkData.nodes)
                .enter().append('circle')
                .attr('class', d => `node ${d.type}`)
                .attr('r', d => d.type === 'supervisor' ? 25 : 20)
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended));
            
            // æ·»åŠ èŠ‚ç‚¹æ ‡ç­¾
            const label = svg.append('g')
                .selectAll('text')
                .data(networkData.nodes)
                .enter().append('text')
                .attr('class', 'node-label')
                .text(d => d.name)
                .attr('dy', -30);
            
            // æ·»åŠ å·¥å…·æç¤º
            const tooltip = d3.select('#tooltip');
            
            node.on('mouseover', function(event, d) {
                tooltip.style('opacity', 1)
                    .html(`<strong>${d.name}</strong><br/>ç±»å‹: ${d.type}<br/>çŠ¶æ€: è¿è¡Œä¸­`)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px')
                    .classed('show', true);
            })
            .on('mouseout', function() {
                tooltip.classed('show', false);
            });
            
            // æ¨¡æ‹Ÿå™¨tickäº‹ä»¶
            simulation.on('tick', function() {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);
                
                node
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);
                
                label
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });
            
            // æ‹–æ‹½äº‹ä»¶
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            initNetworkGraph();
            
            // ç»‘å®šæ§åˆ¶æŒ‰é’®äº‹ä»¶
            document.getElementById('refreshBtn').addEventListener('click', function() {
                initNetworkGraph();
            });
            
            // ç»‘å®šè¿‡æ»¤å™¨äº‹ä»¶
            document.getElementById('filterSelect').addEventListener('change', function() {
                // è¿™é‡Œå¯ä»¥æ·»åŠ è¿‡æ»¤é€»è¾‘
                console.log('è¿‡æ»¤å™¨æ”¹å˜:', this.value);
            });
        });
    </script>
</body>
</html>