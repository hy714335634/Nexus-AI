default-config:
  nexus_ai:
    base_rule_path: 'config/nexus_ai_base_rule.yaml' # Path to Nexus-AI base rule file
    base_rule_version: 'latest' # Version of Nexus-AI base rule
    workflow_default_version: 
      agent_build: 'latest'
      agent_update: 'latest'
      tool_build: 'latest'
    # OpenTelemetry OTLP 导出端点
    # 优先级：环境变量 OTEL_EXPORTER_OTLP_ENDPOINT > 此配置值 > 默认值 http://localhost:4318
    # Terraform 部署后会自动设置环境变量，格式：http://jaeger.{project_name}.local:4318
    # 本地开发时如果未设置环境变量，将使用此配置值或默认值
    OTEL_EXPORTER_OTLP_ENDPOINT: 'http://localhost:4318'
    artifacts_s3_bucket: 'nexus-ai-artifacts-2026'  # S3桶名称，部署时需要修改
    session_storage_s3_bucket: 'nexus-ai-session-2026' # S3桶名称，部署时需要修改
    auto_sync_to_s3: true  # 是否在Agent构建完成后自动同步到S3（也可通过环境变量NEXUS_AUTO_SYNC_TO_S3控制）
  
  # 工作流引擎配置
  # Requirements: 8.1, 8.2, 8.3, 8.4, 8.5
  workflow:
    # 工作流阶段定义
    stages:
      - name: 'orchestrator'
        display_name: '编排器'
        order: 1
        prerequisites: []
        prompt_path: 'system_agents_prompts/agent_build_workflow/orchestrator'
      - name: 'requirements_analyzer'
        display_name: '需求分析'
        order: 2
        prerequisites: ['orchestrator']
        prompt_path: 'system_agents_prompts/agent_build_workflow/requirements_analyzer'
      - name: 'system_architect'
        display_name: '系统架构'
        order: 3
        prerequisites: ['requirements_analyzer']
        prompt_path: 'system_agents_prompts/agent_build_workflow/system_architect'
      - name: 'agent_designer'
        display_name: 'Agent设计'
        order: 4
        prerequisites: ['system_architect']
        prompt_path: 'system_agents_prompts/agent_build_workflow/agent_designer'
      - name: 'tool_developer'
        display_name: '工具开发'
        order: 5
        prerequisites: ['agent_designer']
        prompt_path: 'system_agents_prompts/agent_build_workflow/tool_developer'
      - name: 'prompt_engineer'
        display_name: '提示词工程'
        order: 6
        prerequisites: ['agent_designer']
        prompt_path: 'system_agents_prompts/agent_build_workflow/prompt_engineer'
      - name: 'agent_code_developer'
        display_name: 'Agent代码开发'
        order: 7
        prerequisites: ['tool_developer', 'prompt_engineer']
        prompt_path: 'system_agents_prompts/agent_build_workflow/agent_code_developer'
      - name: 'agent_developer_manager'
        display_name: 'Agent开发管理'
        order: 8
        prerequisites: ['agent_code_developer']
        prompt_path: 'system_agents_prompts/agent_build_workflow/agent_developer_manager'
      - name: 'agent_deployer'
        display_name: 'Agent部署'
        order: 9
        prerequisites: ['agent_developer_manager']
        prompt_path: 'system_agents_prompts/agent_build_workflow/agent_deployer'
        optional: true  # 部署阶段可选
    
    # 执行配置
    execution:
      max_retries: 3                    # 阶段失败最大重试次数
      retry_delay_seconds: 5            # 重试间隔（秒）
      stage_timeout_seconds: 3600       # 单阶段超时时间（秒）
      total_timeout_seconds: 21600      # 总工作流超时时间（秒，6小时）
      checkpoint_interval_seconds: 60   # 检查点保存间隔（秒）
    
    # 上下文配置
    context:
      max_tokens: 100000                # 最大上下文 token 数
      summary_threshold_tokens: 5000    # 触发摘要的阈值
      include_rules: true               # 是否包含工作流规则
      include_local_docs: true          # 是否包含本地文档
    
    # 输出存储配置
    storage:
      max_inline_size_kb: 400           # DynamoDB 内联存储最大大小（KB）
      s3_bucket: ''                     # S3 存储桶（空则使用 artifacts_s3_bucket）
      s3_prefix: 'workflow-outputs/'    # S3 前缀
    
    # 多 Agent 支持配置
    multi_agent:
      enabled: true                     # 是否启用多 Agent 支持
      max_agents: 10                    # 单项目最大 Agent 数量
      orchestration_patterns:           # 支持的编排模式
        - 'agent_as_tool'
        - 'swarm'
        - 'graph'
  aws:
    bedrock_region_name: 'us-west-2'  # Region for Amazon Bedrock API calls
    aws_region_name: 'us-west-2'      # Default AWS region for other services
    aws_profile_name: 'default'       # AWS profile name, leave empty to use AWS credentials provider chain
    aws_access_key_id: ''             # AWS access key, leave empty to use AWS credentials provider chain
    aws_secret_access_key: ''         # AWS secret key, leave empty to use AWS credentials provider chain
    endpoint_url: ''                  # Custom endpoint URL, leave empty for AWS default endpoints
    verify: True                      # Verify SSL certificates for AWS API calls
    connect_timeout: 7200              # invoke timeout time, second
  
  strands:
    template:
      agent_template_path: 'agents/template_agents' # Path to Strands agent templates
      prompt_template_path: 'prompts/template_prompts'
      tool_template_path: 'tools/template_tools'
    generated:
      agent_generated_path: 'agents/generated_agents'
      prompt_generated_path: 'prompts/generated_agents_prompts'
      tool_generated_path: 'tools/generated_tools'
    system:
      agents_path: 'agents/system_agents'
      prompts_path: 'prompts/system_agents_prompts'
      tools_path: 'tools/system_tools'
    requirements_path: 'templates/requirements/requirements.txt' # Default requirements file
    mcp_server_path: 'mcp/' # Path to Strands mcp server templates
    project_path: 'project/'     # Base path for agent project files
    default_tools:
      - 'calculator'
      - 'shell'
      - 'file_read'
      - 'file_write'
  
  agentcore:
    execution_role_arn: ''                   # Full IAM role ARN for AgentCore (leave empty to auto-create)
    auto_create_execution_role: True         # Auto-create IAM execution role if not exists
    ecr_auto_create: True                    # Auto-create ECR repositories
    runtime_timeout_minutes: 30              # Timeout for agent runtime operations
    enable_xray: False                       # Enable AWS X-Ray tracing
    deploy_dry_run: False                    # Dry run mode (skip actual deployment)
    default_alias: 'DEFAULT'                 # Default agent alias
    post_deploy_test: False                  # Run test after deployment
    post_deploy_test_prompt: 'Hello'         # Test prompt for post-deploy test
  
  bedrock:
    model_id: 'us.anthropic.claude-sonnet-4-5-20250929-v1:0'    # Default model
    lite_model_id: 'us.anthropic.claude-haiku-4-5-20251001-v1:0' # Lightweight model
    pro_model_id: 'us.anthropic.claude-opus-4-5-20251101-v1:0' # Advanced model
    connect_config:
      retries:
        max_attempts: 100
        mode: "adaptive"
      connect_timeout: 3600
      read_timeout: 7200
    
  logging:
    level: 'INFO'                      # Logging level (DEBUG, INFO, WARNING, ERROR)
    file_path: 'logs/nexus_ai.log'     # Path to log file
    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
  
  # DynamoDB 表配置
  # Requirements: 8.3
  dynamodb:
    table_prefix: 'nexus_'              # 表名前缀
    tables:
      projects: 'nexus_projects'        # 项目表
      stages: 'nexus_stages'            # 阶段表
      tasks: 'nexus_tasks'              # 任务表
      agents: 'nexus_agents'            # Agent 表
      agent_instances: 'nexus_agent_instances'  # Agent 实例表
    # 可通过环境变量覆盖：
    # NEXUS_DYNAMODB_TABLE_PREFIX
    # NEXUS_DYNAMODB_PROJECTS_TABLE
    # NEXUS_DYNAMODB_STAGES_TABLE
    # NEXUS_DYNAMODB_TASKS_TABLE
  
  # SQS 队列配置
  # Requirements: 8.4
  sqs:
    queue_prefix: 'nexus-'              # 队列名前缀
    queues:
      build: 'nexus-build-queue'        # 构建任务队列
      deploy: 'nexus-deploy-queue'      # 部署任务队列
    visibility_timeout: 3600            # 消息可见性超时（秒）
    message_retention_days: 14          # 消息保留天数
    # 可通过环境变量覆盖：
    # NEXUS_SQS_BUILD_QUEUE
    # NEXUS_SQS_DEPLOY_QUEUE
  
  multimodal_parser:
    aws:
      s3_bucket: "awesome-nexus-ai-file-storage"
      s3_prefix: "multimodal-content/"
      bedrock_region: "us-west-2"
    
    file_limits:
      max_file_size: "50MB"
      max_files_per_request: 10
      supported_formats: ["jpg", "jpeg", "png", "gif", "txt", "xlsx", "docx", "csv"]
    
    processing:
      timeout_seconds: 300
      retry_attempts: 3
      batch_size: 5
    
    storage:
      presigned_url_expiration: 3600  # 1 hour
      cleanup_days: 30                # Auto-cleanup files older than 30 days
      max_retries: 3
      retry_delay: 1.0
    
    model:
      primary_model: "us.anthropic.claude-opus-4-5-20251101-v1:0"
      fallback_model: "us.anthropic.claude-sonnet-4-5-20250929-v1:0"
      max_tokens: 40000