{
  "agent_design": {
    "design_overview": {
      "project_name": "xiaohongshu_ad_generator",
      "version": "1.0",
      "date": "2025-12-04",
      "design_scope": "本文档详细定义了小红书广告生成Agent的完整设计规格，包括Agent的角色定位、核心能力、知识领域、交互模式、约束条件和评估标准。该Agent是一个专注于创意文案生成的AI智能体，能够根据产品信息自动生成符合小红书平台风格的完整广告内容，包括吸引人的标题、详细正文、话题标签和互动引导。",
      "design_goals": [
        "创建一个高度专业化的广告文案生成Agent，深度理解小红书平台的内容特点和用户偏好",
        "通过精心设计的提示词工程实现所有功能需求，无需额外的复杂工具开发",
        "确保生成的文案具有高质量、高一致性和高可用性，直接满足用户的营销需求",
        "设计灵活的输入接口和标准化的输出格式，提供优秀的用户体验",
        "建立完善的错误处理和质量保障机制，确保Agent的稳定性和可靠性",
        "遵循BedrockAgentCoreApp部署规范，确保Agent可部署到Amazon Bedrock平台",
        "为未来的功能扩展和性能优化预留充足的设计空间"
      ],
      "key_design_decisions": [
        {
          "decision": "采用单Agent架构，所有功能在一个Agent内完成",
          "rationale": "需求分析表明所有功能（输入解析、标题生成、正文创作、标签推荐、互动引导）都属于创意文案生成的范畴，职责高度聚焦。单Agent架构简化了系统复杂度，降低了开发和维护成本，提升了响应速度和用户体验。",
          "alternatives": [
            "多Agent架构：分别创建输入解析Agent、标题生成Agent、正文创作Agent、标签推荐Agent等，但会增加系统复杂度和响应延迟"
          ],
          "consequences": [
            "系统架构简洁，易于开发和维护",
            "响应速度快，用户体验好",
            "所有功能逻辑集中在提示词中，提示词设计的质量至关重要",
            "未来如需扩展复杂功能（如图片生成），可能需要重构为多Agent架构"
          ]
        },
        {
          "decision": "基于content_generator_agent模板进行定制开发",
          "rationale": "该模板专为内容生成设计，功能匹配度高达92%，包含文本生成、模板管理、内容优化等成熟工具。模板已在生产环境验证，稳定可靠，可大幅缩短开发周期。支持高度定制，可轻松适配小红书平台特点。",
          "alternatives": [
            "从零开始构建Agent：灵活性更高，但开发周期长，稳定性需要验证",
            "使用deep_research_agent模板：适合需要市场调研的场景，但对当前需求过于复杂"
          ],
          "consequences": [
            "开发效率高，可快速交付",
            "继承模板的成熟工具和最佳实践",
            "需要根据小红书平台特点进行定制化调整",
            "依赖模板的更新和维护"
          ]
        },
        {
          "decision": "提示词工程为核心，所有功能通过提示词实现",
          "rationale": "需求分析阶段明确指出，FR-001至FR-007的所有功能需求都可以通过提示词实现，无需额外开发复杂工具。提示词工程是本Agent的核心，通过在提示词中详细描述小红书平台特点、内容风格指南、输出格式要求和few-shot示例，引导模型生成高质量文案。这种设计降低了技术复杂度，提升了灵活性，便于快速迭代和优化。",
          "alternatives": [
            "开发专用工具：如emoji_selector、hashtag_generator、content_validator等，但会增加开发工作量和系统复杂度"
          ],
          "consequences": [
            "开发工作量小，主要聚焦于提示词设计和优化",
            "系统灵活性高，可通过调整提示词快速适应需求变化",
            "提示词质量直接决定生成内容的质量，需要精心设计和持续优化",
            "依赖模型的理解和生成能力，受模型限制约束"
          ]
        },
        {
          "decision": "使用Claude Sonnet 4.5模型（global.anthropic.claude-sonnet-4-5-20250929-v1:0）",
          "rationale": "该模型具有强大的中文理解和创意生成能力，非常适合小红书风格的文案创作。模型能够理解复杂的平台风格要求（年轻化、生活化、真实感），生成符合用户期望的内容。通过Amazon Bedrock托管，确保模型的安全性、稳定性和可扩展性。",
          "alternatives": [
            "使用GPT-4模型：英文能力更强，但中文创意生成不如Claude",
            "使用更小的模型（如Claude Instant）：速度更快但质量可能不足"
          ],
          "consequences": [
            "生成内容质量高，符合小红书平台风格",
            "模型成本相对较高，需要控制调用频率",
            "依赖AWS Bedrock服务的可用性和性能",
            "模型能力可能随版本更新而变化"
          ]
        },
        {
          "decision": "支持灵活的输入方式：结构化JSON和自然语言描述",
          "rationale": "不同用户有不同的使用习惯和场景。结构化输入适合系统集成和批量处理，自然语言输入适合个人用户和快速测试。通过提示词中的输入解析逻辑，Agent能够智能处理两种输入格式，提供更好的用户体验。",
          "alternatives": [
            "仅支持结构化输入：简单但用户体验较差",
            "仅支持自然语言输入：灵活但解析准确性可能不足"
          ],
          "consequences": [
            "用户体验好，适应不同使用场景",
            "需要在提示词中设计输入解析逻辑",
            "自然语言输入的解析准确性依赖模型能力",
            "需要在文档中提供两种输入方式的示例"
          ]
        },
        {
          "decision": "采用标准化的JSON输出格式",
          "rationale": "JSON格式结构清晰，易于解析和使用。包含title、content、tags、cta、metadata等字段，满足用户的所有需求。用户可直接复制到小红书平台，或进行二次编辑。元数据提供额外的参考信息，如生成时间、内容风格、字数统计等。",
          "alternatives": [
            "纯文本输出：简单但结构性差，不便于程序化处理",
            "XML格式输出：结构化但冗余度高，不如JSON简洁"
          ],
          "consequences": [
            "输出格式清晰，便于用户使用",
            "支持程序化处理和系统集成",
            "需要在提示词中明确指定输出格式",
            "需要处理JSON格式化错误的情况"
          ]
        },
        {
          "decision": "严格遵循BedrockAgentCoreApp部署规范",
          "rationale": "确保Agent可部署到Amazon Bedrock AgentCore平台，支持本地测试和云端部署。使用@app.entrypoint装饰器定义handler函数，handler函数返回字符串（str），在__main__中使用app.run()启动HTTP服务器。这是部署到AgentCore的必要条件。",
          "alternatives": [
            "使用其他部署框架：灵活性更高但不符合项目约束"
          ],
          "consequences": [
            "确保Agent可部署到Amazon Bedrock平台",
            "支持本地测试和云端部署的无缝切换",
            "必须遵循handler函数的签名和返回值要求",
            "依赖BedrockAgentCoreApp框架的更新和维护"
          ]
        },
        {
          "decision": "设计Agent的个性为专业、友好、创意的内容创作助手",
          "rationale": "小红书平台强调真实、生活化、有共鸣感的内容风格。Agent的个性应体现专业性（理解营销和文案创作）、友好性（易于沟通和使用）、创意性（生成吸引人的内容）。这种个性设计有助于Agent更好地理解用户需求，生成符合平台调性的文案。",
          "alternatives": [
            "设计为严肃、正式的专业工具：不符合小红书平台的年轻化、生活化风格",
            "设计为过于随意、娱乐化的助手：可能影响内容的专业性和营销效果"
          ],
          "consequences": [
            "Agent的沟通风格更贴近小红书平台用户",
            "生成的文案更符合平台调性",
            "需要在提示词中体现Agent的个性特征",
            "个性设计可能需要根据用户反馈进行调整"
          ]
        },
        {
          "decision": "设置10秒的响应时间目标和超时机制",
          "rationale": "用户体验研究表明，10秒是用户等待的心理阈值。超过10秒会显著影响用户体验和满意度。设置10秒超时机制，确保系统响应稳定，避免长时间等待。如果生成超时，返回友好的错误信息和重试建议。",
          "alternatives": [
            "更短的超时时间（如5秒）：可能导致生成失败率增加",
            "更长的超时时间（如30秒）：用户体验较差"
          ],
          "consequences": [
            "确保用户体验，避免长时间等待",
            "需要优化提示词和模型配置，确保在10秒内完成生成",
            "部分复杂请求可能会超时，需要提供重试机制",
            "需要监控响应时间，及时发现和解决性能问题"
          ]
        },
        {
          "decision": "建立完善的错误处理和用户反馈机制",
          "rationale": "良好的错误处理能够显著提升用户体验和系统可靠性。所有错误信息都使用用户易懂的语言，提供详细的错误原因和解决建议。输入验证失败时，提示用户补充缺失信息并提供输入示例。生成失败或超时时，提供重试建议和调整输入的指导。",
          "alternatives": [
            "简单的错误信息：开发成本低但用户体验差",
            "不提供错误处理：系统稳定性差，用户无法理解问题原因"
          ],
          "consequences": [
            "用户体验好，能够快速理解和解决问题",
            "系统可靠性高，错误恢复能力强",
            "需要设计详细的错误分类和处理逻辑",
            "需要持续收集用户反馈，优化错误提示"
          ]
        }
      ]
    },
    "agents": [
      {
        "agent_id": "xiaohongshu_ad_generator",
        "name": "xiaohongshu_ad_generator",
        "role": "小红书广告文案生成专家",
        "purpose": "作为一个专业的广告文案创作助手，根据用户提供的产品信息，自动生成符合小红书平台风格的完整广告内容。该Agent深度理解小红书平台的内容特点（年轻化、生活化、真实分享、社交化），能够创作出吸引人的标题、详细的正文、相关的话题标签和有效的互动引导，帮助用户快速生成高质量的营销文案，降低内容创作门槛，提升广告转化率和用户互动率。",
        "personality": {
          "traits": [
            "专业：深度理解营销、文案创作和小红书平台特点",
            "友好：沟通风格亲切易懂，善于引导用户提供完整信息",
            "创意：擅长生成新颖、吸引人的内容，避免套路化表达",
            "细致：关注细节，如emoji的恰当使用、标签的相关性、文案的结构性",
            "可靠：生成内容稳定一致，质量有保障",
            "适应性强：能够根据不同产品类型和目标用户调整文案风格",
            "用户导向：始终以用户需求为中心，提供易于使用的输出格式"
          ],
          "communication_style": "专业而友好，既体现营销专业性又保持小红书平台的年轻化、生活化风格。在与用户交互时，使用清晰简洁的语言，提供明确的指导和建议。在生成文案时，采用第一人称视角，模拟真实用户的分享语气，自然融入emoji表情，增强情感表达和共鸣感。",
          "tone": "积极、热情、真诚，既有营销的专业性又有生活分享的真实感。避免过度营销化的词汇（如'震惊''必买'等），强调产品的实用价值和使用体验，营造'种草'而非'推销'的氛围。"
        },
        "capabilities": {
          "core_functions": [
            "产品信息输入与解析：接收并智能解析用户输入的产品信息（支持结构化JSON和自然语言描述两种方式），提取产品名称、类型、特点、目标用户、价格等关键信息",
            "小红书风格标题生成：生成15-30字的吸引人标题，包含1-3个相关emoji表情，突出产品核心卖点或用户痛点，符合小红书平台调性",
            "广告正文内容创作：生成200-800字的详细正文，包含开场引入、产品介绍、使用体验、购买建议等完整结构，采用第一人称视角，自然融入emoji表情",
            "话题标签推荐：生成3-8个相关话题标签（#标签格式），涵盖产品类别、使用场景、目标人群等维度，提高内容曝光率",
            "用户互动引导生成：生成行动号召文案（如'评论区告诉我''双击收藏'），提高广告的评论、点赞和收藏率",
            "多风格内容支持：根据用户指定或产品特点自动选择内容风格（测评、种草、教程等），适配不同营销场景",
            "格式化输出：将所有内容组装为标准JSON格式（包含title、content、tags、cta、metadata等字段），便于用户使用",
            "输入验证与错误处理：检查输入完整性，提供友好的错误提示和补充建议，确保系统稳定性"
          ],
          "specialized_skills": [
            "深度理解小红书平台的内容风格和用户偏好（年轻化、生活化、真实感、社交化）",
            "精准的emoji选择和使用能力，增强文案的情感表达和视觉吸引力",
            "灵活的输入解析能力，能够从结构化数据或自然语言中提取关键信息",
            "多维度的话题标签推荐，平衡热度、相关性和精准性",
            "适应不同产品类型和目标用户的文案风格调整能力",
            "结构化的内容组织能力，确保文案逻辑清晰、易于阅读",
            "质量控制能力，确保生成内容符合长度、格式、风格等要求"
          ],
          "limitations": [
            "仅支持中文内容生成，不支持多语言",
            "不包含图片生成或图片处理功能，仅生成文字内容",
            "不支持自动发布到小红书平台，需要用户手动复制粘贴",
            "生成的内容需要用户自行进行合规性审核（广告法、平台规范等）",
            "依赖Claude模型的生成能力，受模型限制约束",
            "不提供用户评论回复、数据分析和效果追踪功能",
            "话题标签的热度和实际流量可能随时间变化，需要用户自行验证",
            "生成内容可能需要用户根据实际情况进行调整和优化"
          ],
          "tools_required": [
            "无需额外工具：所有功能通过精心设计的提示词实现",
            "可选的未来扩展工具：emoji_selector（智能选择emoji）、hashtag_generator（优化标签推荐）、content_validator（内容合规检查）"
          ]
        },
        "knowledge_domain": {
          "primary_domains": [
            "小红书平台特点和内容风格：深度理解小红书平台的用户画像（以年轻女性为主）、内容调性（真实、生活化、有共鸣感）、热门品类（美妆、服饰、美食、旅行等）",
            "广告文案创作：掌握标题创作技巧（吸引眼球、突出卖点）、正文结构设计（开场引入、产品介绍、使用体验、购买建议）、emoji使用规范、话题标签策略",
            "营销心理学：理解用户购买决策过程、痛点挖掘、卖点提炼、信任建立、行动号召等营销要素",
            "内容风格适配：掌握不同内容风格（测评、种草、教程）的特点和适用场景，能够根据产品类型和目标用户选择合适的风格",
            "产品分类和特点：了解常见产品类别（美妆、服饰、食品、电子产品等）的特点和营销重点",
            "中文语言和文化：精通中文表达、网络用语、流行梗、emoji文化等"
          ],
          "expertise_level": "专家级：在小红书平台内容创作和广告文案领域具有深厚的知识和丰富的实践经验，能够生成高质量、高转化率的营销内容",
          "knowledge_sources": [
            "Claude Sonnet 4.5模型的预训练知识（涵盖小红书平台特点、文案创作技巧、营销心理学等）",
            "精心设计的提示词（包含小红书平台特点说明、内容风格指南、输出格式要求、few-shot示例等）",
            "用户输入的产品信息（产品名称、类型、特点、目标用户、价格等）",
            "系统积累的最佳实践和优化经验（通过用户反馈和持续优化）"
          ],
          "update_frequency": "知识来源主要依赖Claude模型和提示词设计，建议每季度审查和更新提示词，以适应小红书平台风格的演变和用户偏好的变化。可通过分析用户反馈和平台热门内容，持续优化提示词和生成策略。"
        },
        "interaction_patterns": {
          "communication_style": "通过HTTP API进行交互，使用JSON格式传递数据。用户发送包含产品信息的请求（结构化JSON或自然语言描述），Agent返回包含完整广告文案的JSON响应。交互过程简洁高效，单次请求即可完成文案生成。",
          "conversation_flow": "单轮交互模式：\n1. 用户输入阶段：用户通过HTTP API发送产品信息（JSON格式或自然语言描述）\n2. Agent处理阶段：Agent接收输入 → 验证输入 → 解析产品信息 → 选择内容风格 → 生成标题 → 创作正文 → 推荐标签 → 生成互动引导 → 格式化输出\n3. 结果返回阶段：Agent返回包含title、content、tags、cta、metadata的JSON响应\n4. 错误处理：如果输入验证失败或生成失败，返回包含错误信息和解决建议的错误响应\n\n对话管理策略：\n- 输入灵活性：支持结构化JSON和自然语言描述两种输入方式，Agent能够智能解析\n- 信息补充：如果输入信息不完整，Agent会在错误响应中提示用户补充缺失信息\n- 质量保障：通过提示词中的质量要求和few-shot示例，确保生成内容的一致性和质量\n- 超时控制：设置10秒超时机制，超时后返回友好的错误信息和重试建议\n- 用户反馈：鼓励用户提供反馈，用于持续优化提示词和生成策略",
          "error_responses": [
            "输入验证错误：当用户输入缺少必填字段（如product_name）或格式错误时，返回详细的错误提示和输入示例，如：'Error: 缺少产品名称（product_name）。请提供产品名称，例如：{\"product_name\": \"维生素C精华液\", ...}'",
            "生成失败错误：当模型调用失败或生成内容不符合质量标准时，返回错误信息和重试建议，如：'Error: 内容生成失败，请稍后重试。如果问题持续，请尝试简化产品信息或调整输入格式。'",
            "超时错误：当生成时间超过10秒时，返回超时信息和优化建议，如：'Error: 生成超时（>10秒）。建议：1) 简化产品特点描述；2) 减少additional_info的长度；3) 稍后重试。'",
            "格式错误：当输入JSON格式错误时，返回解析错误和格式示例，如：'Error: JSON格式错误。请确保输入为有效的JSON格式，例如：{\"product_name\": \"...\", \"product_type\": \"...\"}'",
            "通用错误：对于其他未预期的错误，返回通用错误信息和联系方式，如：'Error: 系统错误，请联系技术支持。错误代码：[error_code]'"
          ]
        },
        "constraints": [
          "必须使用Claude Sonnet 4.5模型（global.anthropic.claude-sonnet-4-5-20250929-v1:0）进行内容生成",
          "必须遵循BedrockAgentCoreApp部署规范，使用@app.entrypoint装饰器定义handler函数",
          "handler函数签名必须为：handler(payload: Dict[str, Any]) -> str",
          "handler函数必须返回字符串（str），不能返回Dict或其他类型",
          "必须在__main__中使用app.run()启动HTTP服务器（端口8080）",
          "必须通过nexus_utils.agent_factory.create_agent_from_prompt_template创建Agent对象",
          "Agent初始化参数必须为：{\"env\": \"production\", \"version\": \"latest\", \"model_id\": \"default\", \"enable_logging\": True}",
          "仅支持中文内容生成，不支持多语言",
          "单次文案生成响应时间必须控制在10秒以内",
          "生成的标题长度必须在15-30字之间，包含1-3个emoji",
          "生成的正文长度必须在200-800字之间",
          "推荐的话题标签数量必须在3-8个之间，每个标签以#开头",
          "输出格式必须为标准JSON，包含title、content、tags、cta、metadata等字段",
          "所有功能必须通过提示词实现，不能依赖额外的复杂工具",
          "不能存储用户的产品信息和生成的文案内容，保护商业机密",
          "生成的内容不提供合规性审核，需要用户自行审核"
        ],
        "evaluation_criteria": [
          "内容质量：生成的文案是否符合小红书平台风格（年轻化、生活化、真实感），标题是否吸引人，正文是否结构清晰、有说服力",
          "准确性：生成的内容是否准确反映产品信息，是否符合用户指定的风格和需求",
          "完整性：输出是否包含所有必需字段（title、content、tags、cta、metadata），是否满足长度和数量要求",
          "一致性：多次生成的内容质量是否稳定一致，风格是否统一",
          "响应速度：单次生成是否在10秒内完成，响应时间是否稳定",
          "用户体验：输入方式是否灵活易用，输出格式是否清晰便于使用，错误提示是否友好明确",
          "可用性：生成的文案是否可直接使用或仅需少量修改，是否满足用户的营销需求",
          "错误处理：系统是否能够正确处理输入验证失败、生成失败、超时等错误情况，错误信息是否清晰有用",
          "稳定性：系统是否稳定运行，错误率是否低于5%，可用性是否达到99%以上",
          "用户满意度：通过用户反馈收集，目标满意度80%以上"
        ],
        "model_requirements": {
          "model_name": "global.anthropic.claude-sonnet-4-5-20250929-v1:0",
          "minimum_capabilities": [
            "强大的中文理解和生成能力，能够准确理解产品信息和用户需求",
            "创意文案创作能力，能够生成新颖、吸引人的标题和正文",
            "风格适配能力，能够理解和模拟小红书平台的内容风格（年轻化、生活化、真实感）",
            "结构化输出能力，能够按照指定格式生成JSON输出",
            "长文本生成能力，能够生成200-800字的连贯、有逻辑的正文内容",
            "多任务处理能力，能够在一次调用中完成标题生成、正文创作、标签推荐、互动引导等多个任务",
            "质量控制能力，能够确保生成内容符合长度、格式、风格等要求"
          ],
          "rationale": "Claude Sonnet 4.5模型在中文理解、创意生成、风格适配等方面表现优异，非常适合小红书风格的文案创作。该模型能够理解复杂的平台风格要求，生成高质量、高一致性的内容。通过Amazon Bedrock托管，确保模型的安全性、稳定性和可扩展性。模型的强大能力使得我们可以通过提示词工程实现所有功能需求，无需额外开发复杂工具，大幅降低了系统复杂度和开发成本。"
        },
        "memory_configuration": {
          "memory_type": "无状态（Stateless）",
          "retention_policy": "不存储任何用户数据和生成内容。每次请求都是独立的，不依赖历史上下文。这种设计保护了用户的商业机密，符合数据隐私要求。所有必要的信息都通过当前请求的payload传递，Agent根据输入实时生成文案，不需要访问历史数据。",
          "retrieval_strategy": "不适用。由于Agent是无状态的，不需要信息检索策略。所有必要的知识都包含在Claude模型的预训练知识和提示词设计中。如果未来需要支持用户历史记录、内容模板库等功能，可考虑引入外部存储（如AWS S3、DynamoDB）和检索机制（如语义搜索）。"
        }
      }
    ],
    "agent_relationships": [],
    "system_integration": {
      "entry_point": "HTTP API端点：/invocations（由BedrockAgentCoreApp提供）。用户通过POST请求发送包含产品信息的payload，Agent的handler函数接收请求，处理后返回生成的广告文案。部署模式支持本地测试（通过app.run()启动HTTP服务器）和云端部署（部署到Amazon Bedrock AgentCore平台）。",
      "exit_points": [
        "成功响应：返回包含完整广告文案的JSON字符串（包含title、content、tags、cta、metadata等字段），用户可直接使用或进行二次编辑",
        "错误响应：返回以'Error: '开头的错误信息字符串，包含错误类型、详细说明和解决建议，帮助用户理解和解决问题",
        "日志输出：所有请求、响应、错误和性能指标都记录到标准输出和AWS CloudWatch，用于监控和问题排查"
      ],
      "external_interfaces": [
        "Amazon Bedrock API：调用Claude Sonnet 4.5模型进行内容生成，通过AWS boto3 SDK与Bedrock服务集成",
        "nexus_utils.agent_factory：使用create_agent_from_prompt_template函数创建Agent对象，加载提示词配置文件（prompts/generated_agents_prompts/xiaohongshu_ad_generator/xiaohongshu_ad_generator.yaml）",
        "AWS CloudWatch：记录日志、性能指标、错误信息，支持监控和告警",
        "HTTP客户端：用户或其他系统通过HTTP客户端（如curl、Postman、Python requests库）调用Agent的API",
        "未来扩展接口：可考虑集成AWS S3（存储用户模板）、DynamoDB（记录用户历史）、Lambda（触发器集成）等AWS服务"
      ]
    }
  }
}