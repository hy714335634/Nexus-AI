{\n  \"agent_code_development\": {\n    \"development_overview\": {\n      \"project_name\": \"aws_network_topology_audit\",\n      \"version\": \"1.0\",\n      \"date\": \"2025-11-11\",\n      \"development_scope\": \"开发AWS网络拓扑可视化智能体，能够收集AWS网络资源信息，分析网络连接关系，生成可视化的网络拓扑图，并高亮显示网络边界，以满足审计要求。\",\n      \"design_principles\": [\n        \"模块化设计，将数据收集、关系分析和可视化功能分离\",\n        \"安全性优先，遵循最小权限原则\",\n        \"健壮的错误处理和重试机制\",\n        \"支持大规模AWS环境的高性能处理\",\n        \"用户友好的命令行界面和交互模式\"\n      ],\n      \"key_decisions\": [\n        \"基于data_analyzer_agent模板进行定制化开发\",\n        \"使用NetworkTopologyVisualizer类封装主要功能\",\n        \"支持多种运行模式（完整分析、仅收集、仅分析、仅可视化）\",\n        \"支持跨区域和跨账户资源收集和分析\",\n        \"使用命令行参数配置运行选项\"\n      ]\n    },\n    \"agent_implementation\": {\n      \"agent_name\": \"aws_network_topology_visualizer\",\n      \"file_path\": \"agents/generated_agents/aws_network_topology_audit/aws_network_topology_visualizer.py\",\n      \"main_class\": \"NetworkTopologyVisualizer\",\n      \"entry_point\": \"main\",\n      \"dependencies\": [\n        \"os\",\n        \"json\",\n        \"argparse\",\n        \"logging\",\n        \"typing\",\n        \"nexus_utils.agent_factory\",\n        \"strands.telemetry\"\n      ],\n      \"imports\": [\n        \"from nexus_utils.agent_factory import create_agent_from_prompt_template\",\n        \"from strands.telemetry import StrandsTelemetry\"\n      ]\n    },\n    \"core_functions\": [\n      {\n        \"function_name\": \"__init__\",\n        \"purpose\": \"初始化网络拓扑可视化工具\",\n        \"parameters\": [\n          {\n            \"name\": \"profile_name\",\n            \"type\": \"Optional[str]\",\n            \"description\": \"AWS配置文件名称\",\n            \"required\": false\n          },\n          {\n            \"name\": \"regions\",\n            \"type\": \"Optional[List[str]]\",\n            \"description\": \"要分析的AWS区域列表\",\n            \"required\": false\n          },\n          {\n            \"name\": \"accounts\",\n            \"type\": \"Optional[List[Dict[str, str]]]\",\n            \"description\": \"要分析的AWS账户列表，每个账户为包含account_id和role_name的字典\",\n            \"required\": false\n          },\n          {\n            \"name\": \"output_dir\",\n            \"type\": \"str\",\n            \"description\": \"输出目录路径\",\n            \"required\": false\n          }\n        ],\n        \"return_type\": \"None\",\n        \"return_description\": \"无返回值\",\n        \"implementation_notes\": [\n          \"初始化类属性\",\n          \"创建输出目录\",\n          \"创建智能体实例\"\n        ]\n      },\n      {\n        \"function_name\": \"_create_agent\",\n        \"purpose\": \"创建AWS网络拓扑可视化智能体\",\n        \"parameters\": [],\n        \"return_type\": \"Agent\",\n        \"return_description\": \"创建的智能体实例\",\n        \"implementation_notes\": [\n          \"使用create_agent_from_prompt_template创建智能体\",\n          \"设置智能体参数（环境、版本、模型ID）\"\n        ]\n      },\n      {\n        \"function_name\": \"collect_resources\",\n        \"purpose\": \"收集AWS网络资源信息\",\n        \"parameters\": [\n          {\n            \"name\": \"resource_types\",\n            \"type\": \"Optional[List[str]]\",\n            \"description\": \"要收集的资源类型列表，如果为None则收集所有类型\",\n            \"required\": false\n          }\n        ],\n        \"return_type\": \"Dict[str, Any]\",\n        \"return_description\": \"包含收集到的资源信息的字典\",\n        \"implementation_notes\": [\n          \"构建资源收集提示词\",\n          \"调用智能体执行资源收集\",\n          \"返回收集结果\"\n        ]\n      },\n      {\n        \"function_name\": \"analyze_connections\",\n        \"purpose\": \"分析网络连接关系\",\n        \"parameters\": [\n          {\n            \"name\": \"resources\",\n            \"type\": \"Dict[str, Any]\",\n            \"description\": \"收集到的资源信息\",\n            \"required\": true\n          }\n        ],\n        \"return_type\": \"Dict[str, Any]\",\n        \"return_description\": \"包含连接分析结果的字典\",\n        \"implementation_notes\": [\n          \"构建连接分析提示词\",\n          \"调用智能体执行连接分析\",\n          \"返回分析结果\"\n        ]\n      },\n      {\n        \"function_name\": \"generate_topology_graph\",\n        \"purpose\": \"生成网络拓扑图\",\n        \"parameters\": [\n          {\n            \"name\": \"connections\",\n            \"type\": \"Dict[str, Any]\",\n            \"description\": \"连接分析结果\",\n            \"required\": true\n          },\n          {\n            \"name\": \"output_format\",\n            \"type\": \"str\",\n            \"description\": \"输出格式（png, jpg, svg）\",\n            \"required\": false\n          },\n          {\n            \"name\": \"highlight_boundaries\",\n            \"type\": \"bool\",\n            \"description\": \"是否高亮显示网络边界\",\n            \"required\": false\n          }\n        ],\n        \"return_type\": \"str\",\n        \"return_description\": \"生成的拓扑图文件路径\",\n        \"implementation_notes\": [\n          \"构建拓扑图生成提示词\",\n          \"调用智能体执行拓扑图生成\",\n          \"返回生成的拓扑图文件路径\"\n        ]\n      },\n      {\n        \"function_name\": \"run_full_analysis\",\n        \"purpose\": \"运行完整的网络拓扑分析流程\",\n        \"parameters\": [\n          {\n            \"name\": \"resource_types\",\n            \"type\": \"Optional[List[str]]\",\n            \"description\": \"要收集的资源类型列表\",\n            \"required\": false\n          },\n          {\n            \"name\": \"output_format\",\n            \"type\": \"str\",\n            \"description\": \"输出格式\",\n            \"required\": false\n          },\n          {\n            \"name\": \"highlight_boundaries\",\n            \"type\": \"bool\",\n            \"description\": \"是否高亮显示网络边界\",\n            \"required\": false\n          }\n        ],\n        \"return_type\": \"Dict[str, Any]\",\n        \"return_description\": \"包含分析结果和拓扑图路径的字典\",\n        \"implementation_notes\": [\n          \"构建完整分析流程提示词\",\n          \"调用智能体执行完整分析\",\n          \"返回分析结果\"\n        ]\n      },\n      {\n        \"function_name\": \"parse_arguments\",\n        \"purpose\": \"解析命令行参数\",\n        \"parameters\": [],\n        \"return_type\": \"argparse.Namespace\",\n        \"return_description\": \"解析后的命令行参数\",\n        \"implementation_notes\": [\n          \"创建ArgumentParser实例\",\n          \"添加各种命令行参数选项\",\n          \"返回解析结果\"\n        ]\n      },\n      {\n        \"function_name\": \"main\",\n        \"purpose\": \"主函数\",\n        \"parameters\": [],\n        \"return_type\": \"None\",\n        \"return_description\": \"无返回值\",\n        \"implementation_notes\": [\n          \"解析命令行参数\",\n          \"创建NetworkTopologyVisualizer实例\",\n          \"根据运行模式执行相应操作\",\n          \"处理结果输出\"\n        ]\n      }\n    ],\n    \"tool_integration\": {\n      \"custom_tools\": [\n        \"boto3_client_tool\",\n        \"boto3_resource_tool\",\n        \"networkx_graph_tool\",\n        \"graphviz_renderer_tool\",\n        \"matplotlib_plotter_tool\",\n        \"file_manager_tool\",\n        \"credential_manager_tool\"\n      ],\n      \"system_tools\": [\n        \"file_read\",\n        \"file_write\",\n        \"current_time\",\n        \"use_aws\"\n      ],\n      \"strands_tools\": [\n        \"StrandsTelemetry\"\n      ],\n      \"integration_notes\": [\n        \"通过智能体提示词模板集成工具\",\n        \"使用boto3_client和boto3_resource工具访问AWS资源\",\n        \"使用networkx_graph工具构建和分析网络拓扑图\",\n        \"使用graphviz_renderer和matplotlib_plotter工具可视化网络拓扑图\",\n        \"使用file_manager工具管理文件输入输出\",\n        \"使用credential_manager工具安全管理AWS凭证\"\n      ]\n    },\n    \"configuration\": {\n      \"environment_variables\": [\n        \"BYPASS_TOOL_CONSENT\",\n        \"OTEL_EXPORTER_OTLP_ENDPOINT\"\n      ],\n      \"model_configuration\": {\n        \"model_name\": \"default\",\n        \"max_tokens\": 60000,\n        \"temperature\": 0.3,\n        \"top_p\": 0.8\n      },\n      \"streaming_config\": {\n        \"enabled\": true,\n        \"chunk_size\": 1024\n      }\n    },\n    \"error_handling\": {\n      \"exception_types\": [\n        \"JSONDecodeError\",\n        \"FileNotFoundError\",\n        \"PermissionError\",\n        \"ConnectionError\",\n        \"TimeoutError\"\n      ],\n      \"error_responses\": [\n        \"Invalid JSON format for accounts parameter\",\n        \"Input file is required for analyze mode\",\n        \"Input file is required for visualize mode\"\n      ],\n      \"recovery_strategies\": [\n        \"日志记录错误信息\",\n        \"提供清晰的错误消息\",\n        \"优雅退出程序\"\n      ]\n    },\n    \"testing\": {\n      \"test_cases\": [\n        \"使用默认配置文件收集单一区域的网络资源\",\n        \"分析跨区域连接\",\n        \"分析跨账户连接\",\n        \"生成不同格式的拓扑图\",\n        \"处理无效的AWS凭证\"\n      ],\n      \"test_scenarios\": [\n        \"完整分析流程\",\n        \"仅收集资源\",\n        \"仅分析连接\",\n        \"仅生成可视化\"\n      ],\n      \"validation_criteria\": [\n        \"成功收集AWS网络资源\",\n        \"正确识别各种连接类型\",\n        \"正确高亮显示网络边界\",\n        \"生成清晰可读的拓扑图\",\n        \"正确处理错误情况\"\n      ]\n    },\n    \"deployment\": {\n      \"deployment_requirements\": [\n        \"Python 3.13+\",\n        \"boto3\",\n        \"networkx\",\n        \"graphviz\",\n        \"matplotlib\",\n        \"pyyaml\"\n      ],\n      \"runtime_dependencies\": [\n        \"AWS凭证配置\",\n        \"Graphviz安装\",\n        \"足够的权限访问AWS资源\"\n      ],\n      \"performance_considerations\": [\n        \"大规模环境可能需要较长处理时间\",\n        \"复杂拓扑图渲染可能需要较大内存\",\n        \"API调用频率受AWS服务限制约束\"\n      ]\n    },\n    \"development_notes\": \"在开发过程中，我们基于data_analyzer_agent模板进行了定制化开发，以满足AWS网络拓扑可视化的特定需求。我们采用了模块化设计，将功能分为数据收集、关系分析和可视化渲染三个主要模块，便于代码组织和未来扩展。我们实现了多种运行模式，使用户可以灵活选择执行完整分析流程或仅执行特定步骤。为了支持跨区域和跨账户分析，我们设计了灵活的参数配置方式。我们还添加了详细的日志记录和错误处理机制，提高了系统的健壮性和可靠性。\"\n  }\n}