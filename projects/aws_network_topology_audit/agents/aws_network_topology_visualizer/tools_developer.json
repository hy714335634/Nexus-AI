{
  "tool_development": {
    "development_overview": {
      "project_name": "aws_network_topology_audit",
      "version": "1.0",
      "date": "2025-11-11",
      "development_scope": "开发用于AWS网络拓扑可视化和审计的工具集，支持跨区域和跨账户网络资源收集、拓扑分析和可视化",
      "design_principles": [
        "模块化设计，每个工具专注于特定功能",
        "安全性优先，遵循最小权限原则",
        "健壮的错误处理和重试机制",
        "支持大规模AWS环境的高性能处理",
        "提供多种可视化选项和格式"
      ],
      "key_decisions": [
        "使用boto3进行AWS资源访问，支持跨区域和跨账户操作",
        "采用NetworkX进行网络图构建和分析",
        "同时支持Graphviz和Matplotlib两种可视化引擎",
        "实现缓存机制减少API调用",
        "提供安全的凭证管理机制"
      ]
    },
    "tools": [
      {
        "tool_name": "boto3_client",
        "description": "创建和管理AWS API客户端，支持跨区域和跨账户访问",
        "function_signature": "boto3_client(service_name: str, region_name: Optional[str] = None, profile_name: Optional[str] = None, role_arn: Optional[str] = None, session_name: str = \"NetworkTopologyAudit\", session_duration: int = 3600, endpoint_url: Optional[str] = None, use_ssl: bool = True, verify: Union[bool, str] = True, config: Optional[Dict[str, Any]] = None) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "service_name",
            "type": "str",
            "description": "AWS服务名称（如'ec2', 'vpc'）",
            "required": true
          },
          {
            "name": "region_name",
            "type": "Optional[str]",
            "description": "AWS区域名称，如果为None则使用默认区域",
            "required": false
          },
          {
            "name": "profile_name",
            "type": "Optional[str]",
            "description": "AWS配置文件名称，如果为None则使用默认配置",
            "required": false
          },
          {
            "name": "role_arn",
            "type": "Optional[str]",
            "description": "用于跨账户访问的IAM角色ARN",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含客户端信息和状态的字典",
        "dependencies": ["boto3", "botocore.exceptions"],
        "implementation_notes": [
          "支持通过profile_name使用AWS配置文件",
          "支持通过role_arn进行跨账户访问",
          "实现了错误处理和重试机制",
          "提供了多区域和多账户客户端创建功能"
        ],
        "error_handling": [
          "处理NoCredentialsError异常",
          "处理ProfileNotFound异常",
          "处理ClientError异常",
          "实现指数退避重试策略"
        ],
        "usage_examples": [
          "创建EC2客户端: boto3_client('ec2', region_name='us-east-1')",
          "创建跨账户客户端: boto3_client('ec2', role_arn='arn:aws:iam::123456789012:role/CrossAccountRole')"
        ]
      },
      {
        "tool_name": "boto3_resource",
        "description": "创建和管理AWS资源对象，提供高级对象接口",
        "function_signature": "boto3_resource(service_name: str, region_name: Optional[str] = None, profile_name: Optional[str] = None, role_arn: Optional[str] = None, session_name: str = \"NetworkTopologyAudit\", session_duration: int = 3600, endpoint_url: Optional[str] = None, use_ssl: bool = True, verify: Union[bool, str] = True, config: Optional[Dict[str, Any]] = None) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "service_name",
            "type": "str",
            "description": "AWS服务名称（如'ec2', 's3'）",
            "required": true
          },
          {
            "name": "region_name",
            "type": "Optional[str]",
            "description": "AWS区域名称，如果为None则使用默认区域",
            "required": false
          },
          {
            "name": "profile_name",
            "type": "Optional[str]",
            "description": "AWS配置文件名称，如果为None则使用默认配置",
            "required": false
          },
          {
            "name": "role_arn",
            "type": "Optional[str]",
            "description": "用于跨账户访问的IAM角色ARN",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含资源对象信息和状态的字典",
        "dependencies": ["boto3", "botocore.exceptions"],
        "implementation_notes": [
          "提供对象化的AWS资源访问接口",
          "支持资源集合的过滤和缓存",
          "实现了跨账户和跨区域资源收集功能",
          "支持多种资源类型（VPC、子网、安全组等）"
        ],
        "error_handling": [
          "处理NoCredentialsError异常",
          "处理ProfileNotFound异常",
          "处理ClientError异常",
          "实现资源不存在的优雅处理"
        ],
        "usage_examples": [
          "收集VPC资源: boto3_resource_collection('ec2', 'vpc')",
          "跨账户收集资源: boto3_multi_account_resource('ec2', accounts=[{'account_id': '123456789012', 'role_name': 'CrossAccountRole'}])"
        ]
      },
      {
        "tool_name": "networkx_graph",
        "description": "构建和分析AWS网络拓扑图",
        "function_signature": "create_network_graph(nodes: List[Dict[str, Any]], edges: List[Dict[str, Any]], directed: bool = True, multigraph: bool = False, graph_attrs: Optional[Dict[str, Any]] = None) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "nodes",
            "type": "List[Dict[str, Any]]",
            "description": "节点列表，每个节点至少包含'id'和'type'键",
            "required": true
          },
          {
            "name": "edges",
            "type": "List[Dict[str, Any]]",
            "description": "边列表，每个边至少包含'source'、'target'和'type'键",
            "required": true
          },
          {
            "name": "directed",
            "type": "bool",
            "description": "是否创建有向图",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含图信息和统计数据的字典",
        "dependencies": ["networkx", "networkx.algorithms"],
        "implementation_notes": [
          "使用NetworkX构建图数据结构",
          "支持有向图和无向图",
          "支持多重图（允许节点间有多条边）",
          "实现了网络边界识别和路径分析功能"
        ],
        "error_handling": [
          "处理空图情况",
          "处理无效节点和边的情况",
          "处理图算法异常",
          "提供详细的错误信息"
        ],
        "usage_examples": [
          "创建网络图: create_network_graph(nodes, edges)",
          "分析网络边界: identify_network_boundaries(graph_json)",
          "查找网络路径: find_network_paths(graph_json, source_filters, target_filters)"
        ]
      },
      {
        "tool_name": "graphviz_renderer",
        "description": "将网络图渲染为可视化图形",
        "function_signature": "render_network_graph(graph_json: Dict[str, Any], output_format: str = \"png\", layout_engine: str = \"dot\", show_labels: bool = True, show_attributes: bool = False, custom_styles: Optional[Dict[str, Dict[str, str]]] = None, highlight_nodes: Optional[List[str]] = None, highlight_edges: Optional[List[Tuple[str, str]]] = None, cluster_by: Optional[str] = None, title: Optional[str] = None, dpi: int = 300, base64_encode: bool = False) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "graph_json",
            "type": "Dict[str, Any]",
            "description": "序列化的图数据（由create_network_graph返回）",
            "required": true
          },
          {
            "name": "output_format",
            "type": "str",
            "description": "输出格式（png, jpg, svg, pdf）",
            "required": false
          },
          {
            "name": "layout_engine",
            "type": "str",
            "description": "Graphviz布局引擎（dot, neato, fdp, sfdp, twopi, circo）",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含渲染结果的字典",
        "dependencies": ["graphviz", "tempfile", "base64"],
        "implementation_notes": [
          "使用Graphviz渲染网络图",
          "为AWS资源类型定义了专用样式",
          "支持多种输出格式（PNG、JPG、SVG、PDF）",
          "支持节点分组和边界高亮显示"
        ],
        "error_handling": [
          "处理无效输出格式",
          "处理无效布局引擎",
          "处理渲染错误",
          "提供详细的错误信息"
        ],
        "usage_examples": [
          "渲染网络图: render_network_graph(graph_json, output_format='png')",
          "渲染网络边界: render_network_boundaries(graph_json, boundaries_json)",
          "渲染网络路径: render_network_paths(graph_json, paths_json)"
        ]
      },
      {
        "tool_name": "matplotlib_plotter",
        "description": "使用Matplotlib创建和自定义图形输出",
        "function_signature": "plot_network_graph(graph_json: Dict[str, Any], output_format: str = \"png\", layout_type: str = \"spring\", show_labels: bool = True, node_size: int = 300, font_size: int = 8, figsize: Tuple[int, int] = (12, 10), dpi: int = 300, custom_colors: Optional[Dict[str, str]] = None, highlight_nodes: Optional[List[str]] = None, highlight_edges: Optional[List[Tuple[str, str]]] = None, group_by: Optional[str] = None, title: Optional[str] = None, base64_encode: bool = False) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "graph_json",
            "type": "Dict[str, Any]",
            "description": "序列化的图数据（由create_network_graph返回）",
            "required": true
          },
          {
            "name": "output_format",
            "type": "str",
            "description": "输出格式（png, jpg, svg, pdf）",
            "required": false
          },
          {
            "name": "layout_type",
            "type": "str",
            "description": "布局算法（spring, kamada_kawai, spectral, circular, shell）",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含绘图结果的字典",
        "dependencies": ["matplotlib", "numpy", "networkx"],
        "implementation_notes": [
          "使用Matplotlib绘制网络图",
          "提供多种布局算法选项",
          "支持自定义节点和边的样式",
          "实现了仪表板功能，集成多种可视化"
        ],
        "error_handling": [
          "处理无效输出格式",
          "处理无效布局类型",
          "处理绘图错误",
          "确保图形资源正确释放"
        ],
        "usage_examples": [
          "绘制网络图: plot_network_graph(graph_json, layout_type='spring')",
          "创建网络仪表板: create_network_dashboard(graph_json, boundaries_json, paths_json)"
        ]
      },
      {
        "tool_name": "file_manager",
        "description": "管理文件输入输出，包括保存和加载拓扑图",
        "function_signature": "save_network_graph(graph_json: Dict[str, Any], file_path: Optional[str] = None, file_format: str = \"json\", include_metadata: bool = True, pretty_print: bool = True, compress: bool = False) -> Dict[str, Any]",
        "parameters": [
          {
            "name": "graph_json",
            "type": "Dict[str, Any]",
            "description": "序列化的图数据（由create_network_graph返回）",
            "required": true
          },
          {
            "name": "file_path",
            "type": "Optional[str]",
            "description": "保存文件的路径，如果为None则使用默认路径",
            "required": false
          },
          {
            "name": "file_format",
            "type": "str",
            "description": "文件格式（json, yaml, pickle）",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含保存结果的字典",
        "dependencies": ["json", "yaml", "pickle", "gzip"],
        "implementation_notes": [
          "支持多种文件格式（JSON、YAML、pickle）",
          "支持保存和加载网络图数据",
          "支持导出为CSV格式进行进一步分析",
          "实现了文件压缩和元数据管理"
        ],
        "error_handling": [
          "处理无效文件格式",
          "处理文件写入错误",
          "处理文件读取错误",
          "处理文件不存在的情况"
        ],
        "usage_examples": [
          "保存网络图: save_network_graph(graph_json, file_format='json')",
          "加载网络图: load_network_graph(file_path)",
          "导出网络数据: export_network_data(graph_json, export_type='nodes', file_format='csv')"
        ]
      },
      {
        "tool_name": "credential_manager",
        "description": "安全管理AWS凭证",
        "function_signature": "validate_aws_credentials(profile_name: Optional[str] = None, region_name: Optional[str] = None, access_key_id: Optional[str] = None, secret_access_key: Optional[str] = None, session_token: Optional[str] = None, test_service: str = \"sts\") -> Dict[str, Any]",
        "parameters": [
          {
            "name": "profile_name",
            "type": "Optional[str]",
            "description": "AWS配置文件名称，如果提供则忽略其他凭证参数",
            "required": false
          },
          {
            "name": "region_name",
            "type": "Optional[str]",
            "description": "AWS区域名称，如果为None则使用默认区域",
            "required": false
          },
          {
            "name": "access_key_id",
            "type": "Optional[str]",
            "description": "AWS访问密钥ID，如果profile_name未提供则必须提供",
            "required": false
          }
        ],
        "return_type": "Dict[str, Any]",
        "return_description": "包含验证结果的字典",
        "dependencies": ["boto3", "botocore.exceptions"],
        "implementation_notes": [
          "支持多种凭证提供方式（配置文件、访问密钥、角色）",
          "实现了角色假设功能，支持跨账户访问",
          "提供了权限需求分析功能",
          "支持AWS配置文件的创建和管理"
        ],
        "error_handling": [
          "处理无效凭证",
          "处理权限不足的情况",
          "处理配置文件不存在的情况",
          "处理角色假设失败的情况"
        ],
        "usage_examples": [
          "验证凭证: validate_aws_credentials(profile_name='default')",
          "假设角色: assume_role(role_arn='arn:aws:iam::123456789012:role/CrossAccountRole')",
          "获取所需权限: get_required_permissions(resource_types=['vpc', 'subnet'])"
        ]
      }
    ],
    "code_quality": {
      "code_standards": [
        "遵循PEP 8代码风格指南",
        "使用类型注解提高代码可读性和安全性",
        "提供详细的文档字符串",
        "使用一致的命名约定",
        "模块化设计，职责清晰"
      ],
      "testing_strategy": [
        "单元测试覆盖关键功能",
        "处理边缘情况和错误条件",
        "模拟AWS API响应进行测试",
        "验证跨区域和跨账户功能"
      ],
      "performance_considerations": [
        "实现缓存机制减少API调用",
        "批量处理API请求",
        "优化大规模网络图的处理",
        "并行处理多区域数据收集"
      ],
      "security_measures": [
        "遵循最小权限原则",
        "不在代码中存储敏感信息",
        "安全处理凭证信息",
        "支持跨账户访问的安全最佳实践"
      ]
    },
    "integration_details": {
      "aws_services": [
        "EC2 (VPC, 子网, 安全组等)",
        "Transit Gateway",
        "Direct Connect",
        "VPC Peering",
        "PrivateLink",
        "Network Firewall",
        "Route 53",
        "IAM",
        "STS",
        "Organizations"
      ],
      "external_libraries": [
        "boto3 - AWS SDK",
        "networkx - 网络图分析",
        "graphviz - 图形渲染",
        "matplotlib - 图形绘制",
        "numpy - 数值计算",
        "pyyaml - YAML处理"
      ],
      "api_endpoints": [
        "AWS EC2 API",
        "AWS STS API",
        "AWS Organizations API"
      ],
      "data_formats": [
        "JSON - 数据交换和存储",
        "YAML - 配置和数据存储",
        "CSV - 数据导出",
        "图像格式 (PNG, JPG, SVG, PDF)"
      ]
    },
    "development_notes": "在工具开发过程中，我们特别注重安全性和可扩展性。为了确保工具能够处理大规模AWS环境，我们实现了缓存机制和并行处理功能。同时，我们提供了多种可视化选项，以满足不同用户的需求。对于凭证管理，我们采用了最佳安全实践，确保敏感信息不会被不当处理。工具设计遵循模块化原则，每个工具专注于特定功能，便于维护和扩展。"
  }
}