{"tool_development": {
  "development_overview": {
    "project_name": "pubmed_literature_writing_assistant",
    "version": "1.0",
    "date": "2025-10-26",
    "development_scope": "开发PubMed文献处理工具，支持文献元数据加载、文献综述版本管理和处理状态跟踪功能",
    "design_principles": [
      "模块化设计，确保功能组件可独立维护",
      "健壮的错误处理，提供清晰的错误信息",
      "支持并发操作，避免状态冲突",
      "自动创建必要的目录结构",
      "性能优化，处理大量文献时保持稳定"
    ],
    "key_decisions": [
      "使用JSON格式存储和返回数据，确保结构化和可解析",
      "实现文件锁机制处理并发更新问题",
      "采用备份策略确保状态文件安全",
      "自动计算和返回处理进度百分比",
      "基于pathlib进行路径操作，提高跨平台兼容性"
    ]
  },
  "tools": [
    {
      "tool_name": "load_literature_metadata",
      "description": "加载指定research_id下的manifest.json文件，获取所有推荐文献的元数据",
      "function_signature": "load_literature_metadata(research_id: str) -> str",
      "parameters": [
        {
          "name": "research_id",
          "type": "str",
          "description": "研究ID，对应.cache/pmc_literature下的目录名",
          "required": true
        }
      ],
      "return_type": "str",
      "return_description": "JSON格式的文献元数据列表或错误信息",
      "dependencies": ["json", "os", "pathlib.Path"],
      "implementation_notes": [
        "检查研究ID对应的目录是否存在",
        "验证manifest.json文件是否存在且格式有效",
        "返回结构化的JSON数据，包含状态、消息和元数据"
      ],
      "error_handling": [
        "处理目录不存在的情况",
        "处理文件不存在的情况",
        "处理JSON解析错误",
        "处理格式无效的情况"
      ],
      "usage_examples": [
        "load_literature_metadata('research123')"
      ]
    },
    {
      "tool_name": "save_review_version",
      "description": "保存文献综述的特定版本",
      "function_signature": "save_review_version(research_id: str, content: str, version: Union[str, int]) -> str",
      "parameters": [
        {
          "name": "research_id",
          "type": "str",
          "description": "研究ID，对应.cache/pmc_literature下的目录名",
          "required": true
        },
        {
          "name": "content",
          "type": "str",
          "description": "综述内容",
          "required": true
        },
        {
          "name": "version",
          "type": "Union[str, int]",
          "description": "版本标识，可以是数字或'initial'、'final'等特殊标记",
          "required": true
        }
      ],
      "return_type": "str",
      "return_description": "JSON格式的保存状态和文件路径信息",
      "dependencies": ["json", "os", "datetime", "pathlib.Path"],
      "implementation_notes": [
        "自动创建必要的目录结构",
        "使用时间戳生成唯一文件名",
        "支持特殊版本标识如'initial'和'final'",
        "返回详细的文件信息，包括路径和大小"
      ],
      "error_handling": [
        "处理文件写入错误",
        "处理目录创建失败的情况"
      ],
      "usage_examples": [
        "save_review_version('research123', '这是文献综述内容', 1)",
        "save_review_version('research123', '这是初始文献综述', 'initial')"
      ]
    },
    {
      "tool_name": "get_processing_status",
      "description": "获取当前文献处理进度状态",
      "function_signature": "get_processing_status(research_id: str, session_id: str) -> str",
      "parameters": [
        {
          "name": "research_id",
          "type": "str",
          "description": "研究ID，对应.cache/pmc_literature下的目录名",
          "required": true
        },
        {
          "name": "session_id",
          "type": "str",
          "description": "会话ID，用于标识特定处理会话",
          "required": true
        }
      ],
      "return_type": "str",
      "return_description": "JSON格式的处理状态信息",
      "dependencies": ["json", "os", "datetime", "pathlib.Path"],
      "implementation_notes": [
        "如果状态文件不存在，自动创建初始状态",
        "尝试从manifest.json获取文献总数",
        "计算并返回处理进度百分比",
        "返回结构化的状态信息"
      ],
      "error_handling": [
        "处理状态文件不存在的情况",
        "处理JSON解析错误"
      ],
      "usage_examples": [
        "get_processing_status('research123', 'session456')"
      ]
    },
    {
      "tool_name": "update_processing_status",
      "description": "更新文献处理进度状态",
      "function_signature": "update_processing_status(research_id: str, session_id: str, processed_literature_id: str, current_version: Union[str, int]) -> str",
      "parameters": [
        {
          "name": "research_id",
          "type": "str",
          "description": "研究ID，对应.cache/pmc_literature下的目录名",
          "required": true
        },
        {
          "name": "session_id",
          "type": "str",
          "description": "会话ID，用于标识特定处理会话",
          "required": true
        },
        {
          "name": "processed_literature_id",
          "type": "str",
          "description": "已处理的文献ID",
          "required": true
        },
        {
          "name": "current_version",
          "type": "Union[str, int]",
          "description": "当前综述版本",
          "required": true
        }
      ],
      "return_type": "str",
      "return_description": "JSON格式的更新后的处理状态",
      "dependencies": ["json", "os", "datetime", "threading", "shutil", "pathlib.Path"],
      "implementation_notes": [
        "使用文件锁机制处理并发更新",
        "在更新前创建状态文件备份",
        "自动检测处理完成状态",
        "计算并返回最新的处理进度"
      ],
      "error_handling": [
        "处理并发更新冲突",
        "处理文件损坏的情况",
        "处理文件写入错误"
      ],
      "usage_examples": [
        "update_processing_status('research123', 'session456', 'literature789', 2)"
      ]
    }
  ],
  "code_quality": {
    "code_standards": [
      "遵循PEP 8编码规范",
      "使用类型注解提高代码可读性",
      "详细的文档字符串",
      "一致的错误处理模式",
      "适当的函数命名和变量命名"
    ],
    "testing_strategy": [
      "针对不同参数组合的单元测试",
      "边界条件测试",
      "错误处理测试",
      "并发操作测试"
    ],
    "performance_considerations": [
      "使用文件锁避免并发冲突",
      "仅在必要时创建备份文件",
      "优化文件读写操作",
      "使用pathlib提高路径操作效率"
    ],
    "security_measures": [
      "验证输入参数",
      "安全的文件操作",
      "状态文件备份机制",
      "避免路径遍历漏洞"
    ]
  },
  "integration_details": {
    "aws_services": [],
    "external_libraries": ["strands"],
    "api_endpoints": [],
    "data_formats": ["JSON"]
  },
  "development_notes": "工具开发过程中特别关注了并发处理和错误恢复机制，确保在处理大量文献时系统的稳定性。文件锁机制解决了并发更新问题，备份策略确保了状态数据的安全。所有工具函数都返回结构化的JSON数据，便于上层应用解析和处理。工具设计遵循了模块化原则，每个工具专注于单一职责，并提供了详细的错误信息和状态反馈。"
}}