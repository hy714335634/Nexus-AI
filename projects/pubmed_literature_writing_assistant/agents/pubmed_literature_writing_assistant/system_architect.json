{
  "system_design": {
    "design_overview": {
      "project_name": "pubmed_literature_writing_assistant",
      "version": "1.0",
      "date": "2025-10-26",
      "design_scope": "设计一个科研文献编写Agent，能够根据用户提供的材料和思路生成文献综述",
      "design_principles": [
        "模块化设计，确保功能组件可独立维护",
        "缓存优先，避免重复处理大量文献",
        "进度管理，支持断点续传",
        "科研严谨性，确保生成内容准确可靠",
        "资源效率，优化大量文献处理时的性能"
      ],
      "key_decisions": [
        "采用单Agent架构，集中处理文献综述生成流程",
        "实现本地缓存机制，解决token限制问题",
        "使用版本控制管理文献综述迭代过程",
        "基于PubMed文献搜索专家模板进行定制开发",
        "设计专用工具处理文献元数据和进度管理"
      ],
      "workflow_type": "single_agent",
      "recommended_templates": ["pubmed_literature_agent", "pdf_extractor_agent"]
    },
    "architecture": {
      "system_context": "该系统作为一个专业的科研文献综述生成工具，接收用户提供的研究ID和需求，读取相关文献数据，生成高质量的文献综述。系统通过本地缓存机制处理大量文献，并支持多语言输出。",
      "agent_topology": "单Agent架构，由一个核心Agent负责整个文献综述生成流程，从文献元数据读取到最终综述输出。",
      "interaction_model": "用户通过提供research_id、requirement、language和session_id参数与Agent交互，Agent按照预定流程处理文献并生成综述。",
      "technology_stack": {
        "sdk": "Strands SDK",
        "runtime": "Local",
        "integrations": ["文件系统", "AWS Bedrock"]
      }
    },
    "agents": [
      {
        "name": "pubmed_literature_writing_assistant",
        "purpose": "根据用户提供的研究ID和需求，处理相关文献并生成高质量的文献综述",
        "responsibilities": [
          "读取和解析文献元数据",
          "生成初始版本文献综述",
          "逐篇处理文献内容并更新综述",
          "输出最终版本文献综述",
          "管理处理进度和缓存"
        ],
        "interfaces": {
          "inputs": [
            "research_id: 研究ID，对应.cache/pmc_literature下的目录名",
            "requirement: 用户额外研究需求",
            "language: 输出语言",
            "session_id: 会话ID，用于缓存会话数据"
          ],
          "outputs": [
            "初始文献综述（基于元数据）",
            "迭代更新的文献综述版本",
            "最终文献综述",
            "处理状态和进度信息"
          ]
        },
        "dependencies": ["文件系统访问权限", "AWS Bedrock API"],
        "implementation_notes": [
          "基于PubMed文献搜索专家模板进行定制开发",
          "需要扩展缓存管理功能以支持大量文献处理",
          "实现断点续传机制避免重复处理"
        ],
        "recommended_template": "pubmed_literature_agent"
      }
    ],
    "data_models": [
      {
        "name": "LiteratureMetadata",
        "schema": "从manifest.json中读取的文献元数据结构，包含标题、作者、摘要等信息",
        "validation_rules": ["必须包含唯一标识符", "必须包含标题信息"],
        "relationships": ["与LiteratureContent一对一关联"]
      },
      {
        "name": "LiteratureContent",
        "schema": "文献正文内容，包括全文和结构化章节",
        "validation_rules": ["必须与元数据关联"],
        "relationships": ["与LiteratureMetadata一对一关联"]
      },
      {
        "name": "ReviewVersion",
        "schema": "文献综述版本，包含版本号、创建时间、内容等信息",
        "validation_rules": ["版本号必须唯一", "必须包含创建时间"],
        "relationships": ["与ProcessingStatus一对一关联"]
      },
      {
        "name": "ProcessingStatus",
        "schema": "处理进度状态，包含已处理文献列表、当前版本、处理时间等信息",
        "validation_rules": ["session_id必须唯一"],
        "relationships": ["与ReviewVersion一对多关联"]
      }
    ],
    "interaction_flows": [
      {
        "name": "初始文献综述生成",
        "description": "根据文献元数据生成初始版本的文献综述",
        "steps": [
          {
            "step": "读取manifest.json",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用load_literature_metadata工具读取元数据",
            "data": "research_id"
          },
          {
            "step": "分析元数据",
            "agent": "pubmed_literature_writing_assistant",
            "action": "分析文献元数据，提取关键信息",
            "data": "文献元数据"
          },
          {
            "step": "生成初始综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "基于元数据生成初始文献综述",
            "data": "文献元数据、用户需求"
          },
          {
            "step": "保存初始综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用save_review_version工具保存初始综述",
            "data": "初始综述内容、版本信息"
          }
        ]
      },
      {
        "name": "文献内容迭代处理",
        "description": "逐篇处理文献内容并更新文献综述",
        "steps": [
          {
            "step": "读取初始综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "读取初始版本文献综述",
            "data": "初始综述文件路径"
          },
          {
            "step": "获取处理状态",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用get_processing_status工具获取当前处理状态",
            "data": "research_id, session_id"
          },
          {
            "step": "遍历文献列表",
            "agent": "pubmed_literature_writing_assistant",
            "action": "获取未处理的文献列表",
            "data": "文献元数据、处理状态"
          },
          {
            "step": "读取文献内容",
            "agent": "pubmed_literature_writing_assistant",
            "action": "读取单篇文献内容",
            "data": "文献ID、文件路径"
          },
          {
            "step": "更新文献综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "根据文献内容更新综述",
            "data": "当前综述版本、文献内容"
          },
          {
            "step": "保存更新版本",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用save_review_version工具保存更新版本",
            "data": "更新后的综述内容、版本信息"
          },
          {
            "step": "更新处理状态",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用update_processing_status工具更新处理状态",
            "data": "文献ID、处理状态"
          }
        ]
      },
      {
        "name": "最终文献综述输出",
        "description": "所有文献处理完成后，生成最终版本文献综述",
        "steps": [
          {
            "step": "检查处理状态",
            "agent": "pubmed_literature_writing_assistant",
            "action": "检查是否所有文献都已处理",
            "data": "处理状态"
          },
          {
            "step": "生成最终综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "生成最终版本文献综述",
            "data": "最新综述版本、用户需求"
          },
          {
            "step": "语言转换",
            "agent": "pubmed_literature_writing_assistant",
            "action": "根据用户指定语言转换综述内容",
            "data": "最终综述内容、language参数"
          },
          {
            "step": "保存最终综述",
            "agent": "pubmed_literature_writing_assistant",
            "action": "调用save_review_version工具保存最终综述",
            "data": "最终综述内容、'final'标记"
          }
        ]
      }
    ],
    "security_considerations": [
      "确保用户数据的安全存储，防止未授权访问",
      "缓存文件应仅对授权用户可访问",
      "避免在文献综述中包含敏感信息"
    ],
    "error_handling": [
      "文献元数据读取失败时提供明确错误信息",
      "文献内容处理失败时记录错误并继续处理其他文献",
      "处理中断时能够从断点恢复",
      "缓存写入失败时实现备份机制"
    ],
    "performance_considerations": [
      "优化文献内容读取方式，避免一次性加载大量内容",
      "实现批处理机制，分批处理文献",
      "缓存中间结果，避免重复计算",
      "监控内存使用，避免处理大量文献时内存溢出"
    ],
    "monitoring_strategy": [
      "记录处理进度和时间统计",
      "提供处理状态查询接口",
      "记录错误和异常情况",
      "监控资源使用情况"
    ]
  },
  "design_rationale": "本设计采用单Agent架构，主要基于需求的功能集中性和处理流程的线性特点。虽然文献处理涉及多个步骤，但这些步骤紧密相关且顺序执行，不需要多Agent协作。选择PubMed文献搜索专家作为基础模板，是因为它已经具备了文献处理和综述生成的核心功能，可以减少开发工作量。设计中特别强调了缓存机制和进度管理，这是处理大量文献时的关键需求。通过版本控制管理文献综述的迭代过程，确保处理透明可追踪。数据模型设计考虑了文献元数据、内容、综述版本和处理状态之间的关系，支持复杂的状态管理。错误处理策略确保系统在处理大量文献时的稳定性，能够从中断中恢复。整体设计注重科研严谨性和资源效率，适合处理大规模文献综述任务。"
}