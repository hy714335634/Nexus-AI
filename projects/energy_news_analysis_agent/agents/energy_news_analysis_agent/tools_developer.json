{
  "tool_development": {
    "development_overview": {
      "project_name": "energy_news_analysis_agent",
      "version": "1.0",
      "date": "2026-01-04",
      "development_scope": "为能源新闻分析智能体开发完整的工具集，包括网页爬取、搜索引擎查询、报告生成和S3存储功能",
      "design_principles": [
        "基于Playwright实现动态网页爬取，支持JavaScript渲染",
        "集成Bing Search API提供专业搜索能力",
        "使用Jinja2模板引擎生成多格式报告",
        "通过boto3实现AWS S3存储集成",
        "所有工具返回JSON格式的结构化数据",
        "实现完整的错误处理和降级策略",
        "支持批量操作和并发处理"
      ],
      "key_decisions": [
        "选择Playwright作为网页爬取引擎，支持动态内容和反爬虫措施",
        "使用Bing Search API替代DuckDuckGo，提供更稳定的企业级搜索服务",
        "实现requests作为Playwright的降级方案，降低资源消耗",
        "使用Jinja2模板引擎支持自定义报告样式",
        "支持HTML、Markdown、JSON三种报告格式",
        "实现S3公开访问和预签名URL两种分享方式",
        "针对能源行业网站优化爬取策略"
      ]
    },
    "tools": [
      {
        "tool_name": "scrape_webpage",
        "description": "抓取单个网页内容，支持动态JavaScript渲染和懒加载内容",
        "function_signature": "scrape_webpage(url: str, wait_for_selector: Optional[str] = None, scroll_to_bottom: bool = False, timeout: int = 30000, use_playwright: bool = True) -> str",
        "parameters": [
          {
            "name": "url",
            "type": "str",
            "description": "目标网页URL",
            "required": true
          },
          {
            "name": "wait_for_selector",
            "type": "Optional[str]",
            "description": "等待特定CSS选择器出现",
            "required": false
          },
          {
            "name": "scroll_to_bottom",
            "type": "bool",
            "description": "是否滚动到页面底部加载懒加载内容",
            "required": false
          },
          {
            "name": "timeout",
            "type": "int",
            "description": "超时时间（毫秒）",
            "required": false
          },
          {
            "name": "use_playwright",
            "type": "bool",
            "description": "是否使用Playwright（支持动态网页）",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的抓取结果，包含标题、内容、链接、发布日期等信息",
        "dependencies": ["playwright", "beautifulsoup4", "lxml", "requests"],
        "implementation_notes": [
          "使用Playwright的headless模式降低资源消耗",
          "实现requests作为降级方案，当Playwright不可用时使用",
          "自动提取主要内容区域（article、main等标签）",
          "过滤脚本、样式、导航等非内容元素",
          "提取页面中的所有链接（限制50个）",
          "尝试多种策略提取文章发布日期"
        ],
        "error_handling": [
          "捕获Playwright超时异常，返回错误信息",
          "处理网络请求失败，提供友好的错误提示",
          "检查依赖库是否安装，提供安装指引"
        ],
        "usage_examples": [
          "scrape_webpage('https://www.nea.gov.cn/', use_playwright=False)",
          "scrape_webpage('https://energy.bjx.com.cn/', wait_for_selector='.news-list', scroll_to_bottom=True)"
        ]
      },
      {
        "tool_name": "batch_scrape_webpages",
        "description": "批量抓取多个网页内容，支持并发控制",
        "function_signature": "batch_scrape_webpages(urls: List[str], wait_for_selector: Optional[str] = None, max_concurrent: int = 3, timeout: int = 30000, use_playwright: bool = True) -> str",
        "parameters": [
          {
            "name": "urls",
            "type": "List[str]",
            "description": "网页URL列表",
            "required": true
          },
          {
            "name": "wait_for_selector",
            "type": "Optional[str]",
            "description": "等待特定CSS选择器出现",
            "required": false
          },
          {
            "name": "max_concurrent",
            "type": "int",
            "description": "最大并发数（默认3）",
            "required": false
          },
          {
            "name": "timeout",
            "type": "int",
            "description": "超时时间（毫秒）",
            "required": false
          },
          {
            "name": "use_playwright",
            "type": "bool",
            "description": "是否使用Playwright",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的批量抓取结果，包含成功/失败统计和详细结果",
        "dependencies": ["playwright", "beautifulsoup4", "lxml", "requests"],
        "implementation_notes": [
          "分批处理URL列表，避免并发过多",
          "每次请求间隔2秒，避免触发速率限制",
          "统计成功和失败的抓取数量"
        ],
        "error_handling": [
          "单个URL失败不影响整体执行",
          "记录每个URL的抓取状态和错误信息"
        ],
        "usage_examples": [
          "batch_scrape_webpages(['url1', 'url2', 'url3'], max_concurrent=3)"
        ]
      },
      {
        "tool_name": "extract_article_list",
        "description": "从列表页提取文章列表，支持自定义CSS选择器",
        "function_signature": "extract_article_list(url: str, article_selector: str = 'article, .news-item, .article-item', title_selector: str = 'h1, h2, h3, .title', link_selector: str = 'a', date_selector: Optional[str] = None, max_articles: int = 20, use_playwright: bool = True) -> str",
        "parameters": [
          {
            "name": "url",
            "type": "str",
            "description": "列表页URL",
            "required": true
          },
          {
            "name": "article_selector",
            "type": "str",
            "description": "文章容器的CSS选择器",
            "required": false
          },
          {
            "name": "title_selector",
            "type": "str",
            "description": "标题的CSS选择器",
            "required": false
          },
          {
            "name": "link_selector",
            "type": "str",
            "description": "链接的CSS选择器",
            "required": false
          },
          {
            "name": "date_selector",
            "type": "Optional[str]",
            "description": "日期的CSS选择器",
            "required": false
          },
          {
            "name": "max_articles",
            "type": "int",
            "description": "最大提取文章数",
            "required": false
          },
          {
            "name": "use_playwright",
            "type": "bool",
            "description": "是否使用Playwright",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的文章列表，包含标题、URL、发布日期等信息",
        "dependencies": ["playwright", "beautifulsoup4", "lxml"],
        "implementation_notes": [
          "先抓取列表页内容，然后解析HTML",
          "使用BeautifulSoup的CSS选择器提取文章信息",
          "自动转换相对链接为绝对链接",
          "过滤无效文章（无标题或链接）"
        ],
        "error_handling": [
          "单个文章提取失败不影响整体执行",
          "记录提取失败的文章索引"
        ],
        "usage_examples": [
          "extract_article_list('https://energy.bjx.com.cn/nyxny/', max_articles=20)"
        ]
      },
      {
        "tool_name": "scrape_energy_news_sites",
        "description": "从能源行业新闻网站抓取内容，针对不同数据源使用优化策略",
        "function_signature": "scrape_energy_news_sites(keywords: str, data_sources: Optional[List[str]] = None, max_articles_per_source: int = 10) -> str",
        "parameters": [
          {
            "name": "keywords",
            "type": "str",
            "description": "搜索关键词",
            "required": true
          },
          {
            "name": "data_sources",
            "type": "Optional[List[str]]",
            "description": "数据源列表",
            "required": false
          },
          {
            "name": "max_articles_per_source",
            "type": "int",
            "description": "每个数据源最大文章数",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的抓取结果，包含所有数据源的文章列表",
        "dependencies": ["playwright", "beautifulsoup4", "lxml", "requests"],
        "implementation_notes": [
          "默认数据源包括北极星能源网、国家能源局、国家发改委",
          "针对不同网站使用不同的抓取策略",
          "北极星能源网使用Playwright（动态内容）",
          "政府网站使用requests（静态内容）",
          "每个数据源间隔3秒，避免速率限制"
        ],
        "error_handling": [
          "单个数据源失败不影响其他数据源",
          "记录每个数据源的抓取状态"
        ],
        "usage_examples": [
          "scrape_energy_news_sites('新能源汽车', max_articles_per_source=10)"
        ]
      },
      {
        "tool_name": "scrape_with_retry",
        "description": "带重试机制的网页抓取，支持指数退避",
        "function_signature": "scrape_with_retry(url: str, max_retries: int = 3, retry_delay: int = 5, timeout: int = 30000) -> str",
        "parameters": [
          {
            "name": "url",
            "type": "str",
            "description": "目标网页URL",
            "required": true
          },
          {
            "name": "max_retries",
            "type": "int",
            "description": "最大重试次数",
            "required": false
          },
          {
            "name": "retry_delay",
            "type": "int",
            "description": "重试延迟（秒）",
            "required": false
          },
          {
            "name": "timeout",
            "type": "int",
            "description": "超时时间（毫秒）",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的抓取结果，包含重试次数",
        "dependencies": ["playwright", "beautifulsoup4", "lxml"],
        "implementation_notes": [
          "实现指数退避策略，每次重试延迟递增",
          "记录实际重试次数"
        ],
        "error_handling": [
          "达到最大重试次数后返回失败",
          "记录重试过程中的错误信息"
        ],
        "usage_examples": [
          "scrape_with_retry('https://example.com/', max_retries=3, retry_delay=5)"
        ]
      },
      {
        "tool_name": "bing_web_search",
        "description": "使用Bing Search API进行网页搜索",
        "function_signature": "bing_web_search(query: str, count: int = 10, market: str = 'zh-CN', freshness: Optional[str] = None) -> str",
        "parameters": [
          {
            "name": "query",
            "type": "str",
            "description": "搜索查询词",
            "required": true
          },
          {
            "name": "count",
            "type": "int",
            "description": "返回结果数量（1-50）",
            "required": false
          },
          {
            "name": "market",
            "type": "str",
            "description": "市场地区代码（zh-CN, en-US等）",
            "required": false
          },
          {
            "name": "freshness",
            "type": "Optional[str]",
            "description": "结果时效性（Day, Week, Month）",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索结果，包含标题、URL、摘要、发布日期等",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "从环境变量读取Bing API密钥",
          "支持时效性过滤",
          "限制最大结果数量为50"
        ],
        "error_handling": [
          "检查API密钥是否配置",
          "处理API请求失败",
          "处理响应解析错误"
        ],
        "usage_examples": [
          "bing_web_search('新能源汽车', count=10, freshness='Week')"
        ]
      },
      {
        "tool_name": "bing_news_search",
        "description": "使用Bing News Search API进行新闻搜索",
        "function_signature": "bing_news_search(query: str, count: int = 10, market: str = 'zh-CN', freshness: Optional[str] = None, sort_by: str = 'Date') -> str",
        "parameters": [
          {
            "name": "query",
            "type": "str",
            "description": "搜索查询词",
            "required": true
          },
          {
            "name": "count",
            "type": "int",
            "description": "返回结果数量（1-100）",
            "required": false
          },
          {
            "name": "market",
            "type": "str",
            "description": "市场地区代码",
            "required": false
          },
          {
            "name": "freshness",
            "type": "Optional[str]",
            "description": "结果时效性（Day, Week, Month）",
            "required": false
          },
          {
            "name": "sort_by",
            "type": "str",
            "description": "排序方式（Date, Relevance）",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的新闻搜索结果，包含标题、URL、描述、发布日期、来源等",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "使用Bing News Search API端点",
          "支持按日期或相关性排序",
          "提取新闻来源和分类信息"
        ],
        "error_handling": [
          "检查API密钥是否配置",
          "处理API请求失败",
          "处理响应解析错误"
        ],
        "usage_examples": [
          "bing_news_search('储能技术', count=10, sort_by='Date')"
        ]
      },
      {
        "tool_name": "multi_keyword_search",
        "description": "多关键词批量搜索",
        "function_signature": "multi_keyword_search(keywords: List[str], search_type: str = 'web', count_per_keyword: int = 5, market: str = 'zh-CN') -> str",
        "parameters": [
          {
            "name": "keywords",
            "type": "List[str]",
            "description": "关键词列表",
            "required": true
          },
          {
            "name": "search_type",
            "type": "str",
            "description": "搜索类型（web, news）",
            "required": false
          },
          {
            "name": "count_per_keyword",
            "type": "int",
            "description": "每个关键词的结果数量",
            "required": false
          },
          {
            "name": "market",
            "type": "str",
            "description": "市场地区代码",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的批量搜索结果",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "循环调用单个关键词搜索",
          "合并所有关键词的搜索结果"
        ],
        "error_handling": [
          "单个关键词搜索失败不影响其他关键词",
          "记录每个关键词的搜索状态"
        ],
        "usage_examples": [
          "multi_keyword_search(['新能源', '储能', '氢能'], search_type='news')"
        ]
      },
      {
        "tool_name": "search_energy_news",
        "description": "搜索能源行业新闻，自动组合多个关键词",
        "function_signature": "search_energy_news(topic: str, time_range: str = 'Week', max_results: int = 20, include_sources: Optional[List[str]] = None) -> str",
        "parameters": [
          {
            "name": "topic",
            "type": "str",
            "description": "搜索主题",
            "required": true
          },
          {
            "name": "time_range",
            "type": "str",
            "description": "时间范围（Day, Week, Month）",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "最大结果数量",
            "required": false
          },
          {
            "name": "include_sources",
            "type": "Optional[List[str]]",
            "description": "指定新闻来源",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的能源新闻搜索结果，去重并按日期排序",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "自动组合能源领域相关关键词",
          "支持指定新闻来源过滤",
          "去重并按日期排序"
        ],
        "error_handling": [
          "处理搜索失败",
          "处理结果合并错误"
        ],
        "usage_examples": [
          "search_energy_news('新能源汽车', time_range='Week', max_results=20)"
        ]
      },
      {
        "tool_name": "search_with_filters",
        "description": "带高级过滤器的搜索",
        "function_signature": "search_with_filters(query: str, search_type: str = 'web', time_filter: Optional[str] = None, site_filter: Optional[str] = None, file_type: Optional[str] = None, language: str = 'zh-CN', count: int = 10) -> str",
        "parameters": [
          {
            "name": "query",
            "type": "str",
            "description": "搜索查询词",
            "required": true
          },
          {
            "name": "search_type",
            "type": "str",
            "description": "搜索类型（web, news）",
            "required": false
          },
          {
            "name": "time_filter",
            "type": "Optional[str]",
            "description": "时间过滤器（Day, Week, Month）",
            "required": false
          },
          {
            "name": "site_filter",
            "type": "Optional[str]",
            "description": "网站过滤器（如gov.cn）",
            "required": false
          },
          {
            "name": "file_type",
            "type": "Optional[str]",
            "description": "文件类型过滤器（如pdf）",
            "required": false
          },
          {
            "name": "language",
            "type": "str",
            "description": "语言代码",
            "required": false
          },
          {
            "name": "count",
            "type": "int",
            "description": "结果数量",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索结果，包含过滤器信息",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "支持site:、filetype:等高级搜索语法",
          "自动组合过滤器到查询词"
        ],
        "error_handling": [
          "处理搜索失败",
          "处理过滤器组合错误"
        ],
        "usage_examples": [
          "search_with_filters('能源政策', site_filter='gov.cn', time_filter='Month')"
        ]
      },
      {
        "tool_name": "search_government_sources",
        "description": "搜索政府官方来源",
        "function_signature": "search_government_sources(topic: str, government_domains: Optional[List[str]] = None, time_range: str = 'Month', max_results: int = 10) -> str",
        "parameters": [
          {
            "name": "topic",
            "type": "str",
            "description": "搜索主题",
            "required": true
          },
          {
            "name": "government_domains",
            "type": "Optional[List[str]]",
            "description": "政府域名列表",
            "required": false
          },
          {
            "name": "time_range",
            "type": "str",
            "description": "时间范围",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "最大结果数量",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的政府来源搜索结果",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "默认包含国家能源局、发改委等政府网站",
          "针对每个政府域名单独搜索",
          "按日期排序结果"
        ],
        "error_handling": [
          "单个域名搜索失败不影响其他域名",
          "记录每个域名的搜索状态"
        ],
        "usage_examples": [
          "search_government_sources('新能源政策', time_range='Month')"
        ]
      },
      {
        "tool_name": "search_academic_papers",
        "description": "搜索学术论文和研究报告",
        "function_signature": "search_academic_papers(topic: str, academic_sites: Optional[List[str]] = None, max_results: int = 10) -> str",
        "parameters": [
          {
            "name": "topic",
            "type": "str",
            "description": "搜索主题",
            "required": true
          },
          {
            "name": "academic_sites",
            "type": "Optional[List[str]]",
            "description": "学术网站列表",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "最大结果数量",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的学术搜索结果",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "默认包含Google Scholar、arXiv、ResearchGate等学术网站",
          "自动添加学术关键词（论文、research等）",
          "针对每个学术网站单独搜索"
        ],
        "error_handling": [
          "单个网站搜索失败不影响其他网站",
          "记录每个网站的搜索状态"
        ],
        "usage_examples": [
          "search_academic_papers('储能技术', max_results=10)"
        ]
      },
      {
        "tool_name": "comprehensive_energy_search",
        "description": "综合能源信息搜索（新闻+政府+学术）",
        "function_signature": "comprehensive_energy_search(topic: str, include_news: bool = True, include_government: bool = True, include_academic: bool = True, time_range: str = 'Month', max_results_per_type: int = 10) -> str",
        "parameters": [
          {
            "name": "topic",
            "type": "str",
            "description": "搜索主题",
            "required": true
          },
          {
            "name": "include_news",
            "type": "bool",
            "description": "是否包含新闻",
            "required": false
          },
          {
            "name": "include_government",
            "type": "bool",
            "description": "是否包含政府来源",
            "required": false
          },
          {
            "name": "include_academic",
            "type": "bool",
            "description": "是否包含学术来源",
            "required": false
          },
          {
            "name": "time_range",
            "type": "str",
            "description": "时间范围",
            "required": false
          },
          {
            "name": "max_results_per_type",
            "type": "int",
            "description": "每种类型的最大结果数",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的综合搜索结果，包含所有类型的统计信息",
        "dependencies": ["requests", "boto3"],
        "implementation_notes": [
          "组合新闻、政府、学术三种搜索",
          "提供统计摘要信息",
          "支持选择性包含不同类型"
        ],
        "error_handling": [
          "单个类型搜索失败不影响其他类型",
          "记录每个类型的搜索状态"
        ],
        "usage_examples": [
          "comprehensive_energy_search('氢能', time_range='Month', max_results_per_type=10)"
        ]
      },
      {
        "tool_name": "generate_html_report",
        "description": "生成HTML格式的分析报告",
        "function_signature": "generate_html_report(title: str, sections: List[Dict[str, Any]], summary: Optional[Dict[str, Any]] = None, output_path: Optional[str] = None, template_path: Optional[str] = None, author: Optional[str] = None) -> str",
        "parameters": [
          {
            "name": "title",
            "type": "str",
            "description": "报告标题",
            "required": true
          },
          {
            "name": "sections",
            "type": "List[Dict[str, Any]]",
            "description": "报告章节列表",
            "required": true
          },
          {
            "name": "summary",
            "type": "Optional[Dict[str, Any]]",
            "description": "摘要统计数据",
            "required": false
          },
          {
            "name": "output_path",
            "type": "Optional[str]",
            "description": "输出文件路径",
            "required": false
          },
          {
            "name": "template_path",
            "type": "Optional[str]",
            "description": "自定义模板路径",
            "required": false
          },
          {
            "name": "author",
            "type": "Optional[str]",
            "description": "报告作者",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的生成结果，包含输出路径或HTML内容",
        "dependencies": ["jinja2"],
        "implementation_notes": [
          "使用Jinja2模板引擎渲染HTML",
          "提供默认的响应式HTML模板",
          "支持自定义模板",
          "自动添加样式和交互效果"
        ],
        "error_handling": [
          "检查Jinja2是否安装",
          "处理模板渲染错误",
          "处理文件写入错误"
        ],
        "usage_examples": [
          "generate_html_report('能源新闻分析报告', sections, summary, output_path='./report.html')"
        ]
      },
      {
        "tool_name": "generate_markdown_report",
        "description": "生成Markdown格式的分析报告",
        "function_signature": "generate_markdown_report(title: str, sections: List[Dict[str, Any]], summary: Optional[Dict[str, Any]] = None, output_path: Optional[str] = None) -> str",
        "parameters": [
          {
            "name": "title",
            "type": "str",
            "description": "报告标题",
            "required": true
          },
          {
            "name": "sections",
            "type": "List[Dict[str, Any]]",
            "description": "报告章节列表",
            "required": true
          },
          {
            "name": "summary",
            "type": "Optional[Dict[str, Any]]",
            "description": "摘要统计数据",
            "required": false
          },
          {
            "name": "output_path",
            "type": "Optional[str]",
            "description": "输出文件路径",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的生成结果",
        "dependencies": [],
        "implementation_notes": [
          "使用纯Python生成Markdown格式",
          "支持章节、列表、链接等Markdown语法",
          "自动添加元数据和页脚"
        ],
        "error_handling": [
          "处理文件写入错误",
          "处理数据格式错误"
        ],
        "usage_examples": [
          "generate_markdown_report('能源新闻分析报告', sections, summary, output_path='./report.md')"
        ]
      },
      {
        "tool_name": "generate_json_report",
        "description": "生成JSON格式的分析报告",
        "function_signature": "generate_json_report(title: str, sections: List[Dict[str, Any]], summary: Optional[Dict[str, Any]] = None, output_path: Optional[str] = None, pretty_print: bool = True) -> str",
        "parameters": [
          {
            "name": "title",
            "type": "str",
            "description": "报告标题",
            "required": true
          },
          {
            "name": "sections",
            "type": "List[Dict[str, Any]]",
            "description": "报告章节列表",
            "required": true
          },
          {
            "name": "summary",
            "type": "Optional[Dict[str, Any]]",
            "description": "摘要统计数据",
            "required": false
          },
          {
            "name": "output_path",
            "type": "Optional[str]",
            "description": "输出文件路径",
            "required": false
          },
          {
            "name": "pretty_print",
            "type": "bool",
            "description": "是否格式化输出",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的生成结果",
        "dependencies": [],
        "implementation_notes": [
          "使用Python标准库json模块",
          "支持格式化输出",
          "添加元数据信息"
        ],
        "error_handling": [
          "处理JSON序列化错误",
          "处理文件写入错误"
        ],
        "usage_examples": [
          "generate_json_report('能源新闻分析报告', sections, summary, output_path='./report.json')"
        ]
      },
      {
        "tool_name": "generate_multi_format_reports",
        "description": "生成多种格式的分析报告",
        "function_signature": "generate_multi_format_reports(title: str, sections: List[Dict[str, Any]], summary: Optional[Dict[str, Any]] = None, output_directory: str = './reports', formats: Optional[List[str]] = None, base_filename: Optional[str] = None) -> str",
        "parameters": [
          {
            "name": "title",
            "type": "str",
            "description": "报告标题",
            "required": true
          },
          {
            "name": "sections",
            "type": "List[Dict[str, Any]]",
            "description": "报告章节列表",
            "required": true
          },
          {
            "name": "summary",
            "type": "Optional[Dict[str, Any]]",
            "description": "摘要统计数据",
            "required": false
          },
          {
            "name": "output_directory",
            "type": "str",
            "description": "输出目录",
            "required": false
          },
          {
            "name": "formats",
            "type": "Optional[List[str]]",
            "description": "输出格式列表（html, markdown, json）",
            "required": false
          },
          {
            "name": "base_filename",
            "type": "Optional[str]",
            "description": "基础文件名",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的生成结果，包含所有生成的文件信息",
        "dependencies": ["jinja2"],
        "implementation_notes": [
          "默认生成HTML、Markdown、JSON三种格式",
          "使用时间戳作为默认文件名",
          "自动创建输出目录"
        ],
        "error_handling": [
          "单个格式生成失败不影响其他格式",
          "记录每个格式的生成状态"
        ],
        "usage_examples": [
          "generate_multi_format_reports('能源新闻分析报告', sections, summary, formats=['html', 'json'])"
        ]
      },
      {
        "tool_name": "create_report_template",
        "description": "创建自定义报告模板",
        "function_signature": "create_report_template(template_name: str, template_content: str, template_directory: str = './templates') -> str",
        "parameters": [
          {
            "name": "template_name",
            "type": "str",
            "description": "模板名称",
            "required": true
          },
          {
            "name": "template_content",
            "type": "str",
            "description": "模板内容（Jinja2格式）",
            "required": true
          },
          {
            "name": "template_directory",
            "type": "str",
            "description": "模板目录",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的创建结果",
        "dependencies": [],
        "implementation_notes": [
          "自动创建模板目录",
          "保存为HTML文件"
        ],
        "error_handling": [
          "处理文件写入错误",
          "处理目录创建错误"
        ],
        "usage_examples": [
          "create_report_template('custom_template', template_content)"
        ]
      },
      {
        "tool_name": "upload_file_to_s3",
        "description": "上传文件到S3存储桶",
        "function_signature": "upload_file_to_s3(file_path: str, bucket_name: str, s3_key: Optional[str] = None, public_read: bool = True, content_type: Optional[str] = None, metadata: Optional[Dict[str, str]] = None) -> str",
        "parameters": [
          {
            "name": "file_path",
            "type": "str",
            "description": "本地文件路径",
            "required": true
          },
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "s3_key",
            "type": "Optional[str]",
            "description": "S3对象键",
            "required": false
          },
          {
            "name": "public_read",
            "type": "bool",
            "description": "是否设置为公开可读",
            "required": false
          },
          {
            "name": "content_type",
            "type": "Optional[str]",
            "description": "文件MIME类型",
            "required": false
          },
          {
            "name": "metadata",
            "type": "Optional[Dict[str, str]]",
            "description": "自定义元数据",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的上传结果，包含公开URL",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "使用boto3客户端上传文件",
          "自动检测Content-Type",
          "支持公开访问和私有访问",
          "自动生成公开URL"
        ],
        "error_handling": [
          "检查文件是否存在",
          "检查AWS凭证是否配置",
          "处理S3操作错误"
        ],
        "usage_examples": [
          "upload_file_to_s3('./report.html', 'my-bucket', public_read=True)"
        ]
      },
      {
        "tool_name": "batch_upload_to_s3",
        "description": "批量上传文件到S3",
        "function_signature": "batch_upload_to_s3(file_paths: List[str], bucket_name: str, s3_prefix: Optional[str] = None, public_read: bool = True) -> str",
        "parameters": [
          {
            "name": "file_paths",
            "type": "List[str]",
            "description": "本地文件路径列表",
            "required": true
          },
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "s3_prefix",
            "type": "Optional[str]",
            "description": "S3键前缀（目录）",
            "required": false
          },
          {
            "name": "public_read",
            "type": "bool",
            "description": "是否设置为公开可读",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的批量上传结果",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "循环调用单文件上传",
          "统计成功和失败数量"
        ],
        "error_handling": [
          "单个文件上传失败不影响其他文件",
          "记录每个文件的上传状态"
        ],
        "usage_examples": [
          "batch_upload_to_s3(['file1.html', 'file2.json'], 'my-bucket', s3_prefix='reports')"
        ]
      },
      {
        "tool_name": "upload_directory_to_s3",
        "description": "上传目录到S3",
        "function_signature": "upload_directory_to_s3(directory_path: str, bucket_name: str, s3_prefix: Optional[str] = None, public_read: bool = True, recursive: bool = True, file_patterns: Optional[List[str]] = None) -> str",
        "parameters": [
          {
            "name": "directory_path",
            "type": "str",
            "description": "本地目录路径",
            "required": true
          },
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "s3_prefix",
            "type": "Optional[str]",
            "description": "S3键前缀",
            "required": false
          },
          {
            "name": "public_read",
            "type": "bool",
            "description": "是否设置为公开可读",
            "required": false
          },
          {
            "name": "recursive",
            "type": "bool",
            "description": "是否递归上传子目录",
            "required": false
          },
          {
            "name": "file_patterns",
            "type": "Optional[List[str]]",
            "description": "文件匹配模式",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的上传结果",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "支持递归上传子目录",
          "支持文件模式匹配",
          "保持目录结构"
        ],
        "error_handling": [
          "检查目录是否存在",
          "处理文件收集错误",
          "单个文件上传失败不影响其他文件"
        ],
        "usage_examples": [
          "upload_directory_to_s3('./reports', 'my-bucket', file_patterns=['*.html', '*.json'])"
        ]
      },
      {
        "tool_name": "list_s3_objects",
        "description": "列出S3存储桶中的对象",
        "function_signature": "list_s3_objects(bucket_name: str, prefix: Optional[str] = None, max_keys: int = 1000) -> str",
        "parameters": [
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "prefix",
            "type": "Optional[str]",
            "description": "对象键前缀",
            "required": false
          },
          {
            "name": "max_keys",
            "type": "int",
            "description": "最大返回数量",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的对象列表",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "使用list_objects_v2 API",
          "支持前缀过滤",
          "返回对象元数据"
        ],
        "error_handling": [
          "处理S3操作错误",
          "处理权限错误"
        ],
        "usage_examples": [
          "list_s3_objects('my-bucket', prefix='reports')"
        ]
      },
      {
        "tool_name": "delete_s3_object",
        "description": "删除S3对象",
        "function_signature": "delete_s3_object(bucket_name: str, s3_key: str) -> str",
        "parameters": [
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "s3_key",
            "type": "str",
            "description": "S3对象键",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的删除结果",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "使用delete_object API",
          "记录删除时间"
        ],
        "error_handling": [
          "处理S3操作错误",
          "处理权限错误"
        ],
        "usage_examples": [
          "delete_s3_object('my-bucket', 'reports/report.html')"
        ]
      },
      {
        "tool_name": "generate_presigned_url",
        "description": "生成S3对象的预签名URL",
        "function_signature": "generate_presigned_url(bucket_name: str, s3_key: str, expiration: int = 3600) -> str",
        "parameters": [
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "s3_key",
            "type": "str",
            "description": "S3对象键",
            "required": true
          },
          {
            "name": "expiration",
            "type": "int",
            "description": "URL有效期（秒）",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的预签名URL",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "使用generate_presigned_url API",
          "默认有效期1小时"
        ],
        "error_handling": [
          "处理S3操作错误",
          "处理权限错误"
        ],
        "usage_examples": [
          "generate_presigned_url('my-bucket', 'reports/report.html', expiration=7200)"
        ]
      },
      {
        "tool_name": "upload_report_to_s3",
        "description": "上传分析报告到S3（带自动分类和命名）",
        "function_signature": "upload_report_to_s3(report_path: str, bucket_name: str, report_category: str = 'energy_reports', public_read: bool = True) -> str",
        "parameters": [
          {
            "name": "report_path",
            "type": "str",
            "description": "报告文件路径",
            "required": true
          },
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "report_category",
            "type": "str",
            "description": "报告分类",
            "required": false
          },
          {
            "name": "public_read",
            "type": "bool",
            "description": "是否设置为公开可读",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的上传结果",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "自动生成日期分类目录",
          "添加上传时间等元数据",
          "生成规范的S3键"
        ],
        "error_handling": [
          "检查报告文件是否存在",
          "处理上传错误"
        ],
        "usage_examples": [
          "upload_report_to_s3('./report.html', 'my-bucket', report_category='energy_reports')"
        ]
      },
      {
        "tool_name": "batch_upload_reports_to_s3",
        "description": "批量上传报告目录到S3",
        "function_signature": "batch_upload_reports_to_s3(report_directory: str, bucket_name: str, report_category: str = 'energy_reports', file_patterns: Optional[List[str]] = None, public_read: bool = True) -> str",
        "parameters": [
          {
            "name": "report_directory",
            "type": "str",
            "description": "报告目录路径",
            "required": true
          },
          {
            "name": "bucket_name",
            "type": "str",
            "description": "S3存储桶名称",
            "required": true
          },
          {
            "name": "report_category",
            "type": "str",
            "description": "报告分类",
            "required": false
          },
          {
            "name": "file_patterns",
            "type": "Optional[List[str]]",
            "description": "文件匹配模式",
            "required": false
          },
          {
            "name": "public_read",
            "type": "bool",
            "description": "是否设置为公开可读",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的批量上传结果",
        "dependencies": ["boto3"],
        "implementation_notes": [
          "默认上传HTML、Markdown、JSON、PDF格式",
          "调用目录上传功能"
        ],
        "error_handling": [
          "处理目录上传错误"
        ],
        "usage_examples": [
          "batch_upload_reports_to_s3('./reports', 'my-bucket', file_patterns=['*.html', '*.json'])"
        ]
      }
    ],
    "code_quality": {
      "code_standards": [
        "遵循PEP 8代码规范",
        "使用完整的类型注解",
        "提供详细的文档字符串",
        "实现完整的错误处理",
        "返回结构化的JSON数据"
      ],
      "testing_strategy": [
        "每个工具函数包含测试代码",
        "测试基本功能和错误处理",
        "提供使用示例",
        "验证返回数据格式"
      ],
      "performance_considerations": [
        "实现批量操作减少API调用",
        "使用并发控制避免资源消耗过大",
        "实现速率限制避免触发API限制",
        "支持降级策略（Playwright -> requests）",
        "限制返回数据大小"
      ],
      "security_measures": [
        "从环境变量读取API密钥",
        "不在代码中硬编码敏感信息",
        "验证文件路径防止路径遍历",
        "检查AWS凭证配置",
        "支持私有和公开访问控制"
      ]
    },
    "integration_details": {
      "aws_services": [
        "Amazon S3 - 文件存储和分享",
        "Bing Search API - 网页和新闻搜索（需要Azure订阅）"
      ],
      "external_libraries": [
        "playwright - 动态网页爬取",
        "beautifulsoup4 - HTML解析",
        "lxml - XML/HTML解析器",
        "requests - HTTP请求",
        "jinja2 - 模板引擎",
        "boto3 - AWS SDK"
      ],
      "api_endpoints": [
        "https://api.bing.microsoft.com/v7.0/search - Bing Web Search",
        "https://api.bing.microsoft.com/v7.0/news/search - Bing News Search"
      ],
      "data_formats": [
        "JSON - 所有工具返回格式",
        "HTML - 网页内容和报告格式",
        "Markdown - 报告格式",
        "CSS - HTML报告样式"
      ]
    },
    "development_notes": "工具开发完成，实现了完整的网页爬取、搜索引擎查询、报告生成和S3存储功能。所有工具都经过验证，支持错误处理和降级策略。关键决策包括：1）选择Playwright支持动态网页，同时提供requests降级方案；2）集成Bing Search API提供企业级搜索能力；3）使用Jinja2模板引擎支持自定义报告样式；4）实现S3公开访问和预签名URL两种分享方式。所有工具都返回JSON格式的结构化数据，便于Agent进行后续处理。"
  }
}