{
  "tool_development": {
    "development_overview": {
      "project_name": "pubmed_literature_search_agent",
      "version": "1.0",
      "date": "2025-10-20",
      "development_scope": "开发用于PubMed Central文献检索、筛选和汇总的工具集",
      "design_principles": [
        "模块化设计，每个工具专注于单一功能",
        "完整的错误处理和日志记录",
        "本地缓存机制提高性能",
        "支持批量处理和并行操作",
        "提供结构化的JSON输出"
      ],
      "key_decisions": [
        "使用boto3 no-sign-request方式访问PMC S3数据",
        "实现多维度相关性评分算法",
        "支持多种引用格式和报告类型",
        "实现元数据缓存以减少S3访问",
        "提供XML和TXT格式的文章解析"
      ]
    },
    "tools": [
      {
        "tool_name": "pmc_s3_connector",
        "description": "连接AWS S3并访问PubMed Central开放数据",
        "function_signature": "pmc_s3_connect(directory: str = \"oa_comm\", list_files: bool = False, max_files: int = 10) -> str",
        "parameters": [
          {
            "name": "directory",
            "type": "str",
            "description": "PMC目录名称 (oa_comm, oa_noncomm, phe_timebound)",
            "required": false
          },
          {
            "name": "list_files",
            "type": "bool",
            "description": "是否列出文件",
            "required": false
          },
          {
            "name": "max_files",
            "type": "int",
            "description": "最大文件数量",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的连接结果和文件列表",
        "dependencies": ["boto3", "json", "logging"],
        "implementation_notes": [
          "使用boto3 no-sign-request方式访问S3",
          "实现本地缓存机制",
          "支持三种PMC目录"
        ],
        "error_handling": [
          "验证目录参数",
          "处理S3连接异常",
          "处理文件列表分页"
        ],
        "usage_examples": [
          "pmc_s3_connect(\"oa_comm\", True, 20)"
        ]
      },
      {
        "tool_name": "pmc_metadata_parser",
        "description": "解析PMC元数据和文章内容",
        "function_signature": "parse_pmc_content(content: str, format_type: str = None) -> str",
        "parameters": [
          {
            "name": "content",
            "type": "str",
            "description": "文章内容",
            "required": true
          },
          {
            "name": "format_type",
            "type": "str",
            "description": "内容格式类型 (xml, txt)",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的解析结果",
        "dependencies": ["xml.etree.ElementTree", "re", "json"],
        "implementation_notes": [
          "支持XML和TXT格式解析",
          "提取标题、作者、摘要等元数据",
          "处理XML格式问题"
        ],
        "error_handling": [
          "处理XML解析异常",
          "修复常见XML问题",
          "处理格式检测错误"
        ],
        "usage_examples": [
          "parse_pmc_content(xml_content, \"xml\")"
        ]
      },
      {
        "tool_name": "literature_searcher",
        "description": "基于关键词和主题进行文献检索",
        "function_signature": "search_literature(keywords: str, directories: List[str] = None, max_results: int = 20, format_type: str = \"xml\") -> str",
        "parameters": [
          {
            "name": "keywords",
            "type": "str",
            "description": "搜索关键词，支持布尔操作符 (AND, OR, NOT)",
            "required": true
          },
          {
            "name": "directories",
            "type": "List[str]",
            "description": "要搜索的PMC目录列表",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "最大结果数量",
            "required": false
          },
          {
            "name": "format_type",
            "type": "str",
            "description": "文件格式类型 (xml, txt)",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索结果",
        "dependencies": ["boto3", "concurrent.futures", "re"],
        "implementation_notes": [
          "支持布尔搜索操作符",
          "使用线程池并行搜索",
          "实现文件列表缓存",
          "提取匹配上下文"
        ],
        "error_handling": [
          "验证搜索参数",
          "处理并行搜索异常",
          "处理S3访问错误"
        ],
        "usage_examples": [
          "search_literature(\"cancer AND therapy NOT surgery\")"
        ]
      },
      {
        "tool_name": "literature_filter",
        "description": "按时间范围、期刊类型和影响因子进行筛选",
        "function_signature": "combined_filter(literature_results: str, filter_params: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "literature_results",
            "type": "str",
            "description": "JSON格式的文献搜索结果",
            "required": true
          },
          {
            "name": "filter_params",
            "type": "Dict[str, Any]",
            "description": "筛选参数",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的筛选结果",
        "dependencies": ["json", "re", "datetime"],
        "implementation_notes": [
          "支持多种筛选条件组合",
          "内置期刊影响因子数据",
          "检测撤稿状态",
          "实现年份提取"
        ],
        "error_handling": [
          "验证筛选参数",
          "处理日期解析错误",
          "处理JSON解析异常"
        ],
        "usage_examples": [
          "combined_filter(results, {\"start_year\": 2018, \"min_impact_factor\": 5.0})"
        ]
      },
      {
        "tool_name": "relevance_ranker",
        "description": "计算文献相关性并排序",
        "function_signature": "rank_literature_by_relevance(literature_results: str, search_terms: List[str] = None) -> str",
        "parameters": [
          {
            "name": "literature_results",
            "type": "str",
            "description": "JSON格式的文献结果",
            "required": true
          },
          {
            "name": "search_terms",
            "type": "List[str]",
            "description": "搜索词列表",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的排序结果",
        "dependencies": ["json", "re", "math"],
        "implementation_notes": [
          "多维度评分算法",
          "考虑词频、位置、时效性等因素",
          "支持自定义排序标准",
          "实现主题聚类"
        ],
        "error_handling": [
          "处理搜索词提取错误",
          "处理评分计算异常",
          "处理JSON解析异常"
        ],
        "usage_examples": [
          "rank_literature_by_relevance(results, [\"cancer\", \"therapy\"])"
        ]
      },
      {
        "tool_name": "citation_generator",
        "description": "生成多种格式的引用信息",
        "function_signature": "generate_all_citations(article_metadata: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "article_metadata",
            "type": "Dict[str, Any]",
            "description": "文章元数据",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的所有引用格式",
        "dependencies": ["json", "re"],
        "implementation_notes": [
          "支持APA、MLA、Chicago等格式",
          "实现作者格式化",
          "处理不同的元数据结构",
          "支持批量生成"
        ],
        "error_handling": [
          "处理不完整元数据",
          "处理作者解析错误",
          "处理日期格式化异常"
        ],
        "usage_examples": [
          "generate_all_citations(article)"
        ]
      },
      {
        "tool_name": "report_generator",
        "description": "生成结构化的文献综述报告",
        "function_signature": "generate_structured_report(articles: List[Dict[str, Any]], report_structure: Dict[str, Any] = None) -> str",
        "parameters": [
          {
            "name": "articles",
            "type": "List[Dict[str, Any]]",
            "description": "文章元数据列表",
            "required": true
          },
          {
            "name": "report_structure",
            "type": "Dict[str, Any]",
            "description": "报告结构",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "结构化报告（Markdown格式）",
        "dependencies": ["json", "re", "datetime", "uuid"],
        "implementation_notes": [
          "支持多种报告格式和结构",
          "提取文章关键点",
          "生成比较表格",
          "支持主题聚类摘要",
          "支持JSON导出"
        ],
        "error_handling": [
          "处理不完整元数据",
          "处理文章摘要提取错误",
          "处理报告结构验证"
        ],
        "usage_examples": [
          "generate_structured_report(articles, {\"title\": \"Cancer Research Review\"})"
        ]
      }
    ],
    "code_quality": {
      "code_standards": [
        "遵循PEP 8编码规范",
        "使用类型注解提高代码可读性",
        "详细的函数文档字符串",
        "模块化设计，职责分离"
      ],
      "testing_strategy": [
        "单元测试每个工具函数",
        "边界条件测试",
        "错误处理测试",
        "集成测试验证工具间协作"
      ],
      "performance_considerations": [
        "实现本地缓存减少S3访问",
        "使用并行处理提高搜索速度",
        "优化相关性算法计算效率",
        "懒加载文章内容"
      ],
      "security_measures": [
        "使用no-sign-request方式安全访问S3",
        "验证所有输入参数",
        "避免硬编码敏感信息",
        "限制缓存大小防止资源耗尽"
      ]
    },
    "integration_details": {
      "aws_services": [
        "Amazon S3 (用于访问PMC数据)"
      ],
      "external_libraries": [
        "boto3 (AWS SDK)",
        "xml.etree.ElementTree (XML解析)",
        "concurrent.futures (并行处理)"
      ],
      "api_endpoints": [
        "PMC S3 Bucket (arn:aws:s3:::pmc-oa-opendata)"
      ],
      "data_formats": [
        "XML (文章内容)",
        "TXT (文章内容)",
        "JSON (工具输出)",
        "Markdown (报告输出)"
      ]
    },
    "development_notes": "开发过程中的主要挑战是处理PMC数据的不一致性，特别是XML格式的变化和不同目录下的文件结构差异。通过实现健壮的解析逻辑和错误处理机制，成功解决了这些问题。另一个关键决策是实现本地缓存机制，显著提高了搜索和筛选性能，特别是对于重复查询。多维度相关性评分算法考虑了词频、位置、时效性、影响因子等多个因素，提供了更准确的文献排序结果。工具之间的接口设计确保了它们可以无缝协作，形成完整的文献检索、筛选、排序和报告生成流程。"
  }
}