{
  "tool_development": {
    "development_overview": {
      "project_name": "company_info_search_agent",
      "version": "1.0",
      "date": "2025-09-30",
      "development_scope": "开发一套完整的工具集，用于公司信息检索与分析系统，支持Excel文件处理、多搜索引擎集成、缓存机制和结果输出",
      "design_principles": [
        "模块化设计，确保各工具职责单一",
        "健壮的错误处理，提供明确的错误信息",
        "支持多搜索引擎集成和自动切换",
        "实现完整的缓存机制，支持断点续传",
        "提供灵活的数据输入输出格式"
      ],
      "key_decisions": [
        "使用pandas库处理Excel文件",
        "实现SerpAPI集成和备用HTTP请求方法",
        "使用文件系统实现缓存机制",
        "实现AWS Bedrock集成用于高级信息提取",
        "支持分批处理和CSV/Excel输出"
      ]
    },
    "tools": [
      {
        "tool_name": "company_search",
        "description": "提供多搜索引擎集成的公司信息搜索功能，支持深度检索和内容提取",
        "function_signature": "company_search(company_name: str, search_engines: List[str] = None, max_results: int = 5, deep_search: bool = True) -> str",
        "parameters": [
          {
            "name": "company_name",
            "type": "str",
            "description": "要搜索的公司名称",
            "required": true
          },
          {
            "name": "search_engines",
            "type": "List[str]",
            "description": "要使用的搜索引擎列表，默认为[\"google\", \"bing\", \"baidu\", \"duckduckgo\"]",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "每个搜索引擎返回的最大结果数，默认为5",
            "required": false
          },
          {
            "name": "deep_search",
            "type": "bool",
            "description": "是否进行深度搜索，获取更多公司相关信息，默认为True",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索结果，包含各搜索引擎的结果和元数据",
        "dependencies": ["json", "re", "time", "urllib.parse"],
        "implementation_notes": [
          "支持多种搜索引擎，包括Google、Bing、Baidu和DuckDuckGo",
          "构建针对公司信息的搜索查询",
          "支持中英文公司名称",
          "提供深度搜索指导"
        ],
        "error_handling": [
          "检查公司名称是否为空",
          "处理JSON序列化错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "company_search('Apple Inc.')",
          "company_search('阿里巴巴', search_engines=['baidu', 'google'], max_results=3)"
        ]
      },
      {
        "tool_name": "company_info_extractor",
        "description": "从网页内容中提取公司信息",
        "function_signature": "company_info_extractor(content: str, company_name: str) -> str",
        "parameters": [
          {
            "name": "content",
            "type": "str",
            "description": "网页内容",
            "required": true
          },
          {
            "name": "company_name",
            "type": "str",
            "description": "公司名称，用于上下文匹配",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的提取结果，包含公司信息和元数据",
        "dependencies": ["json", "re", "time"],
        "implementation_notes": [
          "使用正则表达式提取关键公司信息",
          "支持中英文内容提取",
          "提取多种类型的公司信息，包括营收、简介、成立年份等",
          "提供提取质量评估"
        ],
        "error_handling": [
          "检查内容是否为空",
          "处理正则表达式匹配失败",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "company_info_extractor(html_content, 'Microsoft')",
          "company_info_extractor(webpage_text, '腾讯')"
        ]
      },
      {
        "tool_name": "multi_engine_company_search",
        "description": "使用多搜索引擎策略进行公司信息查询",
        "function_signature": "multi_engine_company_search(company_name: str, search_type: str = \"comprehensive\", max_results: int = 3) -> str",
        "parameters": [
          {
            "name": "company_name",
            "type": "str",
            "description": "要搜索的公司名称",
            "required": true
          },
          {
            "name": "search_type",
            "type": "str",
            "description": "搜索类型，可选值为\"basic\"(基本信息)、\"financial\"(财务信息)、\"comprehensive\"(综合信息)",
            "required": false
          },
          {
            "name": "max_results",
            "type": "int",
            "description": "每个搜索引擎返回的最大结果数，默认为3",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的多引擎搜索结果",
        "dependencies": ["json", "re", "time", "urllib.parse"],
        "implementation_notes": [
          "根据搜索类型选择不同的查询和搜索引擎",
          "支持基本信息、财务信息和综合信息三种搜索类型",
          "提供搜索指南和下一步建议"
        ],
        "error_handling": [
          "检查公司名称是否为空",
          "处理JSON序列化错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "multi_engine_company_search('Tesla', search_type='financial')",
          "multi_engine_company_search('华为', search_type='comprehensive')"
        ]
      },
      {
        "tool_name": "cache_task_progress",
        "description": "缓存任务进度数据",
        "function_signature": "cache_task_progress(task_id: str, progress_data: str, overwrite: bool = False) -> str",
        "parameters": [
          {
            "name": "task_id",
            "type": "str",
            "description": "任务唯一标识符",
            "required": true
          },
          {
            "name": "progress_data",
            "type": "str",
            "description": "任务进度数据(JSON字符串)",
            "required": true
          },
          {
            "name": "overwrite",
            "type": "bool",
            "description": "是否覆盖现有缓存，默认为False",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的缓存结果",
        "dependencies": ["json", "time", "os", "pathlib"],
        "implementation_notes": [
          "使用文件系统实现缓存机制",
          "自动创建缓存目录",
          "添加元数据记录缓存时间和版本"
        ],
        "error_handling": [
          "检查现有缓存是否存在",
          "处理JSON解析错误",
          "捕获文件操作异常"
        ],
        "usage_examples": [
          "cache_task_progress('task123', '{\"total_companies\": 100, \"processed_companies\": 50}')",
          "cache_task_progress('task123', progress_data, overwrite=True)"
        ]
      },
      {
        "tool_name": "get_task_progress",
        "description": "获取任务进度数据",
        "function_signature": "get_task_progress(task_id: str) -> str",
        "parameters": [
          {
            "name": "task_id",
            "type": "str",
            "description": "任务唯一标识符",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的任务进度数据",
        "dependencies": ["json", "os", "pathlib"],
        "implementation_notes": [
          "从缓存文件中读取任务进度",
          "返回完整的进度数据和元数据"
        ],
        "error_handling": [
          "检查缓存文件是否存在",
          "处理JSON解析错误",
          "捕获文件操作异常"
        ],
        "usage_examples": [
          "get_task_progress('task123')"
        ]
      },
      {
        "tool_name": "excel_writer",
        "description": "将数据写入Excel文件",
        "function_signature": "excel_writer(data: str, output_path: str, sheet_name: Optional[str] = None) -> str",
        "parameters": [
          {
            "name": "data",
            "type": "str",
            "description": "要写入的数据(JSON字符串)，应为对象列表",
            "required": true
          },
          {
            "name": "output_path",
            "type": "str",
            "description": "输出Excel文件路径",
            "required": true
          },
          {
            "name": "sheet_name",
            "type": "Optional[str]",
            "description": "工作表名称，如果不提供则使用\"Sheet1\"",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的写入结果",
        "dependencies": ["json", "os", "pandas"],
        "implementation_notes": [
          "使用pandas库处理Excel文件",
          "自动创建输出目录",
          "支持自定义工作表名称"
        ],
        "error_handling": [
          "验证输入数据格式",
          "处理文件写入错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "excel_writer('[{\"company\": \"Apple\", \"revenue\": \"$365B\"}]', 'output.xlsx')",
          "excel_writer(json_data, 'output.xlsx', sheet_name='公司信息')"
        ]
      },
      {
        "tool_name": "create_company_report",
        "description": "创建格式化的公司信息报告Excel文件",
        "function_signature": "create_company_report(company_data: str, output_path: str, include_charts: bool = False) -> str",
        "parameters": [
          {
            "name": "company_data",
            "type": "str",
            "description": "公司信息数据(JSON字符串)，应为对象列表",
            "required": true
          },
          {
            "name": "output_path",
            "type": "str",
            "description": "输出Excel文件路径",
            "required": true
          },
          {
            "name": "include_charts",
            "type": "bool",
            "description": "是否包含图表，默认为False",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的报告创建结果",
        "dependencies": ["json", "os", "pandas"],
        "implementation_notes": [
          "创建多个工作表，包括主数据表和统计表",
          "处理嵌套数据结构",
          "可选添加图表数据"
        ],
        "error_handling": [
          "验证输入数据格式",
          "处理文件写入错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "create_company_report(companies_json, 'company_report.xlsx')",
          "create_company_report(companies_json, 'company_report.xlsx', include_charts=True)"
        ]
      },
      {
        "tool_name": "serpapi_search",
        "description": "使用SerpAPI搜索信息",
        "function_signature": "serpapi_search(query: str, engine: str = \"google\", api_key: Optional[str] = None, params: Optional[Dict[str, Any]] = None) -> str",
        "parameters": [
          {
            "name": "query",
            "type": "str",
            "description": "搜索查询",
            "required": true
          },
          {
            "name": "engine",
            "type": "str",
            "description": "搜索引擎，支持\"google\"、\"bing\"、\"baidu\"、\"duckduckgo\"",
            "required": false
          },
          {
            "name": "api_key",
            "type": "Optional[str]",
            "description": "SerpAPI API密钥，如果不提供则尝试从环境变量获取",
            "required": false
          },
          {
            "name": "params",
            "type": "Optional[Dict[str, Any]]",
            "description": "额外的搜索参数",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索结果",
        "dependencies": ["json", "time", "os", "requests"],
        "implementation_notes": [
          "支持多种搜索引擎",
          "从环境变量获取API密钥",
          "安全处理API密钥，不在输出中暴露"
        ],
        "error_handling": [
          "检查API密钥是否提供",
          "处理API请求错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "serpapi_search('Apple Inc. revenue')",
          "serpapi_search('腾讯公司简介', engine='baidu')"
        ]
      },
      {
        "tool_name": "web_page_extractor",
        "description": "提取网页内容",
        "function_signature": "web_page_extractor(url: str, extract_type: str = \"text\", timeout: int = 10) -> str",
        "parameters": [
          {
            "name": "url",
            "type": "str",
            "description": "网页URL",
            "required": true
          },
          {
            "name": "extract_type",
            "type": "str",
            "description": "提取类型，支持\"text\"、\"html\"、\"links\"、\"all\"",
            "required": false
          },
          {
            "name": "timeout",
            "type": "int",
            "description": "请求超时时间(秒)",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的提取结果",
        "dependencies": ["json", "requests", "BeautifulSoup"],
        "implementation_notes": [
          "使用BeautifulSoup解析HTML",
          "支持多种提取类型",
          "处理相对URL转换为绝对URL",
          "限制返回内容大小，避免token限制"
        ],
        "error_handling": [
          "验证URL格式",
          "处理HTTP请求错误",
          "捕获解析异常"
        ],
        "usage_examples": [
          "web_page_extractor('https://www.apple.com')",
          "web_page_extractor('https://www.tencent.com', extract_type='links')"
        ]
      },
      {
        "tool_name": "aws_bedrock_search",
        "description": "使用AWS Bedrock进行搜索和信息提取",
        "function_signature": "aws_bedrock_search(query: str, model_id: str = \"anthropic.claude-3-sonnet-20240229-v1:0\", max_tokens: int = 4096) -> str",
        "parameters": [
          {
            "name": "query",
            "type": "str",
            "description": "搜索查询",
            "required": true
          },
          {
            "name": "model_id",
            "type": "str",
            "description": "Bedrock模型ID，默认为Claude 3 Sonnet",
            "required": false
          },
          {
            "name": "max_tokens",
            "type": "int",
            "description": "最大生成token数，默认为4096",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "JSON格式的搜索和提取结果",
        "dependencies": ["json", "time", "re", "boto3"],
        "implementation_notes": [
          "使用boto3调用AWS Bedrock API",
          "构建结构化提示词获取公司信息",
          "支持不同模型的请求格式",
          "处理JSON响应提取"
        ],
        "error_handling": [
          "处理AWS API错误",
          "处理JSON解析错误",
          "捕获所有异常并返回结构化错误信息"
        ],
        "usage_examples": [
          "aws_bedrock_search('Apple Inc.')",
          "aws_bedrock_search('腾讯公司', model_id='anthropic.claude-3-haiku-20240307-v1:0')"
        ]
      }
    ],
    "code_quality": {
      "code_standards": [
        "遵循PEP 8 Python代码风格指南",
        "使用类型注解提高代码可读性和安全性",
        "提供详细的文档字符串",
        "模块化设计，每个工具函数职责单一"
      ],
      "testing_strategy": [
        "针对每个工具函数进行单元测试",
        "测试错误处理和边缘情况",
        "模拟外部API响应进行集成测试"
      ],
      "performance_considerations": [
        "实现缓存机制，避免重复查询",
        "分批处理大量数据，控制内存使用",
        "限制返回内容大小，避免token限制",
        "优化文件读写操作"
      ],
      "security_measures": [
        "安全处理API密钥，不在输出中暴露",
        "验证用户输入，防止注入攻击",
        "使用安全的文件名处理方式",
        "遵循最小权限原则"
      ]
    },
    "integration_details": {
      "aws_services": [
        "AWS Bedrock (用于高级信息提取)"
      ],
      "external_libraries": [
        "pandas (用于Excel文件处理)",
        "requests (用于HTTP请求)",
        "BeautifulSoup (用于HTML解析)",
        "boto3 (用于AWS服务调用)"
      ],
      "api_endpoints": [
        "SerpAPI (用于搜索引擎集成)",
        "AWS Bedrock API"
      ],
      "data_formats": [
        "JSON (用于数据交换)",
        "Excel (用于输入和输出)",
        "CSV (用于中间结果和批处理)"
      ]
    },
    "development_notes": "工具开发过程中，我们优先考虑了系统的可靠性和容错性，实现了多搜索引擎集成和自动切换机制，确保即使某个搜索引擎API失败，系统仍能继续工作。缓存机制设计支持断点续传，解决了处理大量公司信息时可能中断的问题。为了应对token限制和内存问题，我们实现了分批处理和输出管理策略。所有工具都提供了详细的错误信息和状态报告，便于用户了解处理进度和问题。此外，我们还集成了AWS Bedrock服务，提供更高级的信息提取能力，特别是对于结构化公司信息的获取。"
  }
}