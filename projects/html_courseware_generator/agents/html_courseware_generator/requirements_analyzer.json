{
  "requirements_document": {
    "feature_name": "智能HTML课件与教案生成系统",
    "version": "1.0",
    "date": "2025-12-25",
    "overview": "本系统旨在为教育工作者提供一个智能化的课件和教案生成平台。系统能够根据教师指定的学科主题，自动生成具备动态交互能力的HTML课件，并同步生成配套的教学教案。系统集成FastAPI服务框架，提供Web API接口和静态文件服务，支持课件的在线预览和管理。所有生成的内容按主题分类存储，支持热重载机制，确保内容更新的实时性。",
    "business_value": "1. 显著减少教师备课时间，提高教学准备效率；2. 标准化课件质量，确保教学内容的完整性和专业性；3. 通过动态交互式课件提升学生学习体验和参与度；4. 支持多学科内容生成，实现教学资源的规模化生产；5. 提供Web化访问方式，便于课件的分享和协作；6. 自动化的文件管理和组织，降低资源管理成本。",
    "workflow_complexity": "multi_agent",
    "recommended_agent_type": "业务逻辑类 + 创意生成类 + 系统管理类的组合型Agent系统",
    "scope": {
      "included": [
        "基于主题的HTML课件自动生成功能",
        "动态交互式HTML内容创建（包含JavaScript交互逻辑）",
        "多学科内容支持（语文、数学、化学、物理、生物、历史、地理等）",
        "教案自动生成功能（教学目标、教学步骤、重难点、评估方案）",
        "FastAPI Web服务集成",
        "静态文件目录代理和访问",
        "基于主题的文件夹自动创建和管理",
        "课件和教案的关联存储",
        "自动reload机制实现",
        "课件预览功能",
        "RESTful API接口设计",
        "文件列表和检索功能"
      ],
      "excluded": [
        "用户认证和权限管理系统",
        "课件版本控制功能",
        "多用户协作编辑功能",
        "课件模板的可视化编辑器",
        "学生端学习进度跟踪",
        "课件使用数据分析和统计",
        "第三方LMS系统集成",
        "移动端原生应用开发",
        "课件导出为PDF或PPT格式",
        "多媒体资源（视频、音频）的上传和管理"
      ]
    },
    "functional_requirements": [
      {
        "id": "FR-001",
        "title": "HTML课件生成核心功能",
        "user_story": "作为教师，我希望能够输入学科和主题信息，系统自动生成包含完整教学内容的HTML课件，以便快速准备教学材料",
        "acceptance_criteria": [
          "WHEN 教师提供学科类型（如数学、语文、化学）和具体主题时 THEN 系统能够生成结构完整的HTML课件",
          "IF 主题为数学类 THEN 课件应包含数学公式渲染支持（MathJax或KaTeX）",
          "IF 主题为化学类 THEN 课件应包含化学方程式和分子结构展示",
          "WHEN 生成课件时 THEN HTML应包含标准的文档结构（header、main、footer）",
          "WHEN 生成课件时 THEN 应自动包含响应式CSS样式，支持不同屏幕尺寸",
          "WHEN 生成课件时 THEN 内容应包含：课程标题、学习目标、知识点讲解、示例演示、练习题等模块"
        ],
        "priority": "High",
        "complexity": "High",
        "dependencies": [
          "Claude Sonnet 4.5模型API",
          "HTML/CSS/JavaScript生成能力",
          "学科知识库"
        ],
        "assumptions": [
          "用户提供的主题描述清晰明确",
          "系统有足够的学科知识支持内容生成",
          "生成的HTML无需依赖外部CDN资源（可选内联）"
        ]
      },
      {
        "id": "FR-002",
        "title": "动态交互能力实现",
        "user_story": "作为教师，我希望生成的HTML课件具备动态交互功能，以便学生能够通过点击、输入等操作进行互动学习",
        "acceptance_criteria": [
          "WHEN 课件中包含知识点测验时 THEN 应提供可点击的选择题，并能实时反馈答案正确性",
          "WHEN 课件中包含计算题时 THEN 应提供输入框和提交按钮，支持答案验证",
          "IF 学科为数学 THEN 应包含可交互的图表或几何图形展示",
          "IF 学科为化学 THEN 应包含可交互的化学实验模拟或分子模型",
          "WHEN 用户操作交互元素时 THEN JavaScript应能够捕获事件并提供即时反馈",
          "WHEN 生成课件时 THEN 所有JavaScript代码应内联或包含在HTML文件中，确保离线可用"
        ],
        "priority": "High",
        "complexity": "High",
        "dependencies": [
          "JavaScript代码生成能力",
          "学科特定交互组件库",
          "事件处理逻辑设计"
        ],
        "assumptions": [
          "交互功能不需要后端API支持",
          "所有交互逻辑可在浏览器端完成",
          "生成的JavaScript代码符合现代浏览器标准"
        ]
      },
      {
        "id": "FR-003",
        "title": "多学科内容支持",
        "user_story": "作为教师，我希望系统能够支持语文、数学、化学、物理等多种学科的课件生成，以便满足不同科目的教学需求",
        "acceptance_criteria": [
          "WHEN 选择语文学科时 THEN 课件应包含文本分析、诗词鉴赏、写作技巧等相关内容结构",
          "WHEN 选择数学学科时 THEN 课件应包含公式推导、例题解析、习题练习等模块",
          "WHEN 选择化学学科时 THEN 课件应包含化学方程式、实验步骤、安全提示等内容",
          "WHEN 选择物理学科时 THEN 课件应包含物理定律、公式应用、实验设计等模块",
          "IF 学科未明确指定 THEN 系统应提供通用课件模板",
          "WHEN 生成课件时 THEN 应根据学科特点自动调整内容结构和交互方式"
        ],
        "priority": "High",
        "complexity": "Medium",
        "dependencies": [
          "学科知识库和模板库",
          "学科特定渲染组件",
          "内容生成策略引擎"
        ],
        "assumptions": [
          "每个学科有明确的内容结构规范",
          "系统具备足够的学科专业知识",
          "不同学科可共享基础HTML框架"
        ]
      },
      {
        "id": "FR-004",
        "title": "教案自动生成功能",
        "user_story": "作为教师，我希望在生成HTML课件的同时，系统能够自动生成配套的教学教案文档，以便我进行教学准备和课堂管理",
        "acceptance_criteria": [
          "WHEN 生成课件时 THEN 系统应同步生成对应的教案文档",
          "WHEN 生成教案时 THEN 应包含以下模块：教学目标、教学重点、教学难点、教学方法、教学步骤、板书设计、作业布置、教学反思",
          "WHEN 生成教案时 THEN 教学目标应包含知识目标、能力目标、情感目标",
          "WHEN 生成教案时 THEN 教学步骤应详细列出导入、新课讲授、巩固练习、课堂小结等环节",
          "WHEN 生成教案时 THEN 应提供预估的时间分配建议",
          "IF 课件包含交互元素 THEN 教案应说明如何引导学生使用这些交互功能",
          "WHEN 生成教案时 THEN 格式应为Markdown或HTML，便于阅读和打印"
        ],
        "priority": "High",
        "complexity": "Medium",
        "dependencies": [
          "教案模板库",
          "教学法知识库",
          "课件内容分析能力"
        ],
        "assumptions": [
          "教案内容与课件内容保持一致",
          "教案遵循标准的教学设计理论",
          "教案格式符合教育行业规范"
        ]
      },
      {
        "id": "FR-005",
        "title": "FastAPI服务集成",
        "user_story": "作为系统管理员，我希望系统集成FastAPI框架，提供RESTful API接口和静态文件服务，以便通过Web方式访问和管理课件",
        "acceptance_criteria": [
          "WHEN 系统启动时 THEN FastAPI服务应成功启动并监听指定端口",
          "WHEN 访问API端点时 THEN 应提供课件生成接口（POST /api/generate）",
          "WHEN 调用生成接口时 THEN 应接收JSON格式的请求参数（学科、主题、详细要求）",
          "WHEN 课件生成完成时 THEN 应返回生成结果信息（文件路径、访问URL、状态）",
          "WHEN 访问静态文件路径时 THEN 应能够浏览和访问已生成的课件HTML文件",
          "WHEN 提供文件列表接口时 THEN 应返回所有已生成课件的列表（GET /api/courseware/list）",
          "WHEN 提供课件详情接口时 THEN 应返回指定课件的元数据信息（GET /api/courseware/{id}）",
          "IF 请求参数无效 THEN 应返回400错误和详细错误信息",
          "IF 生成过程出错 THEN 应返回500错误和错误详情"
        ],
        "priority": "High",
        "complexity": "Medium",
        "dependencies": [
          "FastAPI框架",
          "Uvicorn ASGI服务器",
          "文件系统访问权限"
        ],
        "assumptions": [
          "FastAPI运行在独立的端口（如8000）",
          "API接口遵循RESTful设计规范",
          "支持CORS跨域访问"
        ]
      },
      {
        "id": "FR-006",
        "title": "静态文件目录代理",
        "user_story": "作为教师，我希望能够通过浏览器直接访问生成的课件HTML文件，以便预览和使用课件进行教学",
        "acceptance_criteria": [
          "WHEN FastAPI服务启动时 THEN 应挂载静态文件目录（如/courseware）",
          "WHEN 访问静态文件URL时 THEN 应能够正确返回HTML、CSS、JavaScript等文件",
          "WHEN 访问课件HTML时 THEN 浏览器应能够正确渲染和执行交互功能",
          "WHEN 访问不存在的文件时 THEN 应返回404错误",
          "IF 文件路径包含..等不安全字符 THEN 应拒绝访问并返回403错误",
          "WHEN 配置静态目录时 THEN 应支持自定义目录路径配置"
        ],
        "priority": "High",
        "complexity": "Low",
        "dependencies": [
          "FastAPI静态文件支持",
          "文件系统路径管理"
        ],
        "assumptions": [
          "静态文件目录具有读取权限",
          "生成的文件不包含敏感信息",
          "支持标准的MIME类型识别"
        ]
      },
      {
        "id": "FR-007",
        "title": "基于主题的文件管理",
        "user_story": "作为系统，我希望能够根据课件主题自动创建文件夹并组织文件，以便实现清晰的文件结构和便捷的管理",
        "acceptance_criteria": [
          "WHEN 生成新课件时 THEN 应根据主题名称创建对应的文件夹",
          "WHEN 创建文件夹时 THEN 文件夹名称应遵循命名规范（去除特殊字符、使用下划线分隔）",
          "WHEN 生成课件和教案时 THEN 应将HTML课件和教案文档存储在同一主题文件夹下",
          "WHEN 文件夹已存在时 THEN 应在文件名后添加时间戳或序号避免覆盖",
          "WHEN 存储文件时 THEN 应生成metadata.json记录课件元信息（生成时间、学科、主题、文件列表）",
          "IF 主题名称过长 THEN 应进行截断处理（保留前50个字符）",
          "WHEN 文件夹结构为 THEN /courseware/{subject}/{topic}/index.html 和 /courseware/{subject}/{topic}/lesson_plan.md"
        ],
        "priority": "High",
        "complexity": "Medium",
        "dependencies": [
          "文件系统操作库",
          "路径处理工具",
          "JSON序列化支持"
        ],
        "assumptions": [
          "文件系统支持中文文件名",
          "有足够的磁盘空间存储生成的文件",
          "文件夹结构设计合理且可扩展"
        ]
      },
      {
        "id": "FR-008",
        "title": "自动Reload机制",
        "user_story": "作为开发者，我希望当课件文件更新时系统能够自动重载，以便用户能够立即看到最新的内容而无需重启服务",
        "acceptance_criteria": [
          "WHEN 开发环境下运行时 THEN FastAPI应启用auto-reload模式",
          "WHEN 课件文件被修改时 THEN 浏览器刷新后应显示最新内容",
          "WHEN 生成新课件时 THEN 文件列表接口应立即反映新增的课件",
          "IF 生产环境 THEN 可选择性关闭auto-reload以提升性能",
          "WHEN 使用Uvicorn启动时 THEN 应配置--reload参数",
          "WHEN 监听文件变化时 THEN 应只监听指定的课件目录，避免不必要的重载"
        ],
        "priority": "Medium",
        "complexity": "Low",
        "dependencies": [
          "Uvicorn reload功能",
          "文件系统监听机制"
        ],
        "assumptions": [
          "开发环境下允许自动重载",
          "文件修改频率不会导致性能问题",
          "重载不会影响正在进行的请求"
        ]
      },
      {
        "id": "FR-009",
        "title": "课件预览功能",
        "user_story": "作为教师，我希望在课件生成后能够立即预览效果，以便确认内容质量和交互功能是否符合预期",
        "acceptance_criteria": [
          "WHEN 课件生成完成时 THEN API响应应包含预览URL",
          "WHEN 点击预览URL时 THEN 应在浏览器中打开课件HTML",
          "WHEN 预览课件时 THEN 所有交互功能应正常工作",
          "WHEN 预览课件时 THEN 样式和布局应正确渲染",
          "IF 课件包含数学公式 THEN 公式应正确显示",
          "IF 课件包含交互题目 THEN 交互逻辑应可测试"
        ],
        "priority": "Medium",
        "complexity": "Low",
        "dependencies": [
          "静态文件服务",
          "浏览器兼容性"
        ],
        "assumptions": [
          "用户使用现代浏览器访问",
          "课件HTML是自包含的",
          "预览不需要额外的认证"
        ]
      },
      {
        "id": "FR-010",
        "title": "Agent编排和协作",
        "user_story": "作为系统架构师，我希望系统内部通过多个专业Agent协作完成任务，以便实现功能的模块化和可维护性",
        "acceptance_criteria": [
          "WHEN 收到课件生成请求时 THEN 主控Agent应协调各子Agent完成任务",
          "WHEN 需要生成HTML内容时 THEN 课件生成Agent应负责HTML结构和交互代码的生成",
          "WHEN 需要生成教案时 THEN 教案生成Agent应负责教学设计内容的生成",
          "WHEN 需要学科知识时 THEN 知识库Agent应提供学科特定的内容支持",
          "WHEN Agent之间通信时 THEN 应使用标准的消息格式传递信息",
          "IF 某个Agent执行失败 THEN 应有错误处理和降级方案",
          "WHEN 所有Agent完成任务时 THEN 主控Agent应整合结果并返回给用户"
        ],
        "priority": "High",
        "complexity": "High",
        "dependencies": [
          "Strands SDK Agent框架",
          "Agent间通信机制",
          "任务编排逻辑"
        ],
        "assumptions": [
          "Agent之间可以异步通信",
          "每个Agent职责清晰明确",
          "Agent编排逻辑可配置"
        ]
      }
    ],
    "non_functional_requirements": {
      "performance": [
        "单个课件生成时间应控制在30秒内",
        "系统应支持并发处理至少5个课件生成请求",
        "FastAPI接口响应时间应小于100ms（不包含课件生成时间）",
        "静态文件访问延迟应小于50ms",
        "生成的HTML文件大小应控制在500KB以内（不包含外部资源）",
        "系统启动时间应小于5秒"
      ],
      "security": [
        "文件路径访问应进行安全校验，防止目录遍历攻击",
        "API接口应进行输入验证，防止注入攻击",
        "生成的JavaScript代码应避免XSS风险",
        "静态文件目录应限制访问范围",
        "敏感配置信息应通过环境变量管理",
        "API调用应记录日志便于审计"
      ],
      "usability": [
        "API接口应提供清晰的文档说明",
        "错误消息应具体明确，便于问题定位",
        "课件生成参数应有合理的默认值",
        "生成的课件应具有良好的视觉设计和用户体验",
        "教案格式应规范易读",
        "系统应提供健康检查接口（GET /health）"
      ],
      "reliability": [
        "课件生成失败时应返回详细的错误信息",
        "文件写入失败时应有重试机制",
        "系统异常时应记录完整的错误堆栈",
        "Agent执行超时应有超时控制（60秒）",
        "系统应能够从异常状态自动恢复",
        "关键操作应有日志记录便于追踪"
      ]
    },
    "constraints": [
      "必须使用Strands SDK构建Agent系统",
      "必须使用Claude Sonnet 4.5模型（anthropic.claude-sonnet-4-5-20250929-v1:0）",
      "必须集成FastAPI框架提供Web服务",
      "必须遵守AgentCore部署规范，包含handler入口点",
      "生成的Agent脚本必须支持流式响应",
      "必须使用nexus_utils.agent_factory.create_agent_from_prompt_template创建Agent",
      "课件和教案必须存储在本地文件系统",
      "文件夹结构必须按照学科和主题组织",
      "生成的HTML必须是自包含的，可离线使用",
      "系统必须支持Docker容器化部署"
    ],
    "assumptions": [
      "用户提供的主题描述清晰且具体",
      "系统运行环境有稳定的网络连接（访问Claude API）",
      "文件系统有足够的存储空间",
      "用户使用现代浏览器（Chrome、Firefox、Safari、Edge）访问课件",
      "教师具备基本的计算机操作能力",
      "课件内容不涉及版权争议",
      "生成的内容符合教育行业规范和标准",
      "系统部署环境支持Python 3.10+",
      "FastAPI服务可以访问外部网络（Claude API）",
      "课件生成不需要实时协作功能"
    ],
    "success_criteria": [
      "系统能够成功生成包含动态交互功能的HTML课件",
      "生成的课件覆盖至少5个主要学科（语文、数学、化学、物理、生物）",
      "每个课件都配有完整的教学教案",
      "FastAPI服务稳定运行，API接口功能完整",
      "课件和教案按主题正确分类存储",
      "静态文件服务能够正常访问所有生成的课件",
      "自动reload机制工作正常",
      "课件预览功能可用，交互元素正常工作",
      "系统通过基本的性能测试（响应时间、并发处理）",
      "系统通过安全性检查（路径遍历、输入验证）",
      "生成的课件获得教师的正面反馈",
      "系统能够成功部署到AgentCore环境"
    ],
    "glossary": {
      "HTML课件": "基于HTML、CSS、JavaScript技术构建的电子教学课件，包含教学内容、交互元素、视觉设计",
      "动态交互": "通过JavaScript实现的用户交互功能，如点击、输入、拖拽等操作及相应的反馈",
      "教案": "教师为实施教学而制定的教学方案，包括教学目标、教学步骤、教学方法等内容",
      "FastAPI": "一个现代、快速的Python Web框架，用于构建RESTful API",
      "静态文件代理": "Web服务器提供的静态文件访问功能，允许通过HTTP访问文件系统中的文件",
      "自动reload": "文件变化时自动重新加载应用的机制，常用于开发环境",
      "主题": "课件的教学主题或知识点，如'二次函数'、'氧化还原反应'等",
      "学科": "教学科目类别，如语文、数学、化学、物理等",
      "Agent": "基于大语言模型的智能代理，能够理解指令并执行特定任务",
      "Strands SDK": "用于构建和编排Agent的开发框架",
      "AgentCore": "Amazon Bedrock提供的Agent运行时环境",
      "流式响应": "逐步返回响应内容的方式，而非一次性返回完整结果",
      "ASGI": "异步服务器网关接口，Python异步Web应用的标准接口"
    }
  },
  "analysis_notes": "本项目需求分析的关键发现：\n\n1. **复杂度评估**：这是一个典型的多Agent协作场景。原因包括：(1) 涉及HTML课件生成、教案生成、Web服务三个不同的功能模块；(2) 需要多学科知识支持，单个Agent难以覆盖所有领域；(3) 课件生成和教案生成可以并行处理，提高效率；(4) 不同Agent可以专注于各自的专业领域，提高输出质量。\n\n2. **Agent架构建议**：建议采用主从架构，包含：(1) 主控Agent：负责请求接收、任务分发、结果整合；(2) 课件生成Agent：专注于HTML/CSS/JavaScript代码生成，实现交互功能；(3) 教案生成Agent：专注于教学设计和教案文档生成；(4) 知识库Agent（可选）：提供学科特定的知识支持和内容建议。\n\n3. **技术实现要点**：(1) 使用FastAPI作为Web服务框架，提供RESTful API和静态文件服务；(2) 使用Strands SDK构建Agent系统，支持Agent间的消息传递和协作；(3) 遵守AgentCore部署规范，实现handler入口点和流式响应；(4) 文件管理采用{学科}/{主题}的目录结构，便于组织和检索。\n\n4. **核心挑战**：(1) 如何生成高质量的交互式HTML内容，确保JavaScript代码的正确性和安全性；(2) 如何支持多学科内容生成，需要针对不同学科设计不同的模板和策略；(3) 如何确保课件和教案的一致性，内容互相呼应；(4) 如何实现高效的Agent协作，减少等待时间。\n\n5. **优先级建议**：第一阶段实现核心的课件和教案生成功能（FR-001至FR-004），第二阶段集成FastAPI服务和文件管理（FR-005至FR-008），第三阶段完善预览和优化功能（FR-009至FR-010）。\n\n6. **风险和缓解**：(1) 生成的HTML代码质量风险 - 通过严格的提示词工程和代码验证机制缓解；(2) 学科知识覆盖不全 - 通过建立学科模板库和持续优化缓解；(3) 性能问题 - 通过异步处理和缓存机制缓解；(4) 安全风险 - 通过输入验证和路径检查缓解。"
}