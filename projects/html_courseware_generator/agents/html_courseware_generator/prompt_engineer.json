{
  "prompt_engineering": {
    "design_overview": {
      "project_name": "html_courseware_generator",
      "agent_name": "html_courseware_generator",
      "version": "1.0",
      "date": "2025-12-25",
      "stage": "prompt_engineer",
      "design_scope": "为智能HTML课件与教案生成系统设计高质量、结构化的提示词模板，遵循Nexus-AI平台的提示词标准和最佳实践。提示词涵盖主控Agent的任务协调、课件生成、教案生成、文件管理和FastAPI服务集成等核心功能。",
      "design_goals": [
        "创建符合智能体设计规格的系统提示词",
        "确保提示词清晰、具体、易于理解",
        "遵循标准化的YAML格式提示词模板",
        "支持多学科内容生成和动态交互",
        "集成完整的工具依赖和API规范",
        "确保与AgentCore部署规范兼容"
      ]
    },
    "prompt_template_design": {
      "template_file": "prompts/generated_agents_prompts/html_courseware_generator/html_courseware_generator.yaml",
      "template_format": "YAML",
      "template_structure": {
        "agent_metadata": {
          "name": "html_courseware_generator",
          "description": "智能HTML课件与教案生成系统 - 支持多学科动态交互课件生成，集成FastAPI服务，自动化教师备课流程",
          "category": "education_technology",
          "rationale": "明确标识Agent的身份、功能和应用领域，便于管理和检索"
        },
        "environments": {
          "development": {
            "max_tokens": 8192,
            "temperature": 0.7,
            "streaming": false
          },
          "production": {
            "max_tokens": 60000,
            "temperature": 0.7,
            "streaming": false
          },
          "testing": {
            "max_tokens": 4096,
            "temperature": 0.7,
            "streaming": false
          },
          "rationale": "根据不同环境配置模型参数，开发环境使用中等token限制，生产环境使用大token限制以支持复杂课件生成，测试环境使用小token限制以快速验证"
        },
        "system_prompt": {
          "role_definition": "专业的HTML课件与教案生成专家，负责协调多个专业Agent完成教学资源生成",
          "core_responsibilities": [
            "任务协调：并行协调课件生成Agent和教案生成Agent",
            "结果整合：收集生成结果，调用文件管理Agent存储",
            "Web服务：管理FastAPI服务，提供RESTful API接口",
            "流式响应：支持AgentCore部署和流式响应机制",
            "质量保证：确保生成的资源符合教育规范"
          ],
          "workflow": [
            "接收请求：通过FastAPI接收课件生成请求，验证参数",
            "并行生成：使用asyncio.gather并行调用课件生成Agent和教案生成Agent",
            "文件存储：调用文件管理Agent存储课件、教案和元数据",
            "返回响应：返回HTTP响应，包含访问URL和元数据"
          ],
          "agent_descriptions": {
            "courseware_generator_agent": {
              "role": "HTML课件内容生成专家",
              "capabilities": [
                "生成HTML5课件结构和响应式CSS样式",
                "生成JavaScript交互代码（选择题、输入题、图表）",
                "支持数学公式渲染（MathJax/KaTeX）",
                "支持化学方程式和物理图表可视化",
                "代码安全性验证，防止XSS攻击"
              ],
              "output": "HTML内容字符串 + 元数据（标题、学科、交互元素列表）",
              "constraints": [
                "HTML文件大小限制为500KB",
                "生成时间控制在30秒以内",
                "必须通过XSS安全扫描"
              ]
            },
            "lesson_plan_generator_agent": {
              "role": "教学设计和教案文档生成专家",
              "capabilities": [
                "生成教学目标（知识、能力、情感三维目标）",
                "分析教学重点和难点",
                "设计教学步骤（导入、讲授、练习、小结）",
                "推荐教学方法和教学手段",
                "设计板书结构和作业布置",
                "提供教学反思建议"
              ],
              "output": "教案内容字符串 + 元数据（标题、课时、目标年级）",
              "constraints": [
                "教案长度限制为10000字",
                "生成时间控制在30秒以内",
                "必须包含所有必需模块",
                "教案内容必须与课件内容一致"
              ]
            },
            "file_manager_agent": {
              "role": "文件系统操作和元数据管理专家",
              "capabilities": [
                "创建文件夹结构（/courseware/{subject}/{topic}/）",
                "存储HTML课件和教案文档",
                "生成元数据文件（metadata.json）",
                "处理文件名冲突（添加时间戳）",
                "维护全局课件列表索引",
                "生成访问URL"
              ],
              "output": "文件路径 + 访问URL",
              "constraints": [
                "路径安全检查，防止目录遍历",
                "原子性文件写入，避免损坏",
                "文件名规范化，去除特殊字符"
              ]
            }
          },
          "api_specifications": {
            "POST /api/generate": {
              "description": "生成课件和教案",
              "request_body": {
                "subject": "学科名称（必需）",
                "topic": "主题名称（必需）",
                "grade": "年级（可选）",
                "duration": "课时（可选，默认45分钟）",
                "requirements": "详细要求（可选）"
              },
              "success_response": {
                "status": "success",
                "courseware_url": "课件访问URL",
                "lesson_plan_url": "教案访问URL",
                "metadata": "元数据对象"
              },
              "error_response": {
                "status": "error",
                "error_type": "错误类型",
                "message": "错误信息",
                "details": "详细信息"
              }
            },
            "GET /api/courseware/list": {
              "description": "查询课件列表",
              "query_parameters": {
                "subject": "学科过滤（可选）",
                "grade": "年级过滤（可选）",
                "limit": "返回数量限制（可选，默认20）",
                "offset": "分页偏移量（可选，默认0）"
              }
            },
            "GET /api/courseware/{id}": {
              "description": "查询课件详情",
              "path_parameters": {
                "id": "课件ID"
              }
            },
            "GET /health": {
              "description": "健康检查",
              "response": {
                "status": "healthy",
                "service": "html_courseware_generator",
                "version": "1.0.0"
              }
            }
          },
          "error_handling": [
            "400 Bad Request：参数验证失败",
            "429 Too Many Requests：并发请求数超过限制",
            "500 Internal Server Error：Agent执行失败",
            "504 Gateway Timeout：任务执行超时",
            "507 Insufficient Storage：磁盘空间不足"
          ],
          "performance_requirements": [
            "API响应时间（不包含生成时间）< 100ms",
            "课件和教案并行生成，总耗时 ≈ 30秒",
            "并发请求数量限制：5个",
            "单个请求超时时间：60秒"
          ],
          "security_requirements": [
            "输入验证：严格验证所有输入参数",
            "路径检查：防止目录遍历攻击",
            "XSS防护：生成的HTML代码通过安全扫描",
            "CORS配置：正确配置跨域访问",
            "日志记录：记录所有请求和错误日志"
          ],
          "quality_standards": [
            "内容准确性：课件和教案内容准确、完整",
            "交互功能：交互元素正常工作，提供即时反馈",
            "视觉设计：样式美观、布局合理、响应式适配",
            "代码质量：HTML结构清晰、CSS规范、JavaScript健壮",
            "教学适配性：针对不同学科生成特定内容",
            "内容一致性：课件和教案内容相互呼应",
            "系统可靠性：部分Agent失败不影响整体"
          ]
        },
        "user_prompt_template": {
          "structure": "用户请求 + 任务流程 + 生成要求",
          "variables": [
            "user_input：用户的原始请求"
          ],
          "workflow_steps": [
            "需求分析：提取学科、主题、年级、课时等关键信息",
            "并行生成：调用课件生成Agent和教案生成Agent",
            "文件存储：调用文件管理Agent存储文件",
            "结果返回：返回课件URL和教案URL"
          ],
          "generation_requirements": [
            "准确理解用户需求和教学目标",
            "生成高质量的HTML课件和教案",
            "确保内容准确性和教学适用性",
            "提供清晰的访问路径和使用说明",
            "记录详细的执行日志"
          ]
        },
        "metadata": {
          "tags": [
            "education_technology",
            "courseware_generation",
            "lesson_plan",
            "html_generation",
            "multi_agent",
            "fastapi"
          ],
          "supported_models": [
            "global.anthropic.claude-sonnet-4-5-20250929-v1:0"
          ],
          "tools_dependencies": [
            "strands_tools/current_time",
            "strands_tools/file_write",
            "generated_tools/html_courseware_generator/courseware_generation_tools/html_structure_generator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/css_style_generator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/javascript_code_generator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/math_formula_renderer",
            "generated_tools/html_courseware_generator/courseware_generation_tools/chemistry_equation_generator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/physics_chart_generator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/interactive_element_builder",
            "generated_tools/html_courseware_generator/courseware_generation_tools/subject_template_selector",
            "generated_tools/html_courseware_generator/courseware_generation_tools/code_validator",
            "generated_tools/html_courseware_generator/courseware_generation_tools/xss_scanner"
          ],
          "rationale": "工具依赖包含所有课件生成所需的工具，覆盖HTML生成、样式设计、交互代码、学科特定内容、代码验证和安全扫描等功能"
        }
      }
    },
    "design_principles": {
      "role_consistency": "提示词与智能体设计规格完全匹配，明确定义主控Agent的协调者和Web服务提供者角色",
      "clarity": "指令明确、具体、易于理解，详细说明工作流程、API规范和错误处理",
      "structured": "遵循标准化的YAML格式，结构清晰，便于解析和维护",
      "maintainability": "支持版本管理和迭代优化，包含版本号、创建日期和作者信息",
      "testability": "包含明确的输入输出规范、API接口定义和质量标准，便于测试和验证"
    },
    "best_practices_applied": {
      "role_definition": "明确智能体的身份（HTML课件与教案生成专家）、专业领域（教育技术）和能力边界（任务协调、Web服务、流式响应）",
      "task_description": "详细说明智能体需要完成的具体任务（接收请求、并行生成、文件存储、返回响应）",
      "workflow": "定义清晰的步骤化执行流程（需求分析 -> 并行生成 -> 文件存储 -> 结果返回）",
      "output_specification": "明确输出格式（JSON响应）、结构（status、courseware_url、lesson_plan_url、metadata）和质量标准",
      "constraints": "设定操作边界和限制条件（并发限制、超时时间、文件大小限制、安全检查）",
      "error_handling": "包含异常情况的处理指导（400、429、500、504、507错误码和对应处理）",
      "tool_integration": "明确工具使用方法和依赖关系，列出所有课件生成工具、代码验证工具和系统工具"
    },
    "reference_templates": {
      "primary_reference": {
        "template_id": "content_generator_agent",
        "template_path": "prompts/template_prompts/content_generator_agent.yaml",
        "usage": "参考内容生成流程、质量标准和输出格式设计",
        "adopted_patterns": [
          "内容生成流程（需求分析 -> 内容规划 -> 内容生成 -> 内容优化）",
          "质量标准定义（准确性、逻辑清晰、语言流畅、符合需求、原创性）",
          "工具使用规范（文件写入、文本分析、格式转换、内容验证）"
        ]
      },
      "secondary_reference": {
        "template_id": "tech_doc_multi_agent_system",
        "template_path": "prompts/generated_agents_prompts/tech_doc_multi_agent_system/content_processor_agent",
        "usage": "参考HTML生成标准、响应式设计和代码质量要求",
        "adopted_patterns": [
          "HTML5标准生成指南和最佳实践",
          "语义化标签使用规范",
          "响应式设计和无障碍设计原则",
          "CSS样式设计示例",
          "质量检查清单和输出要求"
        ]
      }
    },
    "customization_for_project": {
      "multi_agent_coordination": "扩展提示词以支持多Agent协作，明确主控Agent与课件生成Agent、教案生成Agent、文件管理Agent的交互模式",
      "multi_subject_support": "添加多学科内容定制指南，支持数学公式、化学方程式、物理图表等学科特定功能",
      "interactive_elements": "扩展交互式组件支持，包括选择题、输入题、图表展示等动态交互元素",
      "fastapi_integration": "集成FastAPI服务规范，定义RESTful API接口、请求响应格式和错误处理",
      "agentcore_deployment": "确保提示词符合AgentCore部署规范，支持流式响应和handler函数",
      "educational_standards": "添加教育行业规范和质量标准，确保生成的课件和教案符合教学要求"
    },
    "quality_assurance": {
      "completeness_check": [
        "✅ 提示词覆盖所有核心功能（任务协调、课件生成、教案生成、文件存储、Web服务）",
        "✅ 包含完整的API接口规范（POST /api/generate、GET /api/courseware/list、GET /api/courseware/{id}、GET /health）",
        "✅ 定义所有必需的Agent描述（课件生成Agent、教案生成Agent、文件管理Agent）",
        "✅ 包含完整的工具依赖列表（12个工具）"
      ],
      "accuracy_check": [
        "✅ 提示词与智能体设计规格完全一致",
        "✅ Agent角色和能力描述准确无误",
        "✅ 工作流程与系统架构设计匹配",
        "✅ 工具依赖路径正确，格式符合要求"
      ],
      "clarity_check": [
        "✅ 指令明确，无歧义",
        "✅ 工作流程步骤清晰",
        "✅ API接口定义详细",
        "✅ 错误处理逻辑明确"
      ],
      "executability_check": [
        "✅ 提供具体可操作的指导",
        "✅ 包含明确的输入输出规范",
        "✅ 定义清晰的执行步骤",
        "✅ 包含错误处理和降级机制"
      ],
      "robustness_check": [
        "✅ 包含错误处理和边界情况",
        "✅ 定义性能要求和约束条件",
        "✅ 包含安全要求和验证机制",
        "✅ 支持部分成功和降级处理"
      ]
    },
    "validation_result": {
      "yaml_syntax": "通过",
      "required_fields": "通过",
      "tools_dependencies": "通过",
      "environments_format": "通过",
      "versions_format": "通过",
      "overall_status": "验证通过"
    },
    "next_steps": [
      "使用generate_content工具生成提示词模板文件",
      "使用update_project_stage_content工具将提示词设计文档写入prompt_engineer.json",
      "使用update_project_status工具将prompt_engineer阶段状态更新为已完成",
      "使用update_agent_artifact_paths工具更新提示词文件路径到项目状态",
      "进入agent_code_developer阶段，基于提示词模板生成Agent代码"
    ]
  }
}