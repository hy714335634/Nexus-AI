{
  "tool_development": {
    "development_overview": {
      "project_name": "wuxia_novel_generator",
      "version": "1.0",
      "date": "2025-10-15",
      "development_scope": "开发武侠小说生成器所需的全套工具，包括角色管理、情节管理、世界观构建、内容生成和导出功能",
      "design_principles": [
        "模块化设计，将相关功能分组到不同文件中",
        "完整的类型注解，提高代码可读性和安全性",
        "健壮的错误处理，确保工具在各种情况下都能正常工作",
        "JSON格式的输入输出，方便与其他组件集成",
        "使用本地文件系统进行数据持久化，支持复杂的小说创作过程",
        "与AWS服务集成，提供高级内容生成和存储功能"
      ],
      "key_decisions": [
        "使用类管理器模式设计核心功能，通过工具函数暴露API",
        "将角色、情节、世界观等功能分离为独立模块，便于维护和扩展",
        "使用UUID作为对象标识符，确保唯一性",
        "使用JSON文件存储数据，便于调试和检查",
        "实现AWS Bedrock集成，用于高质量内容生成",
        "支持多种导出格式，满足不同用户需求"
      ]
    },
    "tools": [
      {
        "tool_name": "create_character",
        "description": "创建武侠小说角色，包括姓名、性别、年龄、门派、武功等信息",
        "function_signature": "create_character(novel_id: str, character_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "character_data",
            "type": "Dict[str, Any]",
            "description": "角色数据，包括姓名、性别、年龄、门派等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含创建的角色数据的JSON字符串",
        "dependencies": ["json", "os", "uuid", "datetime"],
        "implementation_notes": ["使用UUID生成唯一角色ID", "将角色数据保存到文件系统"],
        "error_handling": ["验证必填字段", "捕获并返回所有异常"],
        "usage_examples": ["创建一个名为'李寻欢'的角色，设定其为'小李飞刀'门派"]
      },
      {
        "tool_name": "get_character",
        "description": "根据ID获取角色信息",
        "function_signature": "get_character(novel_id: str, character_id: str) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "character_id",
            "type": "str",
            "description": "角色ID",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含角色数据的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["从文件系统读取角色数据"],
        "error_handling": ["处理角色不存在的情况"],
        "usage_examples": ["获取特定角色的详细信息"]
      },
      {
        "tool_name": "update_character",
        "description": "更新角色信息",
        "function_signature": "update_character(novel_id: str, character_id: str, updates: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "character_id",
            "type": "str",
            "description": "角色ID",
            "required": true
          },
          {
            "name": "updates",
            "type": "Dict[str, Any]",
            "description": "要更新的字段",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含更新后角色数据的JSON字符串",
        "dependencies": ["json", "os", "datetime"],
        "implementation_notes": ["只更新指定的字段", "自动更新最后修改时间"],
        "error_handling": ["处理角色不存在的情况"],
        "usage_examples": ["更新角色的武功列表"]
      },
      {
        "tool_name": "delete_character",
        "description": "删除角色",
        "function_signature": "delete_character(novel_id: str, character_id: str) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "character_id",
            "type": "str",
            "description": "角色ID",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含操作结果的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["从文件系统删除角色数据"],
        "error_handling": ["处理角色不存在的情况"],
        "usage_examples": ["删除一个不再需要的角色"]
      },
      {
        "tool_name": "list_characters",
        "description": "列出小说中的所有角色",
        "function_signature": "list_characters(novel_id: str) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含角色列表的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["从文件系统读取所有角色数据"],
        "error_handling": ["处理目录不存在的情况"],
        "usage_examples": ["获取小说中所有角色的概览"]
      },
      {
        "tool_name": "search_characters",
        "description": "根据条件搜索角色",
        "function_signature": "search_characters(novel_id: str, criteria: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "criteria",
            "type": "Dict[str, Any]",
            "description": "搜索条件",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含匹配角色列表的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["根据条件过滤角色列表"],
        "error_handling": ["处理无效搜索条件"],
        "usage_examples": ["搜索所有属于特定门派的角色"]
      },
      {
        "tool_name": "add_character_relationship",
        "description": "添加角色间的关系",
        "function_signature": "add_character_relationship(novel_id: str, character_id: str, related_id: str, relationship_type: str, description: str = \"\") -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "character_id",
            "type": "str",
            "description": "角色ID",
            "required": true
          },
          {
            "name": "related_id",
            "type": "str",
            "description": "相关角色ID",
            "required": true
          },
          {
            "name": "relationship_type",
            "type": "str",
            "description": "关系类型，如'盟友'、'敌人'、'师傅'、'徒弟'",
            "required": true
          },
          {
            "name": "description",
            "type": "str",
            "description": "关系描述",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "包含更新后角色数据的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["将关系信息添加到角色数据中"],
        "error_handling": ["验证两个角色都存在"],
        "usage_examples": ["设定两个角色为师徒关系"]
      },
      {
        "tool_name": "create_plot",
        "description": "创建或更新小说情节大纲",
        "function_signature": "create_plot(novel_id: str, plot_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "plot_data",
            "type": "Dict[str, Any]",
            "description": "情节数据，包括标题、设定、主要冲突等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含创建的情节数据的JSON字符串",
        "dependencies": ["json", "os", "datetime"],
        "implementation_notes": ["将情节数据保存到文件系统"],
        "error_handling": ["捕获并返回所有异常"],
        "usage_examples": ["创建一个包含主要冲突和主题的情节大纲"]
      },
      {
        "tool_name": "add_chapter",
        "description": "向情节大纲添加章节",
        "function_signature": "add_chapter(novel_id: str, chapter_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "chapter_data",
            "type": "Dict[str, Any]",
            "description": "章节数据，包括标题、概要、事件等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含更新后情节数据的JSON字符串",
        "dependencies": ["json", "os", "uuid", "datetime"],
        "implementation_notes": ["生成唯一章节ID", "自动设置章节编号"],
        "error_handling": ["处理情节不存在的情况"],
        "usage_examples": ["添加一个新章节，描述主要事件和场景"]
      },
      {
        "tool_name": "create_or_update_world",
        "description": "创建或更新小说世界观设定",
        "function_signature": "create_or_update_world(novel_id: str, world_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "world_data",
            "type": "Dict[str, Any]",
            "description": "世界观数据，包括设定、时代背景、武学体系等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含创建的世界观数据的JSON字符串",
        "dependencies": ["json", "os", "datetime"],
        "implementation_notes": ["将世界观数据保存到文件系统"],
        "error_handling": ["捕获并返回所有异常"],
        "usage_examples": ["创建一个详细的武侠世界观设定，包括气功体系和宗派关系"]
      },
      {
        "tool_name": "add_martial_art",
        "description": "添加武功设定",
        "function_signature": "add_martial_art(novel_id: str, martial_art_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "martial_art_data",
            "type": "Dict[str, Any]",
            "description": "武功数据，包括名称、类型、描述、招式等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含更新后世界观数据的JSON字符串",
        "dependencies": ["json", "os", "uuid", "datetime"],
        "implementation_notes": ["生成唯一武功ID", "将武功添加到世界观数据中"],
        "error_handling": ["处理数据格式错误"],
        "usage_examples": ["添加'降龙十八掌'武功，描述其招式和特点"]
      },
      {
        "tool_name": "generate_chapter",
        "description": "生成章节内容",
        "function_signature": "generate_chapter(novel_id: str, chapter_id: str, prompt: str, style: str = \"traditional\") -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          },
          {
            "name": "chapter_id",
            "type": "str",
            "description": "章节ID",
            "required": true
          },
          {
            "name": "prompt",
            "type": "str",
            "description": "详细描述章节事件、角色和场景的提示",
            "required": true
          },
          {
            "name": "style",
            "type": "str",
            "description": "写作风格，如'传统'、'现代'、'诗意'",
            "required": false
          }
        ],
        "return_type": "str",
        "return_description": "包含生成的章节内容的JSON字符串",
        "dependencies": ["json", "os", "boto3", "datetime"],
        "implementation_notes": ["使用AWS Bedrock生成内容", "实现备用方案处理API错误"],
        "error_handling": ["处理API调用失败的情况"],
        "usage_examples": ["根据章节大纲生成详细的武侠小说章节内容"]
      },
      {
        "tool_name": "create_novel",
        "description": "创建新小说",
        "function_signature": "create_novel(novel_data: Dict[str, Any]) -> str",
        "parameters": [
          {
            "name": "novel_data",
            "type": "Dict[str, Any]",
            "description": "小说数据，包括标题、作者、描述等",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含创建的小说数据的JSON字符串",
        "dependencies": ["json", "os", "uuid", "datetime"],
        "implementation_notes": ["生成唯一小说ID", "将小说数据保存到文件系统"],
        "error_handling": ["验证必填字段"],
        "usage_examples": ["创建一个新的武侠小说项目"]
      },
      {
        "tool_name": "export_novel_to_markdown",
        "description": "将小说导出为Markdown格式",
        "function_signature": "export_novel_to_markdown(novel_id: str) -> str",
        "parameters": [
          {
            "name": "novel_id",
            "type": "str",
            "description": "小说ID",
            "required": true
          }
        ],
        "return_type": "str",
        "return_description": "包含导出结果的JSON字符串",
        "dependencies": ["json", "os"],
        "implementation_notes": ["整合小说、情节和章节内容", "生成Markdown文件"],
        "error_handling": ["处理小说或章节不存在的情况"],
        "usage_examples": ["将完成的小说导出为可阅读的Markdown格式"]
      }
    ],
    "code_quality": {
      "code_standards": [
        "使用Python 3.13+语法和特性",
        "遵循PEP 8代码风格指南",
        "完整的类型注解",
        "详细的文档字符串",
        "适当的注释解释复杂逻辑"
      ],
      "testing_strategy": [
        "单元测试关键功能",
        "边界条件测试",
        "错误处理测试",
        "集成测试验证工具间交互"
      ],
      "performance_considerations": [
        "高效的文件读写操作",
        "适当的缓存机制",
        "优化AWS API调用"
      ],
      "security_measures": [
        "输入验证",
        "安全的文件操作",
        "错误信息不泄露敏感信息"
      ]
    },
    "integration_details": {
      "aws_services": ["AWS Bedrock (Claude模型)", "AWS S3"],
      "external_libraries": ["boto3", "json", "os", "uuid", "datetime"],
      "api_endpoints": ["bedrock-runtime.invoke_model"],
      "data_formats": ["JSON", "Markdown"]
    },
    "development_notes": "在开发过程中，我们采用了模块化设计，将相关功能分组到不同文件中，以提高代码的可维护性和可扩展性。所有工具函数都使用@tool装饰器定义，并返回JSON格式的字符串，便于与其他组件集成。我们实现了完整的错误处理机制，确保工具在各种情况下都能提供有意义的反馈。对于内容生成，我们集成了AWS Bedrock服务，利用Claude模型生成高质量的武侠小说内容。所有数据都持久化到本地文件系统，使用JSON格式存储，便于调试和检查。"
  }
}